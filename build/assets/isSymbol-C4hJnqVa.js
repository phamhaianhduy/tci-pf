var Ma=Object.defineProperty;var qa=(a,e,n)=>e in a?Ma(a,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[e]=n;var _t=(a,e,n)=>qa(a,typeof e!="symbol"?e+"":e,n);import{w as Ha,x as Ga,y as Qa,z as za,A as Er,B as Ya,h as Xa,D as ja}from"./index-Cwsbtslf.js";var Nt,xr;function le(){return xr||(xr=1,Nt={options:{usePureJavaScript:!1}}),Nt}var Rt={exports:{}},wt,Sr;function Wa(){if(Sr)return wt;Sr=1;var a={};wt=a;var e={};a.encode=function(v,N,S){if(typeof N!="string")throw new TypeError('"alphabet" must be a string.');if(S!==void 0&&typeof S!="number")throw new TypeError('"maxline" must be a number.');var h="";if(!(v instanceof Uint8Array))h=n(v,N);else{var t=0,m=N.length,f=N.charAt(0),x=[0];for(t=0;t<v.length;++t){for(var D=0,E=v[t];D<x.length;++D)E+=x[D]<<8,x[D]=E%m,E=E/m|0;for(;E>0;)x.push(E%m),E=E/m|0}for(t=0;v[t]===0&&t<v.length-1;++t)h+=f;for(t=x.length-1;t>=0;--t)h+=N[x[t]]}if(S){var u=new RegExp(".{1,"+S+"}","g");h=h.match(u).join(`\r
`)}return h},a.decode=function(v,N){if(typeof v!="string")throw new TypeError('"input" must be a string.');if(typeof N!="string")throw new TypeError('"alphabet" must be a string.');var S=e[N];if(!S){S=e[N]=[];for(var h=0;h<N.length;++h)S[N.charCodeAt(h)]=h}v=v.replace(/\s/g,"");for(var t=N.length,m=N.charAt(0),f=[0],h=0;h<v.length;h++){var x=S[v.charCodeAt(h)];if(x===void 0)return;for(var D=0,E=x;D<f.length;++D)E+=f[D]*t,f[D]=E&255,E>>=8;for(;E>0;)f.push(E&255),E>>=8}for(var u=0;v[u]===m&&u<v.length-1;++u)f.push(0);return typeof Buffer<"u"?Buffer.from(f.reverse()):new Uint8Array(f.reverse())};function n(v,N){var S=0,h=N.length,t=N.charAt(0),m=[0];for(S=0;S<v.length();++S){for(var f=0,x=v.at(S);f<m.length;++f)x+=m[f]<<8,m[f]=x%h,x=x/h|0;for(;x>0;)m.push(x%h),x=x/h|0}var D="";for(S=0;v.at(S)===0&&S<v.length()-1;++S)D+=t;for(S=m.length-1;S>=0;--S)D+=N[m[S]];return D}return wt}var Tr;function de(){if(Tr)return Rt.exports;Tr=1;var a=le(),e=Wa(),n=Rt.exports=a.util=a.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){n.nextTick=process.nextTick,typeof setImmediate=="function"?n.setImmediate=setImmediate:n.setImmediate=n.nextTick;return}if(typeof setImmediate=="function"){n.setImmediate=function(){return setImmediate.apply(void 0,arguments)},n.nextTick=function(i){return setImmediate(i)};return}if(n.setImmediate=function(i){setTimeout(i,0)},typeof window<"u"&&typeof window.postMessage=="function"){let i=function(r){if(r.source===window&&r.data===s){r.stopPropagation();var B=d.slice();d.length=0,B.forEach(function(k){k()})}};var s="forge.setImmediate",d=[];n.setImmediate=function(r){d.push(r),d.length===1&&window.postMessage(s,"*")},window.addEventListener("message",i,!0)}if(typeof MutationObserver<"u"){var p=Date.now(),I=!0,R=document.createElement("div"),d=[];new MutationObserver(function(){var r=d.slice();d.length=0,r.forEach(function(B){B()})}).observe(R,{attributes:!0});var c=n.setImmediate;n.setImmediate=function(r){Date.now()-p>15?(p=Date.now(),c(r)):(d.push(r),d.length===1&&R.setAttribute("a",I=!I))}}n.nextTick=n.setImmediate})(),n.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,n.globalScope=function(){return n.isNodejs?Ha:typeof self>"u"?window:self}(),n.isArray=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"},n.isArrayBuffer=function(s){return typeof ArrayBuffer<"u"&&s instanceof ArrayBuffer},n.isArrayBufferView=function(s){return s&&n.isArrayBuffer(s.buffer)&&s.byteLength!==void 0};function v(s){if(!(s===8||s===16||s===24||s===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+s)}n.ByteBuffer=N;function N(s){if(this.data="",this.read=0,typeof s=="string")this.data=s;else if(n.isArrayBuffer(s)||n.isArrayBufferView(s))if(typeof Buffer<"u"&&s instanceof Buffer)this.data=s.toString("binary");else{var d=new Uint8Array(s);try{this.data=String.fromCharCode.apply(null,d)}catch{for(var p=0;p<d.length;++p)this.putByte(d[p])}}else(s instanceof N||typeof s=="object"&&typeof s.data=="string"&&typeof s.read=="number")&&(this.data=s.data,this.read=s.read);this._constructedStringLength=0}n.ByteStringBuffer=N;var S=4096;n.ByteStringBuffer.prototype._optimizeConstructedString=function(s){this._constructedStringLength+=s,this._constructedStringLength>S&&(this.data.substr(0,1),this._constructedStringLength=0)},n.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},n.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},n.ByteStringBuffer.prototype.putByte=function(s){return this.putBytes(String.fromCharCode(s))},n.ByteStringBuffer.prototype.fillWithByte=function(s,d){s=String.fromCharCode(s);for(var p=this.data;d>0;)d&1&&(p+=s),d>>>=1,d>0&&(s+=s);return this.data=p,this._optimizeConstructedString(d),this},n.ByteStringBuffer.prototype.putBytes=function(s){return this.data+=s,this._optimizeConstructedString(s.length),this},n.ByteStringBuffer.prototype.putString=function(s){return this.putBytes(n.encodeUtf8(s))},n.ByteStringBuffer.prototype.putInt16=function(s){return this.putBytes(String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},n.ByteStringBuffer.prototype.putInt24=function(s){return this.putBytes(String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},n.ByteStringBuffer.prototype.putInt32=function(s){return this.putBytes(String.fromCharCode(s>>24&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255))},n.ByteStringBuffer.prototype.putInt16Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255))},n.ByteStringBuffer.prototype.putInt24Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s>>16&255))},n.ByteStringBuffer.prototype.putInt32Le=function(s){return this.putBytes(String.fromCharCode(s&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>24&255))},n.ByteStringBuffer.prototype.putInt=function(s,d){v(d);var p="";do d-=8,p+=String.fromCharCode(s>>d&255);while(d>0);return this.putBytes(p)},n.ByteStringBuffer.prototype.putSignedInt=function(s,d){return s<0&&(s+=2<<d-1),this.putInt(s,d)},n.ByteStringBuffer.prototype.putBuffer=function(s){return this.putBytes(s.getBytes())},n.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},n.ByteStringBuffer.prototype.getInt16=function(){var s=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,s},n.ByteStringBuffer.prototype.getInt24=function(){var s=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,s},n.ByteStringBuffer.prototype.getInt32=function(){var s=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,s},n.ByteStringBuffer.prototype.getInt16Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,s},n.ByteStringBuffer.prototype.getInt24Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,s},n.ByteStringBuffer.prototype.getInt32Le=function(){var s=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,s},n.ByteStringBuffer.prototype.getInt=function(s){v(s);var d=0;do d=(d<<8)+this.data.charCodeAt(this.read++),s-=8;while(s>0);return d},n.ByteStringBuffer.prototype.getSignedInt=function(s){var d=this.getInt(s),p=2<<s-2;return d>=p&&(d-=p<<1),d},n.ByteStringBuffer.prototype.getBytes=function(s){var d;return s?(s=Math.min(this.length(),s),d=this.data.slice(this.read,this.read+s),this.read+=s):s===0?d="":(d=this.read===0?this.data:this.data.slice(this.read),this.clear()),d},n.ByteStringBuffer.prototype.bytes=function(s){return typeof s>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+s)},n.ByteStringBuffer.prototype.at=function(s){return this.data.charCodeAt(this.read+s)},n.ByteStringBuffer.prototype.setAt=function(s,d){return this.data=this.data.substr(0,this.read+s)+String.fromCharCode(d)+this.data.substr(this.read+s+1),this},n.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},n.ByteStringBuffer.prototype.copy=function(){var s=n.createBuffer(this.data);return s.read=this.read,s},n.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},n.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},n.ByteStringBuffer.prototype.truncate=function(s){var d=Math.max(0,this.length()-s);return this.data=this.data.substr(this.read,d),this.read=0,this},n.ByteStringBuffer.prototype.toHex=function(){for(var s="",d=this.read;d<this.data.length;++d){var p=this.data.charCodeAt(d);p<16&&(s+="0"),s+=p.toString(16)}return s},n.ByteStringBuffer.prototype.toString=function(){return n.decodeUtf8(this.bytes())};function h(s,d){d=d||{},this.read=d.readOffset||0,this.growSize=d.growSize||1024;var p=n.isArrayBuffer(s),I=n.isArrayBufferView(s);if(p||I){p?this.data=new DataView(s):this.data=new DataView(s.buffer,s.byteOffset,s.byteLength),this.write="writeOffset"in d?d.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,s!=null&&this.putBytes(s),"writeOffset"in d&&(this.write=d.writeOffset)}n.DataBuffer=h,n.DataBuffer.prototype.length=function(){return this.write-this.read},n.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},n.DataBuffer.prototype.accommodate=function(s,d){if(this.length()>=s)return this;d=Math.max(d||this.growSize,s);var p=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),I=new Uint8Array(this.length()+d);return I.set(p),this.data=new DataView(I.buffer),this},n.DataBuffer.prototype.putByte=function(s){return this.accommodate(1),this.data.setUint8(this.write++,s),this},n.DataBuffer.prototype.fillWithByte=function(s,d){this.accommodate(d);for(var p=0;p<d;++p)this.data.setUint8(s);return this},n.DataBuffer.prototype.putBytes=function(s,d){if(n.isArrayBufferView(s)){var p=new Uint8Array(s.buffer,s.byteOffset,s.byteLength),I=p.byteLength-p.byteOffset;this.accommodate(I);var R=new Uint8Array(this.data.buffer,this.write);return R.set(p),this.write+=I,this}if(n.isArrayBuffer(s)){var p=new Uint8Array(s);this.accommodate(p.byteLength);var R=new Uint8Array(this.data.buffer);return R.set(p,this.write),this.write+=p.byteLength,this}if(s instanceof n.DataBuffer||typeof s=="object"&&typeof s.read=="number"&&typeof s.write=="number"&&n.isArrayBufferView(s.data)){var p=new Uint8Array(s.data.byteLength,s.read,s.length());this.accommodate(p.byteLength);var R=new Uint8Array(s.data.byteLength,this.write);return R.set(p),this.write+=p.byteLength,this}if(s instanceof n.ByteStringBuffer&&(s=s.data,d="binary"),d=d||"binary",typeof s=="string"){var c;if(d==="hex")return this.accommodate(Math.ceil(s.length/2)),c=new Uint8Array(this.data.buffer,this.write),this.write+=n.binary.hex.decode(s,c,this.write),this;if(d==="base64")return this.accommodate(Math.ceil(s.length/4)*3),c=new Uint8Array(this.data.buffer,this.write),this.write+=n.binary.base64.decode(s,c,this.write),this;if(d==="utf8"&&(s=n.encodeUtf8(s),d="binary"),d==="binary"||d==="raw")return this.accommodate(s.length),c=new Uint8Array(this.data.buffer,this.write),this.write+=n.binary.raw.decode(c),this;if(d==="utf16")return this.accommodate(s.length*2),c=new Uint16Array(this.data.buffer,this.write),this.write+=n.text.utf16.encode(c),this;throw new Error("Invalid encoding: "+d)}throw Error("Invalid parameter: "+s)},n.DataBuffer.prototype.putBuffer=function(s){return this.putBytes(s),s.clear(),this},n.DataBuffer.prototype.putString=function(s){return this.putBytes(s,"utf16")},n.DataBuffer.prototype.putInt16=function(s){return this.accommodate(2),this.data.setInt16(this.write,s),this.write+=2,this},n.DataBuffer.prototype.putInt24=function(s){return this.accommodate(3),this.data.setInt16(this.write,s>>8&65535),this.data.setInt8(this.write,s>>16&255),this.write+=3,this},n.DataBuffer.prototype.putInt32=function(s){return this.accommodate(4),this.data.setInt32(this.write,s),this.write+=4,this},n.DataBuffer.prototype.putInt16Le=function(s){return this.accommodate(2),this.data.setInt16(this.write,s,!0),this.write+=2,this},n.DataBuffer.prototype.putInt24Le=function(s){return this.accommodate(3),this.data.setInt8(this.write,s>>16&255),this.data.setInt16(this.write,s>>8&65535,!0),this.write+=3,this},n.DataBuffer.prototype.putInt32Le=function(s){return this.accommodate(4),this.data.setInt32(this.write,s,!0),this.write+=4,this},n.DataBuffer.prototype.putInt=function(s,d){v(d),this.accommodate(d/8);do d-=8,this.data.setInt8(this.write++,s>>d&255);while(d>0);return this},n.DataBuffer.prototype.putSignedInt=function(s,d){return v(d),this.accommodate(d/8),s<0&&(s+=2<<d-1),this.putInt(s,d)},n.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},n.DataBuffer.prototype.getInt16=function(){var s=this.data.getInt16(this.read);return this.read+=2,s},n.DataBuffer.prototype.getInt24=function(){var s=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,s},n.DataBuffer.prototype.getInt32=function(){var s=this.data.getInt32(this.read);return this.read+=4,s},n.DataBuffer.prototype.getInt16Le=function(){var s=this.data.getInt16(this.read,!0);return this.read+=2,s},n.DataBuffer.prototype.getInt24Le=function(){var s=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,s},n.DataBuffer.prototype.getInt32Le=function(){var s=this.data.getInt32(this.read,!0);return this.read+=4,s},n.DataBuffer.prototype.getInt=function(s){v(s);var d=0;do d=(d<<8)+this.data.getInt8(this.read++),s-=8;while(s>0);return d},n.DataBuffer.prototype.getSignedInt=function(s){var d=this.getInt(s),p=2<<s-2;return d>=p&&(d-=p<<1),d},n.DataBuffer.prototype.getBytes=function(s){var d;return s?(s=Math.min(this.length(),s),d=this.data.slice(this.read,this.read+s),this.read+=s):s===0?d="":(d=this.read===0?this.data:this.data.slice(this.read),this.clear()),d},n.DataBuffer.prototype.bytes=function(s){return typeof s>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+s)},n.DataBuffer.prototype.at=function(s){return this.data.getUint8(this.read+s)},n.DataBuffer.prototype.setAt=function(s,d){return this.data.setUint8(s,d),this},n.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},n.DataBuffer.prototype.copy=function(){return new n.DataBuffer(this)},n.DataBuffer.prototype.compact=function(){if(this.read>0){var s=new Uint8Array(this.data.buffer,this.read),d=new Uint8Array(s.byteLength);d.set(s),this.data=new DataView(d),this.write-=this.read,this.read=0}return this},n.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},n.DataBuffer.prototype.truncate=function(s){return this.write=Math.max(0,this.length()-s),this.read=Math.min(this.read,this.write),this},n.DataBuffer.prototype.toHex=function(){for(var s="",d=this.read;d<this.data.byteLength;++d){var p=this.data.getUint8(d);p<16&&(s+="0"),s+=p.toString(16)}return s},n.DataBuffer.prototype.toString=function(s){var d=new Uint8Array(this.data,this.read,this.length());if(s=s||"utf8",s==="binary"||s==="raw")return n.binary.raw.encode(d);if(s==="hex")return n.binary.hex.encode(d);if(s==="base64")return n.binary.base64.encode(d);if(s==="utf8")return n.text.utf8.decode(d);if(s==="utf16")return n.text.utf16.decode(d);throw new Error("Invalid encoding: "+s)},n.createBuffer=function(s,d){return d=d||"raw",s!==void 0&&d==="utf8"&&(s=n.encodeUtf8(s)),new n.ByteBuffer(s)},n.fillString=function(s,d){for(var p="";d>0;)d&1&&(p+=s),d>>>=1,d>0&&(s+=s);return p},n.xorBytes=function(s,d,p){for(var I="",R="",c="",i=0,r=0;p>0;--p,++i)R=s.charCodeAt(i)^d.charCodeAt(i),r>=10&&(I+=c,c="",r=0),c+=String.fromCharCode(R),++r;return I+=c,I},n.hexToBytes=function(s){var d="",p=0;for(s.length&!0&&(p=1,d+=String.fromCharCode(parseInt(s[0],16)));p<s.length;p+=2)d+=String.fromCharCode(parseInt(s.substr(p,2),16));return d},n.bytesToHex=function(s){return n.createBuffer(s).toHex()},n.int32ToBytes=function(s){return String.fromCharCode(s>>24&255)+String.fromCharCode(s>>16&255)+String.fromCharCode(s>>8&255)+String.fromCharCode(s&255)};var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",m=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],f="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";n.encode64=function(s,d){for(var p="",I="",R,c,i,r=0;r<s.length;)R=s.charCodeAt(r++),c=s.charCodeAt(r++),i=s.charCodeAt(r++),p+=t.charAt(R>>2),p+=t.charAt((R&3)<<4|c>>4),isNaN(c)?p+="==":(p+=t.charAt((c&15)<<2|i>>6),p+=isNaN(i)?"=":t.charAt(i&63)),d&&p.length>d&&(I+=p.substr(0,d)+`\r
`,p=p.substr(d));return I+=p,I},n.decode64=function(s){s=s.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var d="",p,I,R,c,i=0;i<s.length;)p=m[s.charCodeAt(i++)-43],I=m[s.charCodeAt(i++)-43],R=m[s.charCodeAt(i++)-43],c=m[s.charCodeAt(i++)-43],d+=String.fromCharCode(p<<2|I>>4),R!==64&&(d+=String.fromCharCode((I&15)<<4|R>>2),c!==64&&(d+=String.fromCharCode((R&3)<<6|c)));return d},n.encodeUtf8=function(s){return unescape(encodeURIComponent(s))},n.decodeUtf8=function(s){return decodeURIComponent(escape(s))},n.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:e.encode,decode:e.decode}},n.binary.raw.encode=function(s){return String.fromCharCode.apply(null,s)},n.binary.raw.decode=function(s,d,p){var I=d;I||(I=new Uint8Array(s.length)),p=p||0;for(var R=p,c=0;c<s.length;++c)I[R++]=s.charCodeAt(c);return d?R-p:I},n.binary.hex.encode=n.bytesToHex,n.binary.hex.decode=function(s,d,p){var I=d;I||(I=new Uint8Array(Math.ceil(s.length/2))),p=p||0;var R=0,c=p;for(s.length&1&&(R=1,I[c++]=parseInt(s[0],16));R<s.length;R+=2)I[c++]=parseInt(s.substr(R,2),16);return d?c-p:I},n.binary.base64.encode=function(s,d){for(var p="",I="",R,c,i,r=0;r<s.byteLength;)R=s[r++],c=s[r++],i=s[r++],p+=t.charAt(R>>2),p+=t.charAt((R&3)<<4|c>>4),isNaN(c)?p+="==":(p+=t.charAt((c&15)<<2|i>>6),p+=isNaN(i)?"=":t.charAt(i&63)),d&&p.length>d&&(I+=p.substr(0,d)+`\r
`,p=p.substr(d));return I+=p,I},n.binary.base64.decode=function(s,d,p){var I=d;I||(I=new Uint8Array(Math.ceil(s.length/4)*3)),s=s.replace(/[^A-Za-z0-9\+\/\=]/g,""),p=p||0;for(var R,c,i,r,B=0,k=p;B<s.length;)R=m[s.charCodeAt(B++)-43],c=m[s.charCodeAt(B++)-43],i=m[s.charCodeAt(B++)-43],r=m[s.charCodeAt(B++)-43],I[k++]=R<<2|c>>4,i!==64&&(I[k++]=(c&15)<<4|i>>2,r!==64&&(I[k++]=(i&3)<<6|r));return d?k-p:I.subarray(0,k)},n.binary.base58.encode=function(s,d){return n.binary.baseN.encode(s,f,d)},n.binary.base58.decode=function(s,d){return n.binary.baseN.decode(s,f,d)},n.text={utf8:{},utf16:{}},n.text.utf8.encode=function(s,d,p){s=n.encodeUtf8(s);var I=d;I||(I=new Uint8Array(s.length)),p=p||0;for(var R=p,c=0;c<s.length;++c)I[R++]=s.charCodeAt(c);return d?R-p:I},n.text.utf8.decode=function(s){return n.decodeUtf8(String.fromCharCode.apply(null,s))},n.text.utf16.encode=function(s,d,p){var I=d;I||(I=new Uint8Array(s.length*2));var R=new Uint16Array(I.buffer);p=p||0;for(var c=p,i=p,r=0;r<s.length;++r)R[i++]=s.charCodeAt(r),c+=2;return d?c-p:I},n.text.utf16.decode=function(s){return String.fromCharCode.apply(null,new Uint16Array(s.buffer))},n.deflate=function(s,d,p){if(d=n.decode64(s.deflate(n.encode64(d)).rval),p){var I=2,R=d.charCodeAt(1);R&32&&(I=6),d=d.substring(I,d.length-4)}return d},n.inflate=function(s,d,p){var I=s.inflate(n.encode64(d)).rval;return I===null?null:n.decode64(I)};var x=function(s,d,p){if(!s)throw new Error("WebStorage not available.");var I;if(p===null?I=s.removeItem(d):(p=n.encode64(JSON.stringify(p)),I=s.setItem(d,p)),typeof I<"u"&&I.rval!==!0){var R=new Error(I.error.message);throw R.id=I.error.id,R.name=I.error.name,R}},D=function(s,d){if(!s)throw new Error("WebStorage not available.");var p=s.getItem(d);if(s.init)if(p.rval===null){if(p.error){var I=new Error(p.error.message);throw I.id=p.error.id,I.name=p.error.name,I}p=null}else p=p.rval;return p!==null&&(p=JSON.parse(n.decode64(p))),p},E=function(s,d,p,I){var R=D(s,d);R===null&&(R={}),R[p]=I,x(s,d,R)},u=function(s,d,p){var I=D(s,d);return I!==null&&(I=p in I?I[p]:null),I},y=function(s,d,p){var I=D(s,d);if(I!==null&&p in I){delete I[p];var R=!0;for(var c in I){R=!1;break}R&&(I=null),x(s,d,I)}},C=function(s,d){x(s,d,null)},g=function(s,d,p){var I=null;typeof p>"u"&&(p=["web","flash"]);var R,c=!1,i=null;for(var r in p){R=p[r];try{if(R==="flash"||R==="both"){if(d[0]===null)throw new Error("Flash local storage not available.");I=s.apply(this,d),c=R==="flash"}(R==="web"||R==="both")&&(d[0]=localStorage,I=s.apply(this,d),c=!0)}catch(B){i=B}if(c)break}if(!c)throw i;return I};return n.setItem=function(s,d,p,I,R){g(E,arguments,R)},n.getItem=function(s,d,p,I){return g(u,arguments,I)},n.removeItem=function(s,d,p,I){g(y,arguments,I)},n.clearItems=function(s,d,p){g(C,arguments,p)},n.isEmpty=function(s){for(var d in s)if(s.hasOwnProperty(d))return!1;return!0},n.format=function(s){for(var d=/%./g,p,I,R=0,c=[],i=0;p=d.exec(s);){I=s.substring(i,d.lastIndex-2),I.length>0&&c.push(I),i=d.lastIndex;var r=p[0][1];switch(r){case"s":case"o":R<arguments.length?c.push(arguments[R+++1]):c.push("<?>");break;case"%":c.push("%");break;default:c.push("<%"+r+"?>")}}return c.push(s.substring(i)),c.join("")},n.formatNumber=function(s,d,p,I){var R=s,c=isNaN(d=Math.abs(d))?2:d,i=p===void 0?",":p,r=I===void 0?".":I,B=R<0?"-":"",k=parseInt(R=Math.abs(+R||0).toFixed(c),10)+"",V=k.length>3?k.length%3:0;return B+(V?k.substr(0,V)+r:"")+k.substr(V).replace(/(\d{3})(?=\d)/g,"$1"+r)+(c?i+Math.abs(R-k).toFixed(c).slice(2):"")},n.formatSize=function(s){return s>=1073741824?s=n.formatNumber(s/1073741824,2,".","")+" GiB":s>=1048576?s=n.formatNumber(s/1048576,2,".","")+" MiB":s>=1024?s=n.formatNumber(s/1024,0)+" KiB":s=n.formatNumber(s,0)+" bytes",s},n.bytesFromIP=function(s){return s.indexOf(".")!==-1?n.bytesFromIPv4(s):s.indexOf(":")!==-1?n.bytesFromIPv6(s):null},n.bytesFromIPv4=function(s){if(s=s.split("."),s.length!==4)return null;for(var d=n.createBuffer(),p=0;p<s.length;++p){var I=parseInt(s[p],10);if(isNaN(I))return null;d.putByte(I)}return d.getBytes()},n.bytesFromIPv6=function(s){var d=0;s=s.split(":").filter(function(i){return i.length===0&&++d,!0});for(var p=(8-s.length+d)*2,I=n.createBuffer(),R=0;R<8;++R){if(!s[R]||s[R].length===0){I.fillWithByte(0,p),p=0;continue}var c=n.hexToBytes(s[R]);c.length<2&&I.putByte(0),I.putBytes(c)}return I.getBytes()},n.bytesToIP=function(s){return s.length===4?n.bytesToIPv4(s):s.length===16?n.bytesToIPv6(s):null},n.bytesToIPv4=function(s){if(s.length!==4)return null;for(var d=[],p=0;p<s.length;++p)d.push(s.charCodeAt(p));return d.join(".")},n.bytesToIPv6=function(s){if(s.length!==16)return null;for(var d=[],p=[],I=0,R=0;R<s.length;R+=2){for(var c=n.bytesToHex(s[R]+s[R+1]);c[0]==="0"&&c!=="0";)c=c.substr(1);if(c==="0"){var i=p[p.length-1],r=d.length;!i||r!==i.end+1?p.push({start:r,end:r}):(i.end=r,i.end-i.start>p[I].end-p[I].start&&(I=p.length-1))}d.push(c)}if(p.length>0){var B=p[I];B.end-B.start>0&&(d.splice(B.start,B.end-B.start+1,""),B.start===0&&d.unshift(""),B.end===7&&d.push(""))}return d.join(":")},n.estimateCores=function(s,d){if(typeof s=="function"&&(d=s,s={}),s=s||{},"cores"in n&&!s.update)return d(null,n.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return n.cores=navigator.hardwareConcurrency,d(null,n.cores);if(typeof Worker>"u")return n.cores=1,d(null,n.cores);if(typeof Blob>"u")return n.cores=2,d(null,n.cores);var p=URL.createObjectURL(new Blob(["(",(function(){self.addEventListener("message",function(i){var r=Date.now(),B=r+4;self.postMessage({st:r,et:B})})}).toString(),")()"],{type:"application/javascript"}));I([],5,16);function I(i,r,B){if(r===0){var k=Math.floor(i.reduce(function(V,L){return V+L},0)/i.length);return n.cores=Math.max(1,k),URL.revokeObjectURL(p),d(null,n.cores)}R(B,function(V,L){i.push(c(B,L)),I(i,r-1,B)})}function R(i,r){for(var B=[],k=[],V=0;V<i;++V){var L=new Worker(p);L.addEventListener("message",function(O){if(k.push(O.data),k.length===i){for(var q=0;q<i;++q)B[q].terminate();r(null,k)}}),B.push(L)}for(var V=0;V<i;++V)B[V].postMessage(V)}function c(i,r){for(var B=[],k=0;k<i;++k)for(var V=r[k],L=B[k]=[],O=0;O<i;++O)if(k!==O){var q=r[O];(V.st>q.st&&V.st<q.et||q.st>V.st&&q.st<V.et)&&L.push(O)}return B.reduce(function(M,H){return Math.max(M,H.length)},0)}},Rt.exports}var Lt,Ir;function pr(){if(Ir)return Lt;Ir=1;var a=le();de(),Lt=a.cipher=a.cipher||{},a.cipher.algorithms=a.cipher.algorithms||{},a.cipher.createCipher=function(n,v){var N=n;if(typeof N=="string"&&(N=a.cipher.getAlgorithm(N),N&&(N=N())),!N)throw new Error("Unsupported algorithm: "+n);return new a.cipher.BlockCipher({algorithm:N,key:v,decrypt:!1})},a.cipher.createDecipher=function(n,v){var N=n;if(typeof N=="string"&&(N=a.cipher.getAlgorithm(N),N&&(N=N())),!N)throw new Error("Unsupported algorithm: "+n);return new a.cipher.BlockCipher({algorithm:N,key:v,decrypt:!0})},a.cipher.registerAlgorithm=function(n,v){n=n.toUpperCase(),a.cipher.algorithms[n]=v},a.cipher.getAlgorithm=function(n){return n=n.toUpperCase(),n in a.cipher.algorithms?a.cipher.algorithms[n]:null};var e=a.cipher.BlockCipher=function(n){this.algorithm=n.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=n.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=n.decrypt,this.algorithm.initialize(n)};return e.prototype.start=function(n){n=n||{};var v={};for(var N in n)v[N]=n[N];v.decrypt=this._decrypt,this._finish=!1,this._input=a.util.createBuffer(),this.output=n.output||a.util.createBuffer(),this.mode.start(v)},e.prototype.update=function(n){for(n&&this._input.putBuffer(n);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},e.prototype.finish=function(n){n&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(N){return n(this.blockSize,N,!1)},this.mode.unpad=function(N){return n(this.blockSize,N,!0)});var v={};return v.decrypt=this._decrypt,v.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,v)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,v))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,v))},Lt}var kt={exports:{}},Ar;function ca(){if(Ar)return kt.exports;Ar=1;var a=le();de(),a.cipher=a.cipher||{};var e=kt.exports=a.cipher.modes=a.cipher.modes||{};e.ecb=function(S){S=S||{},this.name="ECB",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.ecb.prototype.start=function(S){},e.ecb.prototype.encrypt=function(S,h,t){if(S.length()<this.blockSize&&!(t&&S.length()>0))return!0;for(var m=0;m<this._ints;++m)this._inBlock[m]=S.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var m=0;m<this._ints;++m)h.putInt32(this._outBlock[m])},e.ecb.prototype.decrypt=function(S,h,t){if(S.length()<this.blockSize&&!(t&&S.length()>0))return!0;for(var m=0;m<this._ints;++m)this._inBlock[m]=S.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var m=0;m<this._ints;++m)h.putInt32(this._outBlock[m])},e.ecb.prototype.pad=function(S,h){var t=S.length()===this.blockSize?this.blockSize:this.blockSize-S.length();return S.fillWithByte(t,t),!0},e.ecb.prototype.unpad=function(S,h){if(h.overflow>0)return!1;var t=S.length(),m=S.at(t-1);return m>this.blockSize<<2?!1:(S.truncate(m),!0)},e.cbc=function(S){S=S||{},this.name="CBC",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},e.cbc.prototype.start=function(S){if(S.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in S)this._iv=n(S.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},e.cbc.prototype.encrypt=function(S,h,t){if(S.length()<this.blockSize&&!(t&&S.length()>0))return!0;for(var m=0;m<this._ints;++m)this._inBlock[m]=this._prev[m]^S.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var m=0;m<this._ints;++m)h.putInt32(this._outBlock[m]);this._prev=this._outBlock},e.cbc.prototype.decrypt=function(S,h,t){if(S.length()<this.blockSize&&!(t&&S.length()>0))return!0;for(var m=0;m<this._ints;++m)this._inBlock[m]=S.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var m=0;m<this._ints;++m)h.putInt32(this._prev[m]^this._outBlock[m]);this._prev=this._inBlock.slice(0)},e.cbc.prototype.pad=function(S,h){var t=S.length()===this.blockSize?this.blockSize:this.blockSize-S.length();return S.fillWithByte(t,t),!0},e.cbc.prototype.unpad=function(S,h){if(h.overflow>0)return!1;var t=S.length(),m=S.at(t-1);return m>this.blockSize<<2?!1:(S.truncate(m),!0)},e.cfb=function(S){S=S||{},this.name="CFB",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0},e.cfb.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");this._iv=n(S.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.cfb.prototype.encrypt=function(S,h,t){var m=S.length();if(m===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&m>=this.blockSize){for(var f=0;f<this._ints;++f)this._inBlock[f]=S.getInt32()^this._outBlock[f],h.putInt32(this._inBlock[f]);return}var x=(this.blockSize-m)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialBlock[f]=S.getInt32()^this._outBlock[f],this._partialOutput.putInt32(this._partialBlock[f]);if(x>0)S.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=0},e.cfb.prototype.decrypt=function(S,h,t){var m=S.length();if(m===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&m>=this.blockSize){for(var f=0;f<this._ints;++f)this._inBlock[f]=S.getInt32(),h.putInt32(this._inBlock[f]^this._outBlock[f]);return}var x=(this.blockSize-m)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialBlock[f]=S.getInt32(),this._partialOutput.putInt32(this._partialBlock[f]^this._outBlock[f]);if(x>0)S.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=0},e.ofb=function(S){S=S||{},this.name="OFB",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0},e.ofb.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");this._iv=n(S.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ofb.prototype.encrypt=function(S,h,t){var m=S.length();if(S.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&m>=this.blockSize){for(var f=0;f<this._ints;++f)h.putInt32(S.getInt32()^this._outBlock[f]),this._inBlock[f]=this._outBlock[f];return}var x=(this.blockSize-m)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(S.getInt32()^this._outBlock[f]);if(x>0)S.read-=this.blockSize;else for(var f=0;f<this._ints;++f)this._inBlock[f]=this._outBlock[f];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=0},e.ofb.prototype.decrypt=e.ofb.prototype.encrypt,e.ctr=function(S){S=S||{},this.name="CTR",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0},e.ctr.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");this._iv=n(S.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},e.ctr.prototype.encrypt=function(S,h,t){var m=S.length();if(m===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&m>=this.blockSize)for(var f=0;f<this._ints;++f)h.putInt32(S.getInt32()^this._outBlock[f]);else{var x=(this.blockSize-m)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(S.getInt32()^this._outBlock[f]);if(x>0&&(S.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=0}v(this._inBlock)},e.ctr.prototype.decrypt=e.ctr.prototype.encrypt,e.gcm=function(S){S=S||{},this.name="GCM",this.cipher=S.cipher,this.blockSize=S.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=a.util.createBuffer(),this._partialBytes=0,this._R=3774873600},e.gcm.prototype.start=function(S){if(!("iv"in S))throw new Error("Invalid IV parameter.");var h=a.util.createBuffer(S.iv);this._cipherLength=0;var t;if("additionalData"in S?t=a.util.createBuffer(S.additionalData):t=a.util.createBuffer(),"tagLength"in S?this._tagLength=S.tagLength:this._tagLength=128,this._tag=null,S.decrypt&&(this._tag=a.util.createBuffer(S.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var m=h.length();if(m===12)this._j0=[h.getInt32(),h.getInt32(),h.getInt32(),1];else{for(this._j0=[0,0,0,0];h.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[h.getInt32(),h.getInt32(),h.getInt32(),h.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(N(m*8)))}this._inBlock=this._j0.slice(0),v(this._inBlock),this._partialBytes=0,t=a.util.createBuffer(t),this._aDataLength=N(t.length()*8);var f=t.length()%this.blockSize;for(f&&t.fillWithByte(0,this.blockSize-f),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},e.gcm.prototype.encrypt=function(S,h,t){var m=S.length();if(m===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&m>=this.blockSize){for(var f=0;f<this._ints;++f)h.putInt32(this._outBlock[f]^=S.getInt32());this._cipherLength+=this.blockSize}else{var x=(this.blockSize-m)%this.blockSize;x>0&&(x=this.blockSize-x),this._partialOutput.clear();for(var f=0;f<this._ints;++f)this._partialOutput.putInt32(S.getInt32()^this._outBlock[f]);if(x<=0||t){if(t){var D=m%this.blockSize;this._cipherLength+=D,this._partialOutput.truncate(this.blockSize-D)}else this._cipherLength+=this.blockSize;for(var f=0;f<this._ints;++f)this._outBlock[f]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),x>0&&!t)return S.read-=this.blockSize,h.putBytes(this._partialOutput.getBytes(x-this._partialBytes)),this._partialBytes=x,!0;h.putBytes(this._partialOutput.getBytes(m-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),v(this._inBlock)},e.gcm.prototype.decrypt=function(S,h,t){var m=S.length();if(m<this.blockSize&&!(t&&m>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),v(this._inBlock),this._hashBlock[0]=S.getInt32(),this._hashBlock[1]=S.getInt32(),this._hashBlock[2]=S.getInt32(),this._hashBlock[3]=S.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var f=0;f<this._ints;++f)h.putInt32(this._outBlock[f]^this._hashBlock[f]);m<this.blockSize?this._cipherLength+=m%this.blockSize:this._cipherLength+=this.blockSize},e.gcm.prototype.afterFinish=function(S,h){var t=!0;h.decrypt&&h.overflow&&S.truncate(this.blockSize-h.overflow),this.tag=a.util.createBuffer();var m=this._aDataLength.concat(N(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,m);var f=[];this.cipher.encrypt(this._j0,f);for(var x=0;x<this._ints;++x)this.tag.putInt32(this._s[x]^f[x]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),h.decrypt&&this.tag.bytes()!==this._tag&&(t=!1),t},e.gcm.prototype.multiply=function(S,h){for(var t=[0,0,0,0],m=h.slice(0),f=0;f<128;++f){var x=S[f/32|0]&1<<31-f%32;x&&(t[0]^=m[0],t[1]^=m[1],t[2]^=m[2],t[3]^=m[3]),this.pow(m,m)}return t},e.gcm.prototype.pow=function(S,h){for(var t=S[3]&1,m=3;m>0;--m)h[m]=S[m]>>>1|(S[m-1]&1)<<31;h[0]=S[0]>>>1,t&&(h[0]^=this._R)},e.gcm.prototype.tableMultiply=function(S){for(var h=[0,0,0,0],t=0;t<32;++t){var m=t/8|0,f=S[m]>>>(7-t%8)*4&15,x=this._m[t][f];h[0]^=x[0],h[1]^=x[1],h[2]^=x[2],h[3]^=x[3]}return h},e.gcm.prototype.ghash=function(S,h,t){return h[0]^=t[0],h[1]^=t[1],h[2]^=t[2],h[3]^=t[3],this.tableMultiply(h)},e.gcm.prototype.generateHashTable=function(S,h){for(var t=8/h,m=4*t,f=16*t,x=new Array(f),D=0;D<f;++D){var E=[0,0,0,0],u=D/m|0,y=(m-1-D%m)*h;E[u]=1<<h-1<<y,x[D]=this.generateSubHashTable(this.multiply(E,S),h)}return x},e.gcm.prototype.generateSubHashTable=function(S,h){var t=1<<h,m=t>>>1,f=new Array(t);f[m]=S.slice(0);for(var x=m>>>1;x>0;)this.pow(f[2*x],f[x]=[]),x>>=1;for(x=2;x<m;){for(var D=1;D<x;++D){var E=f[x],u=f[D];f[x+D]=[E[0]^u[0],E[1]^u[1],E[2]^u[2],E[3]^u[3]]}x*=2}for(f[0]=[0,0,0,0],x=m+1;x<t;++x){var y=f[x^m];f[x]=[S[0]^y[0],S[1]^y[1],S[2]^y[2],S[3]^y[3]]}return f};function n(S,h){if(typeof S=="string"&&(S=a.util.createBuffer(S)),a.util.isArray(S)&&S.length>4){var t=S;S=a.util.createBuffer();for(var m=0;m<t.length;++m)S.putByte(t[m])}if(S.length()<h)throw new Error("Invalid IV length; got "+S.length()+" bytes and expected "+h+" bytes.");if(!a.util.isArray(S)){for(var f=[],x=h/4,m=0;m<x;++m)f.push(S.getInt32());S=f}return S}function v(S){S[S.length-1]=S[S.length-1]+1&4294967295}function N(S){return[S/4294967296|0,S&4294967295]}return kt.exports}var Dt,Br;function ut(){if(Br)return Dt;Br=1;var a=le();pr(),ca(),de(),Dt=a.aes=a.aes||{},a.aes.startEncrypting=function(u,y,C,g){var s=E({key:u,output:C,decrypt:!1,mode:g});return s.start(y),s},a.aes.createEncryptionCipher=function(u,y){return E({key:u,output:null,decrypt:!1,mode:y})},a.aes.startDecrypting=function(u,y,C,g){var s=E({key:u,output:C,decrypt:!0,mode:g});return s.start(y),s},a.aes.createDecryptionCipher=function(u,y){return E({key:u,output:null,decrypt:!0,mode:y})},a.aes.Algorithm=function(u,y){n||f();var C=this;C.name=u,C.mode=new y({blockSize:16,cipher:{encrypt:function(g,s){return D(C._w,g,s,!1)},decrypt:function(g,s){return D(C._w,g,s,!0)}}}),C._init=!1},a.aes.Algorithm.prototype.initialize=function(u){if(!this._init){var y=u.key,C;if(typeof y=="string"&&(y.length===16||y.length===24||y.length===32))y=a.util.createBuffer(y);else if(a.util.isArray(y)&&(y.length===16||y.length===24||y.length===32)){C=y,y=a.util.createBuffer();for(var g=0;g<C.length;++g)y.putByte(C[g])}if(!a.util.isArray(y)){C=y,y=[];var s=C.length();if(s===16||s===24||s===32){s=s>>>2;for(var g=0;g<s;++g)y.push(C.getInt32())}}if(!a.util.isArray(y)||!(y.length===4||y.length===6||y.length===8))throw new Error("Invalid key parameter.");var d=this.mode.name,p=["CFB","OFB","CTR","GCM"].indexOf(d)!==-1;this._w=x(y,u.decrypt&&!p),this._init=!0}},a.aes._expandKey=function(u,y){return n||f(),x(u,y)},a.aes._updateBlock=D,e("AES-ECB",a.cipher.modes.ecb),e("AES-CBC",a.cipher.modes.cbc),e("AES-CFB",a.cipher.modes.cfb),e("AES-OFB",a.cipher.modes.ofb),e("AES-CTR",a.cipher.modes.ctr),e("AES-GCM",a.cipher.modes.gcm);function e(u,y){var C=function(){return new a.aes.Algorithm(u,y)};a.cipher.registerAlgorithm(u,C)}var n=!1,v=4,N,S,h,t,m;function f(){n=!0,h=[0,1,2,4,8,16,32,64,128,27,54];for(var u=new Array(256),y=0;y<128;++y)u[y]=y<<1,u[y+128]=y+128<<1^283;N=new Array(256),S=new Array(256),t=new Array(4),m=new Array(4);for(var y=0;y<4;++y)t[y]=new Array(256),m[y]=new Array(256);for(var C=0,g=0,s,d,p,I,R,c,i,y=0;y<256;++y){I=g^g<<1^g<<2^g<<3^g<<4,I=I>>8^I&255^99,N[C]=I,S[I]=C,R=u[I],s=u[C],d=u[s],p=u[d],c=R<<24^I<<16^I<<8^(I^R),i=(s^d^p)<<24^(C^p)<<16^(C^d^p)<<8^(C^s^p);for(var r=0;r<4;++r)t[r][C]=c,m[r][I]=i,c=c<<24|c>>>8,i=i<<24|i>>>8;C===0?C=g=1:(C=s^u[u[u[s^p]]],g^=u[u[g]])}}function x(u,y){for(var C=u.slice(0),g,s=1,d=C.length,p=d+6+1,I=v*p,R=d;R<I;++R)g=C[R-1],R%d===0?(g=N[g>>>16&255]<<24^N[g>>>8&255]<<16^N[g&255]<<8^N[g>>>24]^h[s]<<24,s++):d>6&&R%d===4&&(g=N[g>>>24]<<24^N[g>>>16&255]<<16^N[g>>>8&255]<<8^N[g&255]),C[R]=C[R-d]^g;if(y){var c,i=m[0],r=m[1],B=m[2],k=m[3],V=C.slice(0);I=C.length;for(var R=0,L=I-v;R<I;R+=v,L-=v)if(R===0||R===I-v)V[R]=C[L],V[R+1]=C[L+3],V[R+2]=C[L+2],V[R+3]=C[L+1];else for(var O=0;O<v;++O)c=C[L+O],V[R+(3&-O)]=i[N[c>>>24]]^r[N[c>>>16&255]]^B[N[c>>>8&255]]^k[N[c&255]];C=V}return C}function D(u,y,C,g){var s=u.length/4-1,d,p,I,R,c;g?(d=m[0],p=m[1],I=m[2],R=m[3],c=S):(d=t[0],p=t[1],I=t[2],R=t[3],c=N);var i,r,B,k,V,L,O;i=y[0]^u[0],r=y[g?3:1]^u[1],B=y[2]^u[2],k=y[g?1:3]^u[3];for(var q=3,M=1;M<s;++M)V=d[i>>>24]^p[r>>>16&255]^I[B>>>8&255]^R[k&255]^u[++q],L=d[r>>>24]^p[B>>>16&255]^I[k>>>8&255]^R[i&255]^u[++q],O=d[B>>>24]^p[k>>>16&255]^I[i>>>8&255]^R[r&255]^u[++q],k=d[k>>>24]^p[i>>>16&255]^I[r>>>8&255]^R[B&255]^u[++q],i=V,r=L,B=O;C[0]=c[i>>>24]<<24^c[r>>>16&255]<<16^c[B>>>8&255]<<8^c[k&255]^u[++q],C[g?3:1]=c[r>>>24]<<24^c[B>>>16&255]<<16^c[k>>>8&255]<<8^c[i&255]^u[++q],C[2]=c[B>>>24]<<24^c[k>>>16&255]<<16^c[i>>>8&255]<<8^c[r&255]^u[++q],C[g?1:3]=c[k>>>24]<<24^c[i>>>16&255]<<16^c[r>>>8&255]<<8^c[B&255]^u[++q]}function E(u){u=u||{};var y=(u.mode||"CBC").toUpperCase(),C="AES-"+y,g;u.decrypt?g=a.cipher.createDecipher(C,u.key):g=a.cipher.createCipher(C,u.key);var s=g.start;return g.start=function(d,p){var I=null;p instanceof a.util.ByteBuffer&&(I=p,p={}),p=p||{},p.output=I,p.iv=d,s.call(g,p)},g}return Dt}var Ut={exports:{}},Pt={exports:{}},Vt={exports:{}},br;function lt(){if(br)return Vt.exports;br=1;var a=le();a.pki=a.pki||{};var e=Vt.exports=a.pki.oids=a.oids=a.oids||{};function n(N,S){e[N]=S,e[S]=N}function v(N,S){e[N]=S}return n("1.2.840.113549.1.1.1","rsaEncryption"),n("1.2.840.113549.1.1.4","md5WithRSAEncryption"),n("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),n("1.2.840.113549.1.1.7","RSAES-OAEP"),n("1.2.840.113549.1.1.8","mgf1"),n("1.2.840.113549.1.1.9","pSpecified"),n("1.2.840.113549.1.1.10","RSASSA-PSS"),n("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),n("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),n("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),n("1.3.101.112","EdDSA25519"),n("1.2.840.10040.4.3","dsa-with-sha1"),n("1.3.14.3.2.7","desCBC"),n("1.3.14.3.2.26","sha1"),n("1.3.14.3.2.29","sha1WithRSASignature"),n("2.16.840.1.101.3.4.2.1","sha256"),n("2.16.840.1.101.3.4.2.2","sha384"),n("2.16.840.1.101.3.4.2.3","sha512"),n("2.16.840.1.101.3.4.2.4","sha224"),n("2.16.840.1.101.3.4.2.5","sha512-224"),n("2.16.840.1.101.3.4.2.6","sha512-256"),n("1.2.840.113549.2.2","md2"),n("1.2.840.113549.2.5","md5"),n("1.2.840.113549.1.7.1","data"),n("1.2.840.113549.1.7.2","signedData"),n("1.2.840.113549.1.7.3","envelopedData"),n("1.2.840.113549.1.7.4","signedAndEnvelopedData"),n("1.2.840.113549.1.7.5","digestedData"),n("1.2.840.113549.1.7.6","encryptedData"),n("1.2.840.113549.1.9.1","emailAddress"),n("1.2.840.113549.1.9.2","unstructuredName"),n("1.2.840.113549.1.9.3","contentType"),n("1.2.840.113549.1.9.4","messageDigest"),n("1.2.840.113549.1.9.5","signingTime"),n("1.2.840.113549.1.9.6","counterSignature"),n("1.2.840.113549.1.9.7","challengePassword"),n("1.2.840.113549.1.9.8","unstructuredAddress"),n("1.2.840.113549.1.9.14","extensionRequest"),n("1.2.840.113549.1.9.20","friendlyName"),n("1.2.840.113549.1.9.21","localKeyId"),n("1.2.840.113549.1.9.22.1","x509Certificate"),n("1.2.840.113549.1.12.10.1.1","keyBag"),n("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),n("1.2.840.113549.1.12.10.1.3","certBag"),n("1.2.840.113549.1.12.10.1.4","crlBag"),n("1.2.840.113549.1.12.10.1.5","secretBag"),n("1.2.840.113549.1.12.10.1.6","safeContentsBag"),n("1.2.840.113549.1.5.13","pkcs5PBES2"),n("1.2.840.113549.1.5.12","pkcs5PBKDF2"),n("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),n("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),n("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),n("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),n("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),n("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),n("1.2.840.113549.2.7","hmacWithSHA1"),n("1.2.840.113549.2.8","hmacWithSHA224"),n("1.2.840.113549.2.9","hmacWithSHA256"),n("1.2.840.113549.2.10","hmacWithSHA384"),n("1.2.840.113549.2.11","hmacWithSHA512"),n("1.2.840.113549.3.7","des-EDE3-CBC"),n("2.16.840.1.101.3.4.1.2","aes128-CBC"),n("2.16.840.1.101.3.4.1.22","aes192-CBC"),n("2.16.840.1.101.3.4.1.42","aes256-CBC"),n("2.5.4.3","commonName"),n("2.5.4.4","surname"),n("2.5.4.5","serialNumber"),n("2.5.4.6","countryName"),n("2.5.4.7","localityName"),n("2.5.4.8","stateOrProvinceName"),n("2.5.4.9","streetAddress"),n("2.5.4.10","organizationName"),n("2.5.4.11","organizationalUnitName"),n("2.5.4.12","title"),n("2.5.4.13","description"),n("2.5.4.15","businessCategory"),n("2.5.4.17","postalCode"),n("2.5.4.42","givenName"),n("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),n("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),n("2.16.840.1.113730.1.1","nsCertType"),n("2.16.840.1.113730.1.13","nsComment"),v("2.5.29.1","authorityKeyIdentifier"),v("2.5.29.2","keyAttributes"),v("2.5.29.3","certificatePolicies"),v("2.5.29.4","keyUsageRestriction"),v("2.5.29.5","policyMapping"),v("2.5.29.6","subtreesConstraint"),v("2.5.29.7","subjectAltName"),v("2.5.29.8","issuerAltName"),v("2.5.29.9","subjectDirectoryAttributes"),v("2.5.29.10","basicConstraints"),v("2.5.29.11","nameConstraints"),v("2.5.29.12","policyConstraints"),v("2.5.29.13","basicConstraints"),n("2.5.29.14","subjectKeyIdentifier"),n("2.5.29.15","keyUsage"),v("2.5.29.16","privateKeyUsagePeriod"),n("2.5.29.17","subjectAltName"),n("2.5.29.18","issuerAltName"),n("2.5.29.19","basicConstraints"),v("2.5.29.20","cRLNumber"),v("2.5.29.21","cRLReason"),v("2.5.29.22","expirationDate"),v("2.5.29.23","instructionCode"),v("2.5.29.24","invalidityDate"),v("2.5.29.25","cRLDistributionPoints"),v("2.5.29.26","issuingDistributionPoint"),v("2.5.29.27","deltaCRLIndicator"),v("2.5.29.28","issuingDistributionPoint"),v("2.5.29.29","certificateIssuer"),v("2.5.29.30","nameConstraints"),n("2.5.29.31","cRLDistributionPoints"),n("2.5.29.32","certificatePolicies"),v("2.5.29.33","policyMappings"),v("2.5.29.34","policyConstraints"),n("2.5.29.35","authorityKeyIdentifier"),v("2.5.29.36","policyConstraints"),n("2.5.29.37","extKeyUsage"),v("2.5.29.46","freshestCRL"),v("2.5.29.54","inhibitAnyPolicy"),n("1.3.6.1.4.1.11129.2.4.2","timestampList"),n("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),n("1.3.6.1.5.5.7.3.1","serverAuth"),n("1.3.6.1.5.5.7.3.2","clientAuth"),n("1.3.6.1.5.5.7.3.3","codeSigning"),n("1.3.6.1.5.5.7.3.4","emailProtection"),n("1.3.6.1.5.5.7.3.8","timeStamping"),Vt.exports}var _r;function tt(){if(_r)return Pt.exports;_r=1;var a=le();de(),lt();var e=Pt.exports=a.asn1=a.asn1||{};e.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},e.create=function(h,t,m,f,x){if(a.util.isArray(f)){for(var D=[],E=0;E<f.length;++E)f[E]!==void 0&&D.push(f[E]);f=D}var u={tagClass:h,type:t,constructed:m,composed:m||a.util.isArray(f),value:f};return x&&"bitStringContents"in x&&(u.bitStringContents=x.bitStringContents,u.original=e.copy(u)),u},e.copy=function(h,t){var m;if(a.util.isArray(h)){m=[];for(var f=0;f<h.length;++f)m.push(e.copy(h[f],t));return m}return typeof h=="string"?h:(m={tagClass:h.tagClass,type:h.type,constructed:h.constructed,composed:h.composed,value:e.copy(h.value,t)},t&&!t.excludeBitStringContents&&(m.bitStringContents=h.bitStringContents),m)},e.equals=function(h,t,m){if(a.util.isArray(h)){if(!a.util.isArray(t)||h.length!==t.length)return!1;for(var f=0;f<h.length;++f)if(!e.equals(h[f],t[f]))return!1;return!0}if(typeof h!=typeof t)return!1;if(typeof h=="string")return h===t;var x=h.tagClass===t.tagClass&&h.type===t.type&&h.constructed===t.constructed&&h.composed===t.composed&&e.equals(h.value,t.value);return m&&m.includeBitStringContents&&(x=x&&h.bitStringContents===t.bitStringContents),x},e.getBerValueLength=function(h){var t=h.getByte();if(t!==128){var m,f=t&128;return f?m=h.getInt((t&127)<<3):m=t,m}};function n(h,t,m){if(m>t){var f=new Error("Too few bytes to parse DER.");throw f.available=h.length(),f.remaining=t,f.requested=m,f}}var v=function(h,t){var m=h.getByte();if(t--,m!==128){var f,x=m&128;if(!x)f=m;else{var D=m&127;n(h,t,D),f=h.getInt(D<<3)}if(f<0)throw new Error("Negative length: "+f);return f}};e.fromDer=function(h,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof h=="string"&&(h=a.util.createBuffer(h));var m=h.length(),f=N(h,h.length(),0,t);if(t.parseAllBytes&&h.length()!==0){var x=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw x.byteCount=m,x.remaining=h.length(),x}return f};function N(h,t,m,f){var x;n(h,t,2);var D=h.getByte();t--;var E=D&192,u=D&31;x=h.length();var y=v(h,t);if(t-=x-h.length(),y!==void 0&&y>t){if(f.strict){var C=new Error("Too few bytes to read ASN.1 value.");throw C.available=h.length(),C.remaining=t,C.requested=y,C}y=t}var g,s,d=(D&32)===32;if(d)if(g=[],y===void 0)for(;;){if(n(h,t,2),h.bytes(2)==="\0\0"){h.getBytes(2),t-=2;break}x=h.length(),g.push(N(h,t,m+1,f)),t-=x-h.length()}else for(;y>0;)x=h.length(),g.push(N(h,y,m+1,f)),t-=x-h.length(),y-=x-h.length();if(g===void 0&&E===e.Class.UNIVERSAL&&u===e.Type.BITSTRING&&(s=h.bytes(y)),g===void 0&&f.decodeBitStrings&&E===e.Class.UNIVERSAL&&u===e.Type.BITSTRING&&y>1){var p=h.read,I=t,R=0;if(u===e.Type.BITSTRING&&(n(h,t,1),R=h.getByte(),t--),R===0)try{x=h.length();var c={strict:!0,decodeBitStrings:!0},i=N(h,t,m+1,c),r=x-h.length();t-=r,u==e.Type.BITSTRING&&r++;var B=i.tagClass;r===y&&(B===e.Class.UNIVERSAL||B===e.Class.CONTEXT_SPECIFIC)&&(g=[i])}catch{}g===void 0&&(h.read=p,t=I)}if(g===void 0){if(y===void 0){if(f.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");y=t}if(u===e.Type.BMPSTRING)for(g="";y>0;y-=2)n(h,t,2),g+=String.fromCharCode(h.getInt16()),t-=2;else g=h.getBytes(y),t-=y}var k=s===void 0?null:{bitStringContents:s};return e.create(E,u,d,g,k)}e.toDer=function(h){var t=a.util.createBuffer(),m=h.tagClass|h.type,f=a.util.createBuffer(),x=!1;if("bitStringContents"in h&&(x=!0,h.original&&(x=e.equals(h,h.original))),x)f.putBytes(h.bitStringContents);else if(h.composed){h.constructed?m|=32:f.putByte(0);for(var D=0;D<h.value.length;++D)h.value[D]!==void 0&&f.putBuffer(e.toDer(h.value[D]))}else if(h.type===e.Type.BMPSTRING)for(var D=0;D<h.value.length;++D)f.putInt16(h.value.charCodeAt(D));else h.type===e.Type.INTEGER&&h.value.length>1&&(h.value.charCodeAt(0)===0&&(h.value.charCodeAt(1)&128)===0||h.value.charCodeAt(0)===255&&(h.value.charCodeAt(1)&128)===128)?f.putBytes(h.value.substr(1)):f.putBytes(h.value);if(t.putByte(m),f.length()<=127)t.putByte(f.length()&127);else{var E=f.length(),u="";do u+=String.fromCharCode(E&255),E=E>>>8;while(E>0);t.putByte(u.length|128);for(var D=u.length-1;D>=0;--D)t.putByte(u.charCodeAt(D))}return t.putBuffer(f),t},e.oidToDer=function(h){var t=h.split("."),m=a.util.createBuffer();m.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var f,x,D,E,u=2;u<t.length;++u){f=!0,x=[],D=parseInt(t[u],10);do E=D&127,D=D>>>7,f||(E|=128),x.push(E),f=!1;while(D>0);for(var y=x.length-1;y>=0;--y)m.putByte(x[y])}return m},e.derToOid=function(h){var t;typeof h=="string"&&(h=a.util.createBuffer(h));var m=h.getByte();t=Math.floor(m/40)+"."+m%40;for(var f=0;h.length()>0;)m=h.getByte(),f=f<<7,m&128?f+=m&127:(t+="."+(f+m),f=0);return t},e.utcTimeToDate=function(h){var t=new Date,m=parseInt(h.substr(0,2),10);m=m>=50?1900+m:2e3+m;var f=parseInt(h.substr(2,2),10)-1,x=parseInt(h.substr(4,2),10),D=parseInt(h.substr(6,2),10),E=parseInt(h.substr(8,2),10),u=0;if(h.length>11){var y=h.charAt(10),C=10;y!=="+"&&y!=="-"&&(u=parseInt(h.substr(10,2),10),C+=2)}if(t.setUTCFullYear(m,f,x),t.setUTCHours(D,E,u,0),C&&(y=h.charAt(C),y==="+"||y==="-")){var g=parseInt(h.substr(C+1,2),10),s=parseInt(h.substr(C+4,2),10),d=g*60+s;d*=6e4,y==="+"?t.setTime(+t-d):t.setTime(+t+d)}return t},e.generalizedTimeToDate=function(h){var t=new Date,m=parseInt(h.substr(0,4),10),f=parseInt(h.substr(4,2),10)-1,x=parseInt(h.substr(6,2),10),D=parseInt(h.substr(8,2),10),E=parseInt(h.substr(10,2),10),u=parseInt(h.substr(12,2),10),y=0,C=0,g=!1;h.charAt(h.length-1)==="Z"&&(g=!0);var s=h.length-5,d=h.charAt(s);if(d==="+"||d==="-"){var p=parseInt(h.substr(s+1,2),10),I=parseInt(h.substr(s+4,2),10);C=p*60+I,C*=6e4,d==="+"&&(C*=-1),g=!0}return h.charAt(14)==="."&&(y=parseFloat(h.substr(14),10)*1e3),g?(t.setUTCFullYear(m,f,x),t.setUTCHours(D,E,u,y),t.setTime(+t+C)):(t.setFullYear(m,f,x),t.setHours(D,E,u,y)),t},e.dateToUtcTime=function(h){if(typeof h=="string")return h;var t="",m=[];m.push((""+h.getUTCFullYear()).substr(2)),m.push(""+(h.getUTCMonth()+1)),m.push(""+h.getUTCDate()),m.push(""+h.getUTCHours()),m.push(""+h.getUTCMinutes()),m.push(""+h.getUTCSeconds());for(var f=0;f<m.length;++f)m[f].length<2&&(t+="0"),t+=m[f];return t+="Z",t},e.dateToGeneralizedTime=function(h){if(typeof h=="string")return h;var t="",m=[];m.push(""+h.getUTCFullYear()),m.push(""+(h.getUTCMonth()+1)),m.push(""+h.getUTCDate()),m.push(""+h.getUTCHours()),m.push(""+h.getUTCMinutes()),m.push(""+h.getUTCSeconds());for(var f=0;f<m.length;++f)m[f].length<2&&(t+="0"),t+=m[f];return t+="Z",t},e.integerToDer=function(h){var t=a.util.createBuffer();if(h>=-128&&h<128)return t.putSignedInt(h,8);if(h>=-32768&&h<32768)return t.putSignedInt(h,16);if(h>=-8388608&&h<8388608)return t.putSignedInt(h,24);if(h>=-2147483648&&h<2147483648)return t.putSignedInt(h,32);var m=new Error("Integer too large; max is 32-bits.");throw m.integer=h,m},e.derToInteger=function(h){typeof h=="string"&&(h=a.util.createBuffer(h));var t=h.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return h.getSignedInt(t)},e.validate=function(h,t,m,f){var x=!1;if((h.tagClass===t.tagClass||typeof t.tagClass>"u")&&(h.type===t.type||typeof t.type>"u"))if(h.constructed===t.constructed||typeof t.constructed>"u"){if(x=!0,t.value&&a.util.isArray(t.value))for(var D=0,E=0;x&&E<t.value.length;++E)x=t.value[E].optional||!1,h.value[D]&&(x=e.validate(h.value[D],t.value[E],m,f),x?++D:t.value[E].optional&&(x=!0)),!x&&f&&f.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+h.value.length+'"');if(x&&m&&(t.capture&&(m[t.capture]=h.value),t.captureAsn1&&(m[t.captureAsn1]=h),t.captureBitStringContents&&"bitStringContents"in h&&(m[t.captureBitStringContents]=h.bitStringContents),t.captureBitStringValue&&"bitStringContents"in h))if(h.bitStringContents.length<2)m[t.captureBitStringValue]="";else{var u=h.bitStringContents.charCodeAt(0);if(u!==0)throw new Error("captureBitStringValue only supported for zero unused bits");m[t.captureBitStringValue]=h.bitStringContents.slice(1)}}else f&&f.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+h.constructed+'"');else f&&(h.tagClass!==t.tagClass&&f.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+h.tagClass+'"'),h.type!==t.type&&f.push("["+t.name+'] Expected type "'+t.type+'", got "'+h.type+'"'));return x};var S=/[^\\u0000-\\u00ff]/;return e.prettyPrint=function(h,t,m){var f="";t=t||0,m=m||2,t>0&&(f+=`
`);for(var x="",D=0;D<t*m;++D)x+=" ";switch(f+=x+"Tag: ",h.tagClass){case e.Class.UNIVERSAL:f+="Universal:";break;case e.Class.APPLICATION:f+="Application:";break;case e.Class.CONTEXT_SPECIFIC:f+="Context-Specific:";break;case e.Class.PRIVATE:f+="Private:";break}if(h.tagClass===e.Class.UNIVERSAL)switch(f+=h.type,h.type){case e.Type.NONE:f+=" (None)";break;case e.Type.BOOLEAN:f+=" (Boolean)";break;case e.Type.INTEGER:f+=" (Integer)";break;case e.Type.BITSTRING:f+=" (Bit string)";break;case e.Type.OCTETSTRING:f+=" (Octet string)";break;case e.Type.NULL:f+=" (Null)";break;case e.Type.OID:f+=" (Object Identifier)";break;case e.Type.ODESC:f+=" (Object Descriptor)";break;case e.Type.EXTERNAL:f+=" (External or Instance of)";break;case e.Type.REAL:f+=" (Real)";break;case e.Type.ENUMERATED:f+=" (Enumerated)";break;case e.Type.EMBEDDED:f+=" (Embedded PDV)";break;case e.Type.UTF8:f+=" (UTF8)";break;case e.Type.ROID:f+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:f+=" (Sequence)";break;case e.Type.SET:f+=" (Set)";break;case e.Type.PRINTABLESTRING:f+=" (Printable String)";break;case e.Type.IA5String:f+=" (IA5String (ASCII))";break;case e.Type.UTCTIME:f+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:f+=" (Generalized time)";break;case e.Type.BMPSTRING:f+=" (BMP String)";break}else f+=h.type;if(f+=`
`,f+=x+"Constructed: "+h.constructed+`
`,h.composed){for(var E=0,u="",D=0;D<h.value.length;++D)h.value[D]!==void 0&&(E+=1,u+=e.prettyPrint(h.value[D],t+1,m),D+1<h.value.length&&(u+=","));f+=x+"Sub values: "+E+u}else{if(f+=x+"Value: ",h.type===e.Type.OID){var y=e.derToOid(h.value);f+=y,a.pki&&a.pki.oids&&y in a.pki.oids&&(f+=" ("+a.pki.oids[y]+") ")}if(h.type===e.Type.INTEGER)try{f+=e.derToInteger(h.value)}catch{f+="0x"+a.util.bytesToHex(h.value)}else if(h.type===e.Type.BITSTRING){if(h.value.length>1?f+="0x"+a.util.bytesToHex(h.value.slice(1)):f+="(none)",h.value.length>0){var C=h.value.charCodeAt(0);C==1?f+=" (1 unused bit shown)":C>1&&(f+=" ("+C+" unused bits shown)")}}else if(h.type===e.Type.OCTETSTRING)S.test(h.value)||(f+="("+h.value+") "),f+="0x"+a.util.bytesToHex(h.value);else if(h.type===e.Type.UTF8)try{f+=a.util.decodeUtf8(h.value)}catch(g){if(g.message==="URI malformed")f+="0x"+a.util.bytesToHex(h.value)+" (malformed UTF8)";else throw g}else h.type===e.Type.PRINTABLESTRING||h.type===e.Type.IA5String?f+=h.value:S.test(h.value)?f+="0x"+a.util.bytesToHex(h.value):h.value.length===0?f+="[null]":f+=h.value}return f},Pt.exports}var Ot={exports:{}},Ft,Nr;function nt(){if(Nr)return Ft;Nr=1;var a=le();return Ft=a.md=a.md||{},a.md.algorithms=a.md.algorithms||{},Ft}var Rr;function vt(){if(Rr)return Ot.exports;Rr=1;var a=le();nt(),de();var e=Ot.exports=a.hmac=a.hmac||{};return e.create=function(){var n=null,v=null,N=null,S=null,h={};return h.start=function(t,m){if(t!==null)if(typeof t=="string")if(t=t.toLowerCase(),t in a.md.algorithms)v=a.md.algorithms[t].create();else throw new Error('Unknown hash algorithm "'+t+'"');else v=t;if(m===null)m=n;else{if(typeof m=="string")m=a.util.createBuffer(m);else if(a.util.isArray(m)){var f=m;m=a.util.createBuffer();for(var x=0;x<f.length;++x)m.putByte(f[x])}var D=m.length();D>v.blockLength&&(v.start(),v.update(m.bytes()),m=v.digest()),N=a.util.createBuffer(),S=a.util.createBuffer(),D=m.length();for(var x=0;x<D;++x){var f=m.at(x);N.putByte(54^f),S.putByte(92^f)}if(D<v.blockLength)for(var f=v.blockLength-D,x=0;x<f;++x)N.putByte(54),S.putByte(92);n=m,N=N.bytes(),S=S.bytes()}v.start(),v.update(N)},h.update=function(t){v.update(t)},h.getMac=function(){var t=v.digest().bytes();return v.start(),v.update(S),v.update(t),v.digest()},h.digest=h.getMac,h},Ot.exports}var Kt={exports:{}},wr;function vr(){if(wr)return Kt.exports;wr=1;var a=le();nt(),de();var e=Kt.exports=a.md5=a.md5||{};a.md.md5=a.md.algorithms.md5=e,e.create=function(){h||t();var f=null,x=a.util.createBuffer(),D=new Array(16),E={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return E.start=function(){E.messageLength=0,E.fullMessageLength=E.messageLength64=[];for(var u=E.messageLengthSize/4,y=0;y<u;++y)E.fullMessageLength.push(0);return x=a.util.createBuffer(),f={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},E},E.start(),E.update=function(u,y){y==="utf8"&&(u=a.util.encodeUtf8(u));var C=u.length;E.messageLength+=C,C=[C/4294967296>>>0,C>>>0];for(var g=E.fullMessageLength.length-1;g>=0;--g)E.fullMessageLength[g]+=C[1],C[1]=C[0]+(E.fullMessageLength[g]/4294967296>>>0),E.fullMessageLength[g]=E.fullMessageLength[g]>>>0,C[0]=C[1]/4294967296>>>0;return x.putBytes(u),m(f,D,x),(x.read>2048||x.length()===0)&&x.compact(),E},E.digest=function(){var u=a.util.createBuffer();u.putBytes(x.bytes());var y=E.fullMessageLength[E.fullMessageLength.length-1]+E.messageLengthSize,C=y&E.blockLength-1;u.putBytes(n.substr(0,E.blockLength-C));for(var g,s=0,d=E.fullMessageLength.length-1;d>=0;--d)g=E.fullMessageLength[d]*8+s,s=g/4294967296>>>0,u.putInt32Le(g>>>0);var p={h0:f.h0,h1:f.h1,h2:f.h2,h3:f.h3};m(p,D,u);var I=a.util.createBuffer();return I.putInt32Le(p.h0),I.putInt32Le(p.h1),I.putInt32Le(p.h2),I.putInt32Le(p.h3),I},E};var n=null,v=null,N=null,S=null,h=!1;function t(){n="",n+=a.util.fillString("\0",64),v=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],N=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],S=new Array(64);for(var f=0;f<64;++f)S[f]=Math.floor(Math.abs(Math.sin(f+1))*4294967296);h=!0}function m(f,x,D){for(var E,u,y,C,g,s,d,p,I=D.length();I>=64;){for(u=f.h0,y=f.h1,C=f.h2,g=f.h3,p=0;p<16;++p)x[p]=D.getInt32Le(),s=g^y&(C^g),E=u+s+S[p]+x[p],d=N[p],u=g,g=C,C=y,y+=E<<d|E>>>32-d;for(;p<32;++p)s=C^g&(y^C),E=u+s+S[p]+x[v[p]],d=N[p],u=g,g=C,C=y,y+=E<<d|E>>>32-d;for(;p<48;++p)s=y^C^g,E=u+s+S[p]+x[v[p]],d=N[p],u=g,g=C,C=y,y+=E<<d|E>>>32-d;for(;p<64;++p)s=C^(y|~g),E=u+s+S[p]+x[v[p]],d=N[p],u=g,g=C,C=y,y+=E<<d|E>>>32-d;f.h0=f.h0+u|0,f.h1=f.h1+y|0,f.h2=f.h2+C|0,f.h3=f.h3+g|0,I-=64}}return Kt.exports}var Mt={exports:{}},Lr;function ht(){if(Lr)return Mt.exports;Lr=1;var a=le();de();var e=Mt.exports=a.pem=a.pem||{};e.encode=function(N,S){S=S||{};var h="-----BEGIN "+N.type+`-----\r
`,t;if(N.procType&&(t={name:"Proc-Type",values:[String(N.procType.version),N.procType.type]},h+=n(t)),N.contentDomain&&(t={name:"Content-Domain",values:[N.contentDomain]},h+=n(t)),N.dekInfo&&(t={name:"DEK-Info",values:[N.dekInfo.algorithm]},N.dekInfo.parameters&&t.values.push(N.dekInfo.parameters),h+=n(t)),N.headers)for(var m=0;m<N.headers.length;++m)h+=n(N.headers[m]);return N.procType&&(h+=`\r
`),h+=a.util.encode64(N.body,S.maxline||64)+`\r
`,h+="-----END "+N.type+`-----\r
`,h},e.decode=function(N){for(var S=[],h=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,t=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,m=/\r?\n/,f;f=h.exec(N),!!f;){var x=f[1];x==="NEW CERTIFICATE REQUEST"&&(x="CERTIFICATE REQUEST");var D={type:x,procType:null,contentDomain:null,dekInfo:null,headers:[],body:a.util.decode64(f[3])};if(S.push(D),!!f[2]){for(var E=f[2].split(m),u=0;f&&u<E.length;){for(var y=E[u].replace(/\s+$/,""),C=u+1;C<E.length;++C){var g=E[C];if(!/\s/.test(g[0]))break;y+=g,u=C}if(f=y.match(t),f){for(var s={name:f[1],values:[]},d=f[2].split(","),p=0;p<d.length;++p)s.values.push(v(d[p]));if(D.procType)if(!D.contentDomain&&s.name==="Content-Domain")D.contentDomain=d[0]||"";else if(!D.dekInfo&&s.name==="DEK-Info"){if(s.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');D.dekInfo={algorithm:d[0],parameters:d[1]||null}}else D.headers.push(s);else{if(s.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(s.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');D.procType={version:d[0],type:d[1]}}}++u}if(D.procType==="ENCRYPTED"&&!D.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(S.length===0)throw new Error("Invalid PEM formatted message.");return S};function n(N){for(var S=N.name+": ",h=[],t=function(E,u){return" "+u},m=0;m<N.values.length;++m)h.push(N.values[m].replace(/^(\S+\r\n)/,t));S+=h.join(",")+`\r
`;for(var f=0,x=-1,m=0;m<S.length;++m,++f)if(f>65&&x!==-1){var D=S[x];D===","?(++x,S=S.substr(0,x)+`\r
 `+S.substr(x)):S=S.substr(0,x)+`\r
`+D+S.substr(x+1),f=m-x-1,x=-1,++m}else(S[m]===" "||S[m]==="	"||S[m]===",")&&(x=m);return S}function v(N){return N.replace(/^\s+/,"")}return Mt.exports}var qt={exports:{}},Ht,kr;function It(){if(kr)return Ht;kr=1;var a=le();pr(),ca(),de(),Ht=a.des=a.des||{},a.des.startEncrypting=function(u,y,C,g){var s=E({key:u,output:C,decrypt:!1,mode:g||(y===null?"ECB":"CBC")});return s.start(y),s},a.des.createEncryptionCipher=function(u,y){return E({key:u,output:null,decrypt:!1,mode:y})},a.des.startDecrypting=function(u,y,C,g){var s=E({key:u,output:C,decrypt:!0,mode:g||(y===null?"ECB":"CBC")});return s.start(y),s},a.des.createDecryptionCipher=function(u,y){return E({key:u,output:null,decrypt:!0,mode:y})},a.des.Algorithm=function(u,y){var C=this;C.name=u,C.mode=new y({blockSize:8,cipher:{encrypt:function(g,s){return D(C._keys,g,s,!1)},decrypt:function(g,s){return D(C._keys,g,s,!0)}}}),C._init=!1},a.des.Algorithm.prototype.initialize=function(u){if(!this._init){var y=a.util.createBuffer(u.key);if(this.name.indexOf("3DES")===0&&y.length()!==24)throw new Error("Invalid Triple-DES key size: "+y.length()*8);this._keys=x(y),this._init=!0}},e("DES-ECB",a.cipher.modes.ecb),e("DES-CBC",a.cipher.modes.cbc),e("DES-CFB",a.cipher.modes.cfb),e("DES-OFB",a.cipher.modes.ofb),e("DES-CTR",a.cipher.modes.ctr),e("3DES-ECB",a.cipher.modes.ecb),e("3DES-CBC",a.cipher.modes.cbc),e("3DES-CFB",a.cipher.modes.cfb),e("3DES-OFB",a.cipher.modes.ofb),e("3DES-CTR",a.cipher.modes.ctr);function e(u,y){var C=function(){return new a.des.Algorithm(u,y)};a.cipher.registerAlgorithm(u,C)}var n=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],v=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],N=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],S=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],h=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],t=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],m=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],f=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function x(u){for(var y=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],C=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],g=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],s=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],d=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],p=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],I=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],R=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],i=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],r=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],B=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],k=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],V=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],L=u.length()>8?3:1,O=[],q=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],M=0,H,Y=0;Y<L;Y++){var j=u.getInt32(),$=u.getInt32();H=(j>>>4^$)&252645135,$^=H,j^=H<<4,H=($>>>-16^j)&65535,j^=H,$^=H<<-16,H=(j>>>2^$)&858993459,$^=H,j^=H<<2,H=($>>>-16^j)&65535,j^=H,$^=H<<-16,H=(j>>>1^$)&1431655765,$^=H,j^=H<<1,H=($>>>8^j)&16711935,j^=H,$^=H<<8,H=(j>>>1^$)&1431655765,$^=H,j^=H<<1,H=j<<8|$>>>20&240,j=$<<24|$<<8&16711680|$>>>8&65280|$>>>24&240,$=H;for(var ne=0;ne<q.length;++ne){q[ne]?(j=j<<2|j>>>26,$=$<<2|$>>>26):(j=j<<1|j>>>27,$=$<<1|$>>>27),j&=-15,$&=-15;var se=y[j>>>28]|C[j>>>24&15]|g[j>>>20&15]|s[j>>>16&15]|d[j>>>12&15]|p[j>>>8&15]|I[j>>>4&15],he=R[$>>>28]|c[$>>>24&15]|i[$>>>20&15]|r[$>>>16&15]|B[$>>>12&15]|k[$>>>8&15]|V[$>>>4&15];H=(he>>>16^se)&65535,O[M++]=se^H,O[M++]=he^H<<16}}return O}function D(u,y,C,g){var s=u.length===32?3:9,d;s===3?d=g?[30,-2,-2]:[0,32,2]:d=g?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var p,I=y[0],R=y[1];p=(I>>>4^R)&252645135,R^=p,I^=p<<4,p=(I>>>16^R)&65535,R^=p,I^=p<<16,p=(R>>>2^I)&858993459,I^=p,R^=p<<2,p=(R>>>8^I)&16711935,I^=p,R^=p<<8,p=(I>>>1^R)&1431655765,R^=p,I^=p<<1,I=I<<1|I>>>31,R=R<<1|R>>>31;for(var c=0;c<s;c+=3){for(var i=d[c+1],r=d[c+2],B=d[c];B!=i;B+=r){var k=R^u[B],V=(R>>>4|R<<28)^u[B+1];p=I,I=R,R=p^(v[k>>>24&63]|S[k>>>16&63]|t[k>>>8&63]|f[k&63]|n[V>>>24&63]|N[V>>>16&63]|h[V>>>8&63]|m[V&63])}p=I,I=R,R=p}I=I>>>1|I<<31,R=R>>>1|R<<31,p=(I>>>1^R)&1431655765,R^=p,I^=p<<1,p=(R>>>8^I)&16711935,I^=p,R^=p<<8,p=(R>>>2^I)&858993459,I^=p,R^=p<<2,p=(I>>>16^R)&65535,R^=p,I^=p<<16,p=(I>>>4^R)&252645135,R^=p,I^=p<<4,C[0]=I,C[1]=R}function E(u){u=u||{};var y=(u.mode||"CBC").toUpperCase(),C="DES-"+y,g;u.decrypt?g=a.cipher.createDecipher(C,u.key):g=a.cipher.createCipher(C,u.key);var s=g.start;return g.start=function(d,p){var I=null;p instanceof a.util.ByteBuffer&&(I=p,p={}),p=p||{},p.output=I,p.iv=d,s.call(g,p)},g}return Ht}const Za={},$a=Object.freeze(Object.defineProperty({__proto__:null,default:Za},Symbol.toStringTag,{value:"Module"})),yr=Ga($a);var Gt,Dr;function gr(){if(Dr)return Gt;Dr=1;var a=le();vt(),nt(),de();var e=a.pkcs5=a.pkcs5||{},n;return a.util.isNodejs&&!a.options.usePureJavaScript&&(n=yr),Gt=a.pbkdf2=e.pbkdf2=function(v,N,S,h,t,m){if(typeof t=="function"&&(m=t,t=null),a.util.isNodejs&&!a.options.usePureJavaScript&&n.pbkdf2&&(t===null||typeof t!="object")&&(n.pbkdf2Sync.length>4||!t||t==="sha1"))return typeof t!="string"&&(t="sha1"),v=Buffer.from(v,"binary"),N=Buffer.from(N,"binary"),m?n.pbkdf2Sync.length===4?n.pbkdf2(v,N,S,h,function(c,i){if(c)return m(c);m(null,i.toString("binary"))}):n.pbkdf2(v,N,S,h,t,function(c,i){if(c)return m(c);m(null,i.toString("binary"))}):n.pbkdf2Sync.length===4?n.pbkdf2Sync(v,N,S,h).toString("binary"):n.pbkdf2Sync(v,N,S,h,t).toString("binary");if((typeof t>"u"||t===null)&&(t="sha1"),typeof t=="string"){if(!(t in a.md.algorithms))throw new Error("Unknown hash algorithm: "+t);t=a.md[t].create()}var f=t.digestLength;if(h>4294967295*f){var x=new Error("Derived key is too long.");if(m)return m(x);throw x}var D=Math.ceil(h/f),E=h-(D-1)*f,u=a.hmac.create();u.start(t,v);var y="",C,g,s;if(!m){for(var d=1;d<=D;++d){u.start(null,null),u.update(N),u.update(a.util.int32ToBytes(d)),C=s=u.digest().getBytes();for(var p=2;p<=S;++p)u.start(null,null),u.update(s),g=u.digest().getBytes(),C=a.util.xorBytes(C,g,f),s=g;y+=d<D?C:C.substr(0,E)}return y}var d=1,p;function I(){if(d>D)return m(null,y);u.start(null,null),u.update(N),u.update(a.util.int32ToBytes(d)),C=s=u.digest().getBytes(),p=2,R()}function R(){if(p<=S)return u.start(null,null),u.update(s),g=u.digest().getBytes(),C=a.util.xorBytes(C,g,f),s=g,++p,a.util.setImmediate(R);y+=d<D?C:C.substr(0,E),++d,I()}I()},Gt}var Et={exports:{}},Qt={exports:{}},Ur;function ha(){if(Ur)return Qt.exports;Ur=1;var a=le();nt(),de();var e=Qt.exports=a.sha256=a.sha256||{};a.md.sha256=a.md.algorithms.sha256=e,e.create=function(){v||S();var t=null,m=a.util.createBuffer(),f=new Array(64),x={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return x.start=function(){x.messageLength=0,x.fullMessageLength=x.messageLength64=[];for(var D=x.messageLengthSize/4,E=0;E<D;++E)x.fullMessageLength.push(0);return m=a.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},x},x.start(),x.update=function(D,E){E==="utf8"&&(D=a.util.encodeUtf8(D));var u=D.length;x.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var y=x.fullMessageLength.length-1;y>=0;--y)x.fullMessageLength[y]+=u[1],u[1]=u[0]+(x.fullMessageLength[y]/4294967296>>>0),x.fullMessageLength[y]=x.fullMessageLength[y]>>>0,u[0]=u[1]/4294967296>>>0;return m.putBytes(D),h(t,f,m),(m.read>2048||m.length()===0)&&m.compact(),x},x.digest=function(){var D=a.util.createBuffer();D.putBytes(m.bytes());var E=x.fullMessageLength[x.fullMessageLength.length-1]+x.messageLengthSize,u=E&x.blockLength-1;D.putBytes(n.substr(0,x.blockLength-u));for(var y,C,g=x.fullMessageLength[0]*8,s=0;s<x.fullMessageLength.length-1;++s)y=x.fullMessageLength[s+1]*8,C=y/4294967296>>>0,g+=C,D.putInt32(g>>>0),g=y>>>0;D.putInt32(g);var d={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};h(d,f,D);var p=a.util.createBuffer();return p.putInt32(d.h0),p.putInt32(d.h1),p.putInt32(d.h2),p.putInt32(d.h3),p.putInt32(d.h4),p.putInt32(d.h5),p.putInt32(d.h6),p.putInt32(d.h7),p},x};var n=null,v=!1,N=null;function S(){n="",n+=a.util.fillString("\0",64),N=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],v=!0}function h(t,m,f){for(var x,D,E,u,y,C,g,s,d,p,I,R,c,i,r,B=f.length();B>=64;){for(g=0;g<16;++g)m[g]=f.getInt32();for(;g<64;++g)x=m[g-2],x=(x>>>17|x<<15)^(x>>>19|x<<13)^x>>>10,D=m[g-15],D=(D>>>7|D<<25)^(D>>>18|D<<14)^D>>>3,m[g]=x+m[g-7]+D+m[g-16]|0;for(s=t.h0,d=t.h1,p=t.h2,I=t.h3,R=t.h4,c=t.h5,i=t.h6,r=t.h7,g=0;g<64;++g)u=(R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7),y=i^R&(c^i),E=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),C=s&d|p&(s^d),x=r+u+y+N[g]+m[g],D=E+C,r=i,i=c,c=R,R=I+x>>>0,I=p,p=d,d=s,s=x+D>>>0;t.h0=t.h0+s|0,t.h1=t.h1+d|0,t.h2=t.h2+p|0,t.h3=t.h3+I|0,t.h4=t.h4+R|0,t.h5=t.h5+c|0,t.h6=t.h6+i|0,t.h7=t.h7+r|0,B-=64}}return Qt.exports}var zt={exports:{}},Pr;function da(){if(Pr)return zt.exports;Pr=1;var a=le();de();var e=null;a.util.isNodejs&&!a.options.usePureJavaScript&&!process.versions["node-webkit"]&&(e=yr);var n=zt.exports=a.prng=a.prng||{};return n.create=function(v){for(var N={plugin:v,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},S=v.md,h=new Array(32),t=0;t<32;++t)h[t]=S.create();N.pools=h,N.pool=0,N.generate=function(E,u){if(!u)return N.generateSync(E);var y=N.plugin.cipher,C=N.plugin.increment,g=N.plugin.formatKey,s=N.plugin.formatSeed,d=a.util.createBuffer();N.key=null,p();function p(I){if(I)return u(I);if(d.length()>=E)return u(null,d.getBytes(E));if(N.generated>1048575&&(N.key=null),N.key===null)return a.util.nextTick(function(){m(p)});var R=y(N.key,N.seed);N.generated+=R.length,d.putBytes(R),N.key=g(y(N.key,C(N.seed))),N.seed=s(y(N.key,N.seed)),a.util.setImmediate(p)}},N.generateSync=function(E){var u=N.plugin.cipher,y=N.plugin.increment,C=N.plugin.formatKey,g=N.plugin.formatSeed;N.key=null;for(var s=a.util.createBuffer();s.length()<E;){N.generated>1048575&&(N.key=null),N.key===null&&f();var d=u(N.key,N.seed);N.generated+=d.length,s.putBytes(d),N.key=C(u(N.key,y(N.seed))),N.seed=g(u(N.key,N.seed))}return s.getBytes(E)};function m(E){if(N.pools[0].messageLength>=32)return x(),E();var u=32-N.pools[0].messageLength<<5;N.seedFile(u,function(y,C){if(y)return E(y);N.collect(C),x(),E()})}function f(){if(N.pools[0].messageLength>=32)return x();var E=32-N.pools[0].messageLength<<5;N.collect(N.seedFileSync(E)),x()}function x(){N.reseeds=N.reseeds===4294967295?0:N.reseeds+1;var E=N.plugin.md.create();E.update(N.keyBytes);for(var u=1,y=0;y<32;++y)N.reseeds%u===0&&(E.update(N.pools[y].digest().getBytes()),N.pools[y].start()),u=u<<1;N.keyBytes=E.digest().getBytes(),E.start(),E.update(N.keyBytes);var C=E.digest().getBytes();N.key=N.plugin.formatKey(N.keyBytes),N.seed=N.plugin.formatSeed(C),N.generated=0}function D(E){var u=null,y=a.util.globalScope,C=y.crypto||y.msCrypto;C&&C.getRandomValues&&(u=function(r){return C.getRandomValues(r)});var g=a.util.createBuffer();if(u)for(;g.length()<E;){var s=Math.max(1,Math.min(E-g.length(),65536)/4),d=new Uint32Array(Math.floor(s));try{u(d);for(var p=0;p<d.length;++p)g.putInt32(d[p])}catch(r){if(!(typeof QuotaExceededError<"u"&&r instanceof QuotaExceededError))throw r}}if(g.length()<E)for(var I,R,c,i=Math.floor(Math.random()*65536);g.length()<E;){R=16807*(i&65535),I=16807*(i>>16),R+=(I&32767)<<16,R+=I>>15,R=(R&2147483647)+(R>>31),i=R&4294967295;for(var p=0;p<3;++p)c=i>>>(p<<3),c^=Math.floor(Math.random()*256),g.putByte(c&255)}return g.getBytes(E)}return e?(N.seedFile=function(E,u){e.randomBytes(E,function(y,C){if(y)return u(y);u(null,C.toString())})},N.seedFileSync=function(E){return e.randomBytes(E).toString()}):(N.seedFile=function(E,u){try{u(null,D(E))}catch(y){u(y)}},N.seedFileSync=D),N.collect=function(E){for(var u=E.length,y=0;y<u;++y)N.pools[N.pool].update(E.substr(y,1)),N.pool=N.pool===31?0:N.pool+1},N.collectInt=function(E,u){for(var y="",C=0;C<u;C+=8)y+=String.fromCharCode(E>>C&255);N.collect(y)},N.registerWorker=function(E){if(E===self)N.seedFile=function(y,C){function g(s){var d=s.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",g),C(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",g),self.postMessage({forge:{prng:{needed:y}}})};else{var u=function(y){var C=y.data;C.forge&&C.forge.prng&&N.seedFile(C.forge.prng.needed,function(g,s){E.postMessage({forge:{prng:{err:g,bytes:s}}})})};E.addEventListener("message",u)}},N},zt.exports}var Vr;function Je(){if(Vr)return Et.exports;Vr=1;var a=le();return ut(),ha(),da(),de(),function(){if(a.random&&a.random.getBytes){Et.exports=a.random;return}(function(e){var n={},v=new Array(4),N=a.util.createBuffer();n.formatKey=function(E){var u=a.util.createBuffer(E);return E=new Array(4),E[0]=u.getInt32(),E[1]=u.getInt32(),E[2]=u.getInt32(),E[3]=u.getInt32(),a.aes._expandKey(E,!1)},n.formatSeed=function(E){var u=a.util.createBuffer(E);return E=new Array(4),E[0]=u.getInt32(),E[1]=u.getInt32(),E[2]=u.getInt32(),E[3]=u.getInt32(),E},n.cipher=function(E,u){return a.aes._updateBlock(E,u,v,!1),N.putInt32(v[0]),N.putInt32(v[1]),N.putInt32(v[2]),N.putInt32(v[3]),N.getBytes()},n.increment=function(E){return++E[3],E},n.md=a.md.sha256;function S(){var E=a.prng.create(n);return E.getBytes=function(u,y){return E.generate(u,y)},E.getBytesSync=function(u){return E.generate(u)},E}var h=S(),t=null,m=a.util.globalScope,f=m.crypto||m.msCrypto;if(f&&f.getRandomValues&&(t=function(E){return f.getRandomValues(E)}),a.options.usePureJavaScript||!a.util.isNodejs&&!t){if(h.collectInt(+new Date,32),typeof navigator<"u"){var x="";for(var D in navigator)try{typeof navigator[D]=="string"&&(x+=navigator[D])}catch{}h.collect(x),x=null}e&&(e().mousemove(function(E){h.collectInt(E.clientX,16),h.collectInt(E.clientY,16)}),e().keypress(function(E){h.collectInt(E.charCode,8)}))}if(!a.random)a.random=h;else for(var D in h)a.random[D]=h[D];a.random.createInstance=S,Et.exports=a.random})(typeof jQuery<"u"?jQuery:null)}(),Et.exports}var Yt,Or;function pa(){if(Or)return Yt;Or=1;var a=le();de();var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],n=[1,2,3,5],v=function(h,t){return h<<t&65535|(h&65535)>>16-t},N=function(h,t){return(h&65535)>>t|h<<16-t&65535};Yt=a.rc2=a.rc2||{},a.rc2.expandKey=function(h,t){typeof h=="string"&&(h=a.util.createBuffer(h)),t=t||128;var m=h,f=h.length(),x=t,D=Math.ceil(x/8),E=255>>(x&7),u;for(u=f;u<128;u++)m.putByte(e[m.at(u-1)+m.at(u-f)&255]);for(m.setAt(128-D,e[m.at(128-D)&E]),u=127-D;u>=0;u--)m.setAt(u,e[m.at(u+1)^m.at(u+D)]);return m};var S=function(h,t,m){var f=!1,x=null,D=null,E=null,u,y,C,g,s=[];for(h=a.rc2.expandKey(h,t),C=0;C<64;C++)s.push(h.getInt16Le());m?(u=function(I){for(C=0;C<4;C++)I[C]+=s[g]+(I[(C+3)%4]&I[(C+2)%4])+(~I[(C+3)%4]&I[(C+1)%4]),I[C]=v(I[C],n[C]),g++},y=function(I){for(C=0;C<4;C++)I[C]+=s[I[(C+3)%4]&63]}):(u=function(I){for(C=3;C>=0;C--)I[C]=N(I[C],n[C]),I[C]-=s[g]+(I[(C+3)%4]&I[(C+2)%4])+(~I[(C+3)%4]&I[(C+1)%4]),g--},y=function(I){for(C=3;C>=0;C--)I[C]-=s[I[(C+3)%4]&63]});var d=function(I){var R=[];for(C=0;C<4;C++){var c=x.getInt16Le();E!==null&&(m?c^=E.getInt16Le():E.putInt16Le(c)),R.push(c&65535)}g=m?0:63;for(var i=0;i<I.length;i++)for(var r=0;r<I[i][0];r++)I[i][1](R);for(C=0;C<4;C++)E!==null&&(m?E.putInt16Le(R[C]):R[C]^=E.getInt16Le()),D.putInt16Le(R[C])},p=null;return p={start:function(I,R){I&&typeof I=="string"&&(I=a.util.createBuffer(I)),f=!1,x=a.util.createBuffer(),D=R||new a.util.createBuffer,E=I,p.output=D},update:function(I){for(f||x.putBuffer(I);x.length()>=8;)d([[5,u],[1,y],[6,u],[1,y],[5,u]])},finish:function(I){var R=!0;if(m)if(I)R=I(8,x,!m);else{var c=x.length()===8?8:8-x.length();x.fillWithByte(c,c)}if(R&&(f=!0,p.update()),!m&&(R=x.length()===0,R))if(I)R=I(8,D,!m);else{var i=D.length(),r=D.at(i-1);r>i?R=!1:D.truncate(r)}return R}},p};return a.rc2.startEncrypting=function(h,t,m){var f=a.rc2.createEncryptionCipher(h,128);return f.start(t,m),f},a.rc2.createEncryptionCipher=function(h,t){return S(h,t,!0)},a.rc2.startDecrypting=function(h,t,m){var f=a.rc2.createDecryptionCipher(h,128);return f.start(t,m),f},a.rc2.createDecryptionCipher=function(h,t){return S(h,t,!1)},Yt}var Xt,Fr;function At(){if(Fr)return Xt;Fr=1;var a=le();Xt=a.jsbn=a.jsbn||{};var e;function n(T,b,U){this.data=[],T!=null&&(typeof T=="number"?this.fromNumber(T,b,U):b==null&&typeof T!="string"?this.fromString(T,256):this.fromString(T,b))}a.jsbn.BigInteger=n;function v(){return new n(null)}function N(T,b,U,K,Q,X){for(;--X>=0;){var re=b*this.data[T++]+U.data[K]+Q;Q=Math.floor(re/67108864),U.data[K++]=re&67108863}return Q}function S(T,b,U,K,Q,X){for(var re=b&32767,J=b>>15;--X>=0;){var pe=this.data[T]&32767,Fe=this.data[T++]>>15,Xe=J*pe+Fe*re;pe=re*pe+((Xe&32767)<<15)+U.data[K]+(Q&1073741823),Q=(pe>>>30)+(Xe>>>15)+J*Fe+(Q>>>30),U.data[K++]=pe&1073741823}return Q}function h(T,b,U,K,Q,X){for(var re=b&16383,J=b>>14;--X>=0;){var pe=this.data[T]&16383,Fe=this.data[T++]>>14,Xe=J*pe+Fe*re;pe=re*pe+((Xe&16383)<<14)+U.data[K]+Q,Q=(pe>>28)+(Xe>>14)+J*Fe,U.data[K++]=pe&268435455}return Q}typeof navigator>"u"?(n.prototype.am=h,e=28):navigator.appName=="Microsoft Internet Explorer"?(n.prototype.am=S,e=30):navigator.appName!="Netscape"?(n.prototype.am=N,e=26):(n.prototype.am=h,e=28),n.prototype.DB=e,n.prototype.DM=(1<<e)-1,n.prototype.DV=1<<e;var t=52;n.prototype.FV=Math.pow(2,t),n.prototype.F1=t-e,n.prototype.F2=2*e-t;var m="0123456789abcdefghijklmnopqrstuvwxyz",f=new Array,x,D;for(x=48,D=0;D<=9;++D)f[x++]=D;for(x=97,D=10;D<36;++D)f[x++]=D;for(x=65,D=10;D<36;++D)f[x++]=D;function E(T){return m.charAt(T)}function u(T,b){var U=f[T.charCodeAt(b)];return U??-1}function y(T){for(var b=this.t-1;b>=0;--b)T.data[b]=this.data[b];T.t=this.t,T.s=this.s}function C(T){this.t=1,this.s=T<0?-1:0,T>0?this.data[0]=T:T<-1?this.data[0]=T+this.DV:this.t=0}function g(T){var b=v();return b.fromInt(T),b}function s(T,b){var U;if(b==16)U=4;else if(b==8)U=3;else if(b==256)U=8;else if(b==2)U=1;else if(b==32)U=5;else if(b==4)U=2;else{this.fromRadix(T,b);return}this.t=0,this.s=0;for(var K=T.length,Q=!1,X=0;--K>=0;){var re=U==8?T[K]&255:u(T,K);if(re<0){T.charAt(K)=="-"&&(Q=!0);continue}Q=!1,X==0?this.data[this.t++]=re:X+U>this.DB?(this.data[this.t-1]|=(re&(1<<this.DB-X)-1)<<X,this.data[this.t++]=re>>this.DB-X):this.data[this.t-1]|=re<<X,X+=U,X>=this.DB&&(X-=this.DB)}U==8&&(T[0]&128)!=0&&(this.s=-1,X>0&&(this.data[this.t-1]|=(1<<this.DB-X)-1<<X)),this.clamp(),Q&&n.ZERO.subTo(this,this)}function d(){for(var T=this.s&this.DM;this.t>0&&this.data[this.t-1]==T;)--this.t}function p(T){if(this.s<0)return"-"+this.negate().toString(T);var b;if(T==16)b=4;else if(T==8)b=3;else if(T==2)b=1;else if(T==32)b=5;else if(T==4)b=2;else return this.toRadix(T);var U=(1<<b)-1,K,Q=!1,X="",re=this.t,J=this.DB-re*this.DB%b;if(re-- >0)for(J<this.DB&&(K=this.data[re]>>J)>0&&(Q=!0,X=E(K));re>=0;)J<b?(K=(this.data[re]&(1<<J)-1)<<b-J,K|=this.data[--re]>>(J+=this.DB-b)):(K=this.data[re]>>(J-=b)&U,J<=0&&(J+=this.DB,--re)),K>0&&(Q=!0),Q&&(X+=E(K));return Q?X:"0"}function I(){var T=v();return n.ZERO.subTo(this,T),T}function R(){return this.s<0?this.negate():this}function c(T){var b=this.s-T.s;if(b!=0)return b;var U=this.t;if(b=U-T.t,b!=0)return this.s<0?-b:b;for(;--U>=0;)if((b=this.data[U]-T.data[U])!=0)return b;return 0}function i(T){var b=1,U;return(U=T>>>16)!=0&&(T=U,b+=16),(U=T>>8)!=0&&(T=U,b+=8),(U=T>>4)!=0&&(T=U,b+=4),(U=T>>2)!=0&&(T=U,b+=2),(U=T>>1)!=0&&(T=U,b+=1),b}function r(){return this.t<=0?0:this.DB*(this.t-1)+i(this.data[this.t-1]^this.s&this.DM)}function B(T,b){var U;for(U=this.t-1;U>=0;--U)b.data[U+T]=this.data[U];for(U=T-1;U>=0;--U)b.data[U]=0;b.t=this.t+T,b.s=this.s}function k(T,b){for(var U=T;U<this.t;++U)b.data[U-T]=this.data[U];b.t=Math.max(this.t-T,0),b.s=this.s}function V(T,b){var U=T%this.DB,K=this.DB-U,Q=(1<<K)-1,X=Math.floor(T/this.DB),re=this.s<<U&this.DM,J;for(J=this.t-1;J>=0;--J)b.data[J+X+1]=this.data[J]>>K|re,re=(this.data[J]&Q)<<U;for(J=X-1;J>=0;--J)b.data[J]=0;b.data[X]=re,b.t=this.t+X+1,b.s=this.s,b.clamp()}function L(T,b){b.s=this.s;var U=Math.floor(T/this.DB);if(U>=this.t){b.t=0;return}var K=T%this.DB,Q=this.DB-K,X=(1<<K)-1;b.data[0]=this.data[U]>>K;for(var re=U+1;re<this.t;++re)b.data[re-U-1]|=(this.data[re]&X)<<Q,b.data[re-U]=this.data[re]>>K;K>0&&(b.data[this.t-U-1]|=(this.s&X)<<Q),b.t=this.t-U,b.clamp()}function O(T,b){for(var U=0,K=0,Q=Math.min(T.t,this.t);U<Q;)K+=this.data[U]-T.data[U],b.data[U++]=K&this.DM,K>>=this.DB;if(T.t<this.t){for(K-=T.s;U<this.t;)K+=this.data[U],b.data[U++]=K&this.DM,K>>=this.DB;K+=this.s}else{for(K+=this.s;U<T.t;)K-=T.data[U],b.data[U++]=K&this.DM,K>>=this.DB;K-=T.s}b.s=K<0?-1:0,K<-1?b.data[U++]=this.DV+K:K>0&&(b.data[U++]=K),b.t=U,b.clamp()}function q(T,b){var U=this.abs(),K=T.abs(),Q=U.t;for(b.t=Q+K.t;--Q>=0;)b.data[Q]=0;for(Q=0;Q<K.t;++Q)b.data[Q+U.t]=U.am(0,K.data[Q],b,Q,0,U.t);b.s=0,b.clamp(),this.s!=T.s&&n.ZERO.subTo(b,b)}function M(T){for(var b=this.abs(),U=T.t=2*b.t;--U>=0;)T.data[U]=0;for(U=0;U<b.t-1;++U){var K=b.am(U,b.data[U],T,2*U,0,1);(T.data[U+b.t]+=b.am(U+1,2*b.data[U],T,2*U+1,K,b.t-U-1))>=b.DV&&(T.data[U+b.t]-=b.DV,T.data[U+b.t+1]=1)}T.t>0&&(T.data[T.t-1]+=b.am(U,b.data[U],T,2*U,0,1)),T.s=0,T.clamp()}function H(T,b,U){var K=T.abs();if(!(K.t<=0)){var Q=this.abs();if(Q.t<K.t){b!=null&&b.fromInt(0),U!=null&&this.copyTo(U);return}U==null&&(U=v());var X=v(),re=this.s,J=T.s,pe=this.DB-i(K.data[K.t-1]);pe>0?(K.lShiftTo(pe,X),Q.lShiftTo(pe,U)):(K.copyTo(X),Q.copyTo(U));var Fe=X.t,Xe=X.data[Fe-1];if(Xe!=0){var ze=Xe*(1<<this.F1)+(Fe>1?X.data[Fe-2]>>this.F2:0),at=this.FV/ze,mt=(1<<this.F1)/ze,Ze=1<<this.F2,$e=U.t,Ct=$e-Fe,st=b??v();for(X.dlShiftTo(Ct,st),U.compareTo(st)>=0&&(U.data[U.t++]=1,U.subTo(st,U)),n.ONE.dlShiftTo(Fe,st),st.subTo(X,X);X.t<Fe;)X.data[X.t++]=0;for(;--Ct>=0;){var bt=U.data[--$e]==Xe?this.DM:Math.floor(U.data[$e]*at+(U.data[$e-1]+Ze)*mt);if((U.data[$e]+=X.am(0,bt,U,Ct,0,Fe))<bt)for(X.dlShiftTo(Ct,st),U.subTo(st,U);U.data[$e]<--bt;)U.subTo(st,U)}b!=null&&(U.drShiftTo(Fe,b),re!=J&&n.ZERO.subTo(b,b)),U.t=Fe,U.clamp(),pe>0&&U.rShiftTo(pe,U),re<0&&n.ZERO.subTo(U,U)}}}function Y(T){var b=v();return this.abs().divRemTo(T,null,b),this.s<0&&b.compareTo(n.ZERO)>0&&T.subTo(b,b),b}function j(T){this.m=T}function $(T){return T.s<0||T.compareTo(this.m)>=0?T.mod(this.m):T}function ne(T){return T}function se(T){T.divRemTo(this.m,null,T)}function he(T,b,U){T.multiplyTo(b,U),this.reduce(U)}function ge(T,b){T.squareTo(b),this.reduce(b)}j.prototype.convert=$,j.prototype.revert=ne,j.prototype.reduce=se,j.prototype.mulTo=he,j.prototype.sqrTo=ge;function W(){if(this.t<1)return 0;var T=this.data[0];if((T&1)==0)return 0;var b=T&3;return b=b*(2-(T&15)*b)&15,b=b*(2-(T&255)*b)&255,b=b*(2-((T&65535)*b&65535))&65535,b=b*(2-T*b%this.DV)%this.DV,b>0?this.DV-b:-b}function ue(T){this.m=T,this.mp=T.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<T.DB-15)-1,this.mt2=2*T.t}function Z(T){var b=v();return T.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),T.s<0&&b.compareTo(n.ZERO)>0&&this.m.subTo(b,b),b}function qe(T){var b=v();return T.copyTo(b),this.reduce(b),b}function fe(T){for(;T.t<=this.mt2;)T.data[T.t++]=0;for(var b=0;b<this.m.t;++b){var U=T.data[b]&32767,K=U*this.mpl+((U*this.mph+(T.data[b]>>15)*this.mpl&this.um)<<15)&T.DM;for(U=b+this.m.t,T.data[U]+=this.m.am(0,K,T,b,0,this.m.t);T.data[U]>=T.DV;)T.data[U]-=T.DV,T.data[++U]++}T.clamp(),T.drShiftTo(this.m.t,T),T.compareTo(this.m)>=0&&T.subTo(this.m,T)}function l(T,b){T.squareTo(b),this.reduce(b)}function w(T,b,U){T.multiplyTo(b,U),this.reduce(U)}ue.prototype.convert=Z,ue.prototype.revert=qe,ue.prototype.reduce=fe,ue.prototype.mulTo=w,ue.prototype.sqrTo=l;function _(){return(this.t>0?this.data[0]&1:this.s)==0}function o(T,b){if(T>4294967295||T<1)return n.ONE;var U=v(),K=v(),Q=b.convert(this),X=i(T)-1;for(Q.copyTo(U);--X>=0;)if(b.sqrTo(U,K),(T&1<<X)>0)b.mulTo(K,Q,U);else{var re=U;U=K,K=re}return b.revert(U)}function A(T,b){var U;return T<256||b.isEven()?U=new j(b):U=new ue(b),this.exp(T,U)}n.prototype.copyTo=y,n.prototype.fromInt=C,n.prototype.fromString=s,n.prototype.clamp=d,n.prototype.dlShiftTo=B,n.prototype.drShiftTo=k,n.prototype.lShiftTo=V,n.prototype.rShiftTo=L,n.prototype.subTo=O,n.prototype.multiplyTo=q,n.prototype.squareTo=M,n.prototype.divRemTo=H,n.prototype.invDigit=W,n.prototype.isEven=_,n.prototype.exp=o,n.prototype.toString=p,n.prototype.negate=I,n.prototype.abs=R,n.prototype.compareTo=c,n.prototype.bitLength=r,n.prototype.mod=Y,n.prototype.modPowInt=A,n.ZERO=g(0),n.ONE=g(1);function F(){var T=v();return this.copyTo(T),T}function P(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function z(){return this.t==0?this.s:this.data[0]<<24>>24}function ee(){return this.t==0?this.s:this.data[0]<<16>>16}function ae(T){return Math.floor(Math.LN2*this.DB/Math.log(T))}function G(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function te(T){if(T==null&&(T=10),this.signum()==0||T<2||T>36)return"0";var b=this.chunkSize(T),U=Math.pow(T,b),K=g(U),Q=v(),X=v(),re="";for(this.divRemTo(K,Q,X);Q.signum()>0;)re=(U+X.intValue()).toString(T).substr(1)+re,Q.divRemTo(K,Q,X);return X.intValue().toString(T)+re}function ie(T,b){this.fromInt(0),b==null&&(b=10);for(var U=this.chunkSize(b),K=Math.pow(b,U),Q=!1,X=0,re=0,J=0;J<T.length;++J){var pe=u(T,J);if(pe<0){T.charAt(J)=="-"&&this.signum()==0&&(Q=!0);continue}re=b*re+pe,++X>=U&&(this.dMultiply(K),this.dAddOffset(re,0),X=0,re=0)}X>0&&(this.dMultiply(Math.pow(b,X)),this.dAddOffset(re,0)),Q&&n.ZERO.subTo(this,this)}function ce(T,b,U){if(typeof b=="number")if(T<2)this.fromInt(1);else for(this.fromNumber(T,U),this.testBit(T-1)||this.bitwiseTo(n.ONE.shiftLeft(T-1),Te,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>T&&this.subTo(n.ONE.shiftLeft(T-1),this);else{var K=new Array,Q=T&7;K.length=(T>>3)+1,b.nextBytes(K),Q>0?K[0]&=(1<<Q)-1:K[0]=0,this.fromString(K,256)}}function oe(){var T=this.t,b=new Array;b[0]=this.s;var U=this.DB-T*this.DB%8,K,Q=0;if(T-- >0)for(U<this.DB&&(K=this.data[T]>>U)!=(this.s&this.DM)>>U&&(b[Q++]=K|this.s<<this.DB-U);T>=0;)U<8?(K=(this.data[T]&(1<<U)-1)<<8-U,K|=this.data[--T]>>(U+=this.DB-8)):(K=this.data[T]>>(U-=8)&255,U<=0&&(U+=this.DB,--T)),(K&128)!=0&&(K|=-256),Q==0&&(this.s&128)!=(K&128)&&++Q,(Q>0||K!=this.s)&&(b[Q++]=K);return b}function me(T){return this.compareTo(T)==0}function Se(T){return this.compareTo(T)<0?this:T}function xe(T){return this.compareTo(T)>0?this:T}function Ce(T,b,U){var K,Q,X=Math.min(T.t,this.t);for(K=0;K<X;++K)U.data[K]=b(this.data[K],T.data[K]);if(T.t<this.t){for(Q=T.s&this.DM,K=X;K<this.t;++K)U.data[K]=b(this.data[K],Q);U.t=this.t}else{for(Q=this.s&this.DM,K=X;K<T.t;++K)U.data[K]=b(Q,T.data[K]);U.t=T.t}U.s=b(this.s,T.s),U.clamp()}function ve(T,b){return T&b}function ye(T){var b=v();return this.bitwiseTo(T,ve,b),b}function Te(T,b){return T|b}function Ke(T){var b=v();return this.bitwiseTo(T,Te,b),b}function Me(T,b){return T^b}function He(T){var b=v();return this.bitwiseTo(T,Me,b),b}function Ge(T,b){return T&~b}function Qe(T){var b=v();return this.bitwiseTo(T,Ge,b),b}function Ye(){for(var T=v(),b=0;b<this.t;++b)T.data[b]=this.DM&~this.data[b];return T.t=this.t,T.s=~this.s,T}function je(T){var b=v();return T<0?this.rShiftTo(-T,b):this.lShiftTo(T,b),b}function et(T){var b=v();return T<0?this.lShiftTo(-T,b):this.rShiftTo(T,b),b}function rt(T){if(T==0)return-1;var b=0;return(T&65535)==0&&(T>>=16,b+=16),(T&255)==0&&(T>>=8,b+=8),(T&15)==0&&(T>>=4,b+=4),(T&3)==0&&(T>>=2,b+=2),(T&1)==0&&++b,b}function it(){for(var T=0;T<this.t;++T)if(this.data[T]!=0)return T*this.DB+rt(this.data[T]);return this.s<0?this.t*this.DB:-1}function ot(T){for(var b=0;T!=0;)T&=T-1,++b;return b}function ft(){for(var T=0,b=this.s&this.DM,U=0;U<this.t;++U)T+=ot(this.data[U]^b);return T}function dt(T){var b=Math.floor(T/this.DB);return b>=this.t?this.s!=0:(this.data[b]&1<<T%this.DB)!=0}function gt(T,b){var U=n.ONE.shiftLeft(T);return this.bitwiseTo(U,b,U),U}function Ae(T){return this.changeBit(T,Te)}function Be(T){return this.changeBit(T,Ge)}function be(T){return this.changeBit(T,Me)}function _e(T,b){for(var U=0,K=0,Q=Math.min(T.t,this.t);U<Q;)K+=this.data[U]+T.data[U],b.data[U++]=K&this.DM,K>>=this.DB;if(T.t<this.t){for(K+=T.s;U<this.t;)K+=this.data[U],b.data[U++]=K&this.DM,K>>=this.DB;K+=this.s}else{for(K+=this.s;U<T.t;)K+=T.data[U],b.data[U++]=K&this.DM,K>>=this.DB;K+=T.s}b.s=K<0?-1:0,K>0?b.data[U++]=K:K<-1&&(b.data[U++]=this.DV+K),b.t=U,b.clamp()}function Ne(T){var b=v();return this.addTo(T,b),b}function Re(T){var b=v();return this.subTo(T,b),b}function we(T){var b=v();return this.multiplyTo(T,b),b}function Le(T){var b=v();return this.divRemTo(T,b,null),b}function ke(T){var b=v();return this.divRemTo(T,null,b),b}function De(T){var b=v(),U=v();return this.divRemTo(T,b,U),new Array(b,U)}function Ue(T){this.data[this.t]=this.am(0,T-1,this,0,0,this.t),++this.t,this.clamp()}function Pe(T,b){if(T!=0){for(;this.t<=b;)this.data[this.t++]=0;for(this.data[b]+=T;this.data[b]>=this.DV;)this.data[b]-=this.DV,++b>=this.t&&(this.data[this.t++]=0),++this.data[b]}}function Ee(){}function Ie(T){return T}function Ve(T,b,U){T.multiplyTo(b,U)}function Oe(T,b){T.squareTo(b)}Ee.prototype.convert=Ie,Ee.prototype.revert=Ie,Ee.prototype.mulTo=Ve,Ee.prototype.sqrTo=Oe;function Aa(T){return this.exp(T,new Ee)}function Ba(T,b,U){var K=Math.min(this.t+T.t,b);for(U.s=0,U.t=K;K>0;)U.data[--K]=0;var Q;for(Q=U.t-this.t;K<Q;++K)U.data[K+this.t]=this.am(0,T.data[K],U,K,0,this.t);for(Q=Math.min(T.t,b);K<Q;++K)this.am(0,T.data[K],U,K,0,b-K);U.clamp()}function ba(T,b,U){--b;var K=U.t=this.t+T.t-b;for(U.s=0;--K>=0;)U.data[K]=0;for(K=Math.max(b-this.t,0);K<T.t;++K)U.data[this.t+K-b]=this.am(b-K,T.data[K],U,0,0,this.t+K-b);U.clamp(),U.drShiftTo(1,U)}function ct(T){this.r2=v(),this.q3=v(),n.ONE.dlShiftTo(2*T.t,this.r2),this.mu=this.r2.divide(T),this.m=T}function _a(T){if(T.s<0||T.t>2*this.m.t)return T.mod(this.m);if(T.compareTo(this.m)<0)return T;var b=v();return T.copyTo(b),this.reduce(b),b}function Na(T){return T}function Ra(T){for(T.drShiftTo(this.m.t-1,this.r2),T.t>this.m.t+1&&(T.t=this.m.t+1,T.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);T.compareTo(this.r2)<0;)T.dAddOffset(1,this.m.t+1);for(T.subTo(this.r2,T);T.compareTo(this.m)>=0;)T.subTo(this.m,T)}function wa(T,b){T.squareTo(b),this.reduce(b)}function La(T,b,U){T.multiplyTo(b,U),this.reduce(U)}ct.prototype.convert=_a,ct.prototype.revert=Na,ct.prototype.reduce=Ra,ct.prototype.mulTo=La,ct.prototype.sqrTo=wa;function ka(T,b){var U=T.bitLength(),K,Q=g(1),X;if(U<=0)return Q;U<18?K=1:U<48?K=3:U<144?K=4:U<768?K=5:K=6,U<8?X=new j(b):b.isEven()?X=new ct(b):X=new ue(b);var re=new Array,J=3,pe=K-1,Fe=(1<<K)-1;if(re[1]=X.convert(this),K>1){var Xe=v();for(X.sqrTo(re[1],Xe);J<=Fe;)re[J]=v(),X.mulTo(Xe,re[J-2],re[J]),J+=2}var ze=T.t-1,at,mt=!0,Ze=v(),$e;for(U=i(T.data[ze])-1;ze>=0;){for(U>=pe?at=T.data[ze]>>U-pe&Fe:(at=(T.data[ze]&(1<<U+1)-1)<<pe-U,ze>0&&(at|=T.data[ze-1]>>this.DB+U-pe)),J=K;(at&1)==0;)at>>=1,--J;if((U-=J)<0&&(U+=this.DB,--ze),mt)re[at].copyTo(Q),mt=!1;else{for(;J>1;)X.sqrTo(Q,Ze),X.sqrTo(Ze,Q),J-=2;J>0?X.sqrTo(Q,Ze):($e=Q,Q=Ze,Ze=$e),X.mulTo(Ze,re[at],Q)}for(;ze>=0&&(T.data[ze]&1<<U)==0;)X.sqrTo(Q,Ze),$e=Q,Q=Ze,Ze=$e,--U<0&&(U=this.DB-1,--ze)}return X.revert(Q)}function Da(T){var b=this.s<0?this.negate():this.clone(),U=T.s<0?T.negate():T.clone();if(b.compareTo(U)<0){var K=b;b=U,U=K}var Q=b.getLowestSetBit(),X=U.getLowestSetBit();if(X<0)return b;for(Q<X&&(X=Q),X>0&&(b.rShiftTo(X,b),U.rShiftTo(X,U));b.signum()>0;)(Q=b.getLowestSetBit())>0&&b.rShiftTo(Q,b),(Q=U.getLowestSetBit())>0&&U.rShiftTo(Q,U),b.compareTo(U)>=0?(b.subTo(U,b),b.rShiftTo(1,b)):(U.subTo(b,U),U.rShiftTo(1,U));return X>0&&U.lShiftTo(X,U),U}function Ua(T){if(T<=0)return 0;var b=this.DV%T,U=this.s<0?T-1:0;if(this.t>0)if(b==0)U=this.data[0]%T;else for(var K=this.t-1;K>=0;--K)U=(b*U+this.data[K])%T;return U}function Pa(T){var b=T.isEven();if(this.isEven()&&b||T.signum()==0)return n.ZERO;for(var U=T.clone(),K=this.clone(),Q=g(1),X=g(0),re=g(0),J=g(1);U.signum()!=0;){for(;U.isEven();)U.rShiftTo(1,U),b?((!Q.isEven()||!X.isEven())&&(Q.addTo(this,Q),X.subTo(T,X)),Q.rShiftTo(1,Q)):X.isEven()||X.subTo(T,X),X.rShiftTo(1,X);for(;K.isEven();)K.rShiftTo(1,K),b?((!re.isEven()||!J.isEven())&&(re.addTo(this,re),J.subTo(T,J)),re.rShiftTo(1,re)):J.isEven()||J.subTo(T,J),J.rShiftTo(1,J);U.compareTo(K)>=0?(U.subTo(K,U),b&&Q.subTo(re,Q),X.subTo(J,X)):(K.subTo(U,K),b&&re.subTo(Q,re),J.subTo(X,J))}if(K.compareTo(n.ONE)!=0)return n.ZERO;if(J.compareTo(T)>=0)return J.subtract(T);if(J.signum()<0)J.addTo(T,J);else return J;return J.signum()<0?J.add(T):J}var We=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Va=(1<<26)/We[We.length-1];function Oa(T){var b,U=this.abs();if(U.t==1&&U.data[0]<=We[We.length-1]){for(b=0;b<We.length;++b)if(U.data[0]==We[b])return!0;return!1}if(U.isEven())return!1;for(b=1;b<We.length;){for(var K=We[b],Q=b+1;Q<We.length&&K<Va;)K*=We[Q++];for(K=U.modInt(K);b<Q;)if(K%We[b++]==0)return!1}return U.millerRabin(T)}function Fa(T){var b=this.subtract(n.ONE),U=b.getLowestSetBit();if(U<=0)return!1;for(var K=b.shiftRight(U),Q=Ka(),X,re=0;re<T;++re){do X=new n(this.bitLength(),Q);while(X.compareTo(n.ONE)<=0||X.compareTo(b)>=0);var J=X.modPow(K,this);if(J.compareTo(n.ONE)!=0&&J.compareTo(b)!=0){for(var pe=1;pe++<U&&J.compareTo(b)!=0;)if(J=J.modPowInt(2,this),J.compareTo(n.ONE)==0)return!1;if(J.compareTo(b)!=0)return!1}}return!0}function Ka(){return{nextBytes:function(T){for(var b=0;b<T.length;++b)T[b]=Math.floor(Math.random()*256)}}}return n.prototype.chunkSize=ae,n.prototype.toRadix=te,n.prototype.fromRadix=ie,n.prototype.fromNumber=ce,n.prototype.bitwiseTo=Ce,n.prototype.changeBit=gt,n.prototype.addTo=_e,n.prototype.dMultiply=Ue,n.prototype.dAddOffset=Pe,n.prototype.multiplyLowerTo=Ba,n.prototype.multiplyUpperTo=ba,n.prototype.modInt=Ua,n.prototype.millerRabin=Fa,n.prototype.clone=F,n.prototype.intValue=P,n.prototype.byteValue=z,n.prototype.shortValue=ee,n.prototype.signum=G,n.prototype.toByteArray=oe,n.prototype.equals=me,n.prototype.min=Se,n.prototype.max=xe,n.prototype.and=ye,n.prototype.or=Ke,n.prototype.xor=He,n.prototype.andNot=Qe,n.prototype.not=Ye,n.prototype.shiftLeft=je,n.prototype.shiftRight=et,n.prototype.getLowestSetBit=it,n.prototype.bitCount=ft,n.prototype.testBit=dt,n.prototype.setBit=Ae,n.prototype.clearBit=Be,n.prototype.flipBit=be,n.prototype.add=Ne,n.prototype.subtract=Re,n.prototype.multiply=we,n.prototype.divide=Le,n.prototype.remainder=ke,n.prototype.divideAndRemainder=De,n.prototype.modPow=ka,n.prototype.modInverse=Pa,n.prototype.pow=Aa,n.prototype.gcd=Da,n.prototype.isProbablePrime=Oa,Xt}var jt={exports:{}},Wt={exports:{}},Kr;function yt(){if(Kr)return Wt.exports;Kr=1;var a=le();nt(),de();var e=Wt.exports=a.sha1=a.sha1||{};a.md.sha1=a.md.algorithms.sha1=e,e.create=function(){v||N();var h=null,t=a.util.createBuffer(),m=new Array(80),f={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return f.start=function(){f.messageLength=0,f.fullMessageLength=f.messageLength64=[];for(var x=f.messageLengthSize/4,D=0;D<x;++D)f.fullMessageLength.push(0);return t=a.util.createBuffer(),h={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},f},f.start(),f.update=function(x,D){D==="utf8"&&(x=a.util.encodeUtf8(x));var E=x.length;f.messageLength+=E,E=[E/4294967296>>>0,E>>>0];for(var u=f.fullMessageLength.length-1;u>=0;--u)f.fullMessageLength[u]+=E[1],E[1]=E[0]+(f.fullMessageLength[u]/4294967296>>>0),f.fullMessageLength[u]=f.fullMessageLength[u]>>>0,E[0]=E[1]/4294967296>>>0;return t.putBytes(x),S(h,m,t),(t.read>2048||t.length()===0)&&t.compact(),f},f.digest=function(){var x=a.util.createBuffer();x.putBytes(t.bytes());var D=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize,E=D&f.blockLength-1;x.putBytes(n.substr(0,f.blockLength-E));for(var u,y,C=f.fullMessageLength[0]*8,g=0;g<f.fullMessageLength.length-1;++g)u=f.fullMessageLength[g+1]*8,y=u/4294967296>>>0,C+=y,x.putInt32(C>>>0),C=u>>>0;x.putInt32(C);var s={h0:h.h0,h1:h.h1,h2:h.h2,h3:h.h3,h4:h.h4};S(s,m,x);var d=a.util.createBuffer();return d.putInt32(s.h0),d.putInt32(s.h1),d.putInt32(s.h2),d.putInt32(s.h3),d.putInt32(s.h4),d},f};var n=null,v=!1;function N(){n="",n+=a.util.fillString("\0",64),v=!0}function S(h,t,m){for(var f,x,D,E,u,y,C,g,s=m.length();s>=64;){for(x=h.h0,D=h.h1,E=h.h2,u=h.h3,y=h.h4,g=0;g<16;++g)f=m.getInt32(),t[g]=f,C=u^D&(E^u),f=(x<<5|x>>>27)+C+y+1518500249+f,y=u,u=E,E=(D<<30|D>>>2)>>>0,D=x,x=f;for(;g<20;++g)f=t[g-3]^t[g-8]^t[g-14]^t[g-16],f=f<<1|f>>>31,t[g]=f,C=u^D&(E^u),f=(x<<5|x>>>27)+C+y+1518500249+f,y=u,u=E,E=(D<<30|D>>>2)>>>0,D=x,x=f;for(;g<32;++g)f=t[g-3]^t[g-8]^t[g-14]^t[g-16],f=f<<1|f>>>31,t[g]=f,C=D^E^u,f=(x<<5|x>>>27)+C+y+1859775393+f,y=u,u=E,E=(D<<30|D>>>2)>>>0,D=x,x=f;for(;g<40;++g)f=t[g-6]^t[g-16]^t[g-28]^t[g-32],f=f<<2|f>>>30,t[g]=f,C=D^E^u,f=(x<<5|x>>>27)+C+y+1859775393+f,y=u,u=E,E=(D<<30|D>>>2)>>>0,D=x,x=f;for(;g<60;++g)f=t[g-6]^t[g-16]^t[g-28]^t[g-32],f=f<<2|f>>>30,t[g]=f,C=D&E|u&(D^E),f=(x<<5|x>>>27)+C+y+2400959708+f,y=u,u=E,E=(D<<30|D>>>2)>>>0,D=x,x=f;for(;g<80;++g)f=t[g-6]^t[g-16]^t[g-28]^t[g-32],f=f<<2|f>>>30,t[g]=f,C=D^E^u,f=(x<<5|x>>>27)+C+y+3395469782+f,y=u,u=E,E=(D<<30|D>>>2)>>>0,D=x,x=f;h.h0=h.h0+x|0,h.h1=h.h1+D|0,h.h2=h.h2+E|0,h.h3=h.h3+u|0,h.h4=h.h4+y|0,s-=64}}return Wt.exports}var Mr;function va(){if(Mr)return jt.exports;Mr=1;var a=le();de(),Je(),yt();var e=jt.exports=a.pkcs1=a.pkcs1||{};e.encode_rsa_oaep=function(v,N,S){var h,t,m,f;typeof S=="string"?(h=S,t=arguments[3]||void 0,m=arguments[4]||void 0):S&&(h=S.label||void 0,t=S.seed||void 0,m=S.md||void 0,S.mgf1&&S.mgf1.md&&(f=S.mgf1.md)),m?m.start():m=a.md.sha1.create(),f||(f=m);var x=Math.ceil(v.n.bitLength()/8),D=x-2*m.digestLength-2;if(N.length>D){var E=new Error("RSAES-OAEP input message length is too long.");throw E.length=N.length,E.maxLength=D,E}h||(h=""),m.update(h,"raw");for(var u=m.digest(),y="",C=D-N.length,g=0;g<C;g++)y+="\0";var s=u.getBytes()+y+""+N;if(!t)t=a.random.getBytes(m.digestLength);else if(t.length!==m.digestLength){var E=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw E.seedLength=t.length,E.digestLength=m.digestLength,E}var d=n(t,x-m.digestLength-1,f),p=a.util.xorBytes(s,d,s.length),I=n(p,m.digestLength,f),R=a.util.xorBytes(t,I,t.length);return"\0"+R+p},e.decode_rsa_oaep=function(v,N,S){var h,t,m;typeof S=="string"?(h=S,t=arguments[3]||void 0):S&&(h=S.label||void 0,t=S.md||void 0,S.mgf1&&S.mgf1.md&&(m=S.mgf1.md));var f=Math.ceil(v.n.bitLength()/8);if(N.length!==f){var p=new Error("RSAES-OAEP encoded message length is invalid.");throw p.length=N.length,p.expectedLength=f,p}if(t===void 0?t=a.md.sha1.create():t.start(),m||(m=t),f<2*t.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");h||(h=""),t.update(h,"raw");for(var x=t.digest().getBytes(),D=N.charAt(0),E=N.substring(1,t.digestLength+1),u=N.substring(1+t.digestLength),y=n(u,t.digestLength,m),C=a.util.xorBytes(E,y,E.length),g=n(C,f-t.digestLength-1,m),s=a.util.xorBytes(u,g,u.length),d=s.substring(0,t.digestLength),p=D!=="\0",I=0;I<t.digestLength;++I)p|=x.charAt(I)!==d.charAt(I);for(var R=1,c=t.digestLength,i=t.digestLength;i<s.length;i++){var r=s.charCodeAt(i),B=r&1^1,k=R?65534:0;p|=r&k,R=R&B,c+=R}if(p||s.charCodeAt(c)!==1)throw new Error("Invalid RSAES-OAEP padding.");return s.substring(c+1)};function n(v,N,S){S||(S=a.md.sha1.create());for(var h="",t=Math.ceil(N/S.digestLength),m=0;m<t;++m){var f=String.fromCharCode(m>>24&255,m>>16&255,m>>8&255,m&255);S.start(),S.update(v+f),h+=S.digest().getBytes()}return h.substring(0,N)}return jt.exports}var xt={exports:{}},qr;function ya(){if(qr)return xt.exports;qr=1;var a=le();return de(),At(),Je(),function(){if(a.prime){xt.exports=a.prime;return}var e=xt.exports=a.prime=a.prime||{},n=a.jsbn.BigInteger,v=[6,4,2,4,2,4,6,2],N=new n(null);N.fromInt(30);var S=function(E,u){return E|u};e.generateProbablePrime=function(E,u,y){typeof u=="function"&&(y=u,u={}),u=u||{};var C=u.algorithm||"PRIMEINC";typeof C=="string"&&(C={name:C}),C.options=C.options||{};var g=u.prng||a.random,s={nextBytes:function(d){for(var p=g.getBytesSync(d.length),I=0;I<d.length;++I)d[I]=p.charCodeAt(I)}};if(C.name==="PRIMEINC")return h(E,s,C.options,y);throw new Error("Invalid prime generation algorithm: "+C.name)};function h(E,u,y,C){return"workers"in y?f(E,u,y,C):t(E,u,y,C)}function t(E,u,y,C){var g=x(E,u),s=0,d=D(g.bitLength());"millerRabinTests"in y&&(d=y.millerRabinTests);var p=10;"maxBlockTime"in y&&(p=y.maxBlockTime),m(g,E,u,s,d,p,C)}function m(E,u,y,C,g,s,d){var p=+new Date;do{if(E.bitLength()>u&&(E=x(u,y)),E.isProbablePrime(g))return d(null,E);E.dAddOffset(v[C++%8],0)}while(s<0||+new Date-p<s);a.util.setImmediate(function(){m(E,u,y,C,g,s,d)})}function f(E,u,y,C){if(typeof Worker>"u")return t(E,u,y,C);var g=x(E,u),s=y.workers,d=y.workLoad||100,p=d*30/8,I=y.workerScript||"forge/prime.worker.js";if(s===-1)return a.util.estimateCores(function(c,i){c&&(i=2),s=i-1,R()});R();function R(){s=Math.max(1,s);for(var c=[],i=0;i<s;++i)c[i]=new Worker(I);for(var i=0;i<s;++i)c[i].addEventListener("message",B);var r=!1;function B(k){if(!r){var V=k.data;if(V.found){for(var L=0;L<c.length;++L)c[L].terminate();return r=!0,C(null,new n(V.prime,16))}g.bitLength()>E&&(g=x(E,u));var O=g.toString(16);k.target.postMessage({hex:O,workLoad:d}),g.dAddOffset(p,0)}}}}function x(E,u){var y=new n(E,u),C=E-1;return y.testBit(C)||y.bitwiseTo(n.ONE.shiftLeft(C),S,y),y.dAddOffset(31-y.mod(N).byteValue(),0),y}function D(E){return E<=100?27:E<=150?18:E<=200?15:E<=250?12:E<=300?9:E<=350?8:E<=400?7:E<=500?6:E<=600?5:E<=800?4:E<=1250?3:2}}(),xt.exports}var Zt,Hr;function Bt(){if(Hr)return Zt;Hr=1;var a=le();if(tt(),At(),lt(),va(),ya(),Je(),de(),typeof e>"u")var e=a.jsbn.BigInteger;var n=a.util.isNodejs?yr:null,v=a.asn1,N=a.util;a.pki=a.pki||{},Zt=a.pki.rsa=a.rsa=a.rsa||{};var S=a.pki,h=[6,4,2,4,2,4,6,2],t={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},m={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},f={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},x=a.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},D={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},E=function(i){var r;if(i.algorithm in S.oids)r=S.oids[i.algorithm];else{var B=new Error("Unknown message digest algorithm.");throw B.algorithm=i.algorithm,B}var k=v.oidToDer(r).getBytes(),V=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),L=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);L.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,k)),L.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var O=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,i.digest().getBytes());return V.value.push(L),V.value.push(O),v.toDer(V).getBytes()},u=function(i,r,B){if(B)return i.modPow(r.e,r.n);if(!r.p||!r.q)return i.modPow(r.d,r.n);r.dP||(r.dP=r.d.mod(r.p.subtract(e.ONE))),r.dQ||(r.dQ=r.d.mod(r.q.subtract(e.ONE))),r.qInv||(r.qInv=r.q.modInverse(r.p));var k;do k=new e(a.util.bytesToHex(a.random.getBytes(r.n.bitLength()/8)),16);while(k.compareTo(r.n)>=0||!k.gcd(r.n).equals(e.ONE));i=i.multiply(k.modPow(r.e,r.n)).mod(r.n);for(var V=i.mod(r.p).modPow(r.dP,r.p),L=i.mod(r.q).modPow(r.dQ,r.q);V.compareTo(L)<0;)V=V.add(r.p);var O=V.subtract(L).multiply(r.qInv).mod(r.p).multiply(r.q).add(L);return O=O.multiply(k.modInverse(r.n)).mod(r.n),O};S.rsa.encrypt=function(i,r,B){var k=B,V,L=Math.ceil(r.n.bitLength()/8);B!==!1&&B!==!0?(k=B===2,V=y(i,r,B)):(V=a.util.createBuffer(),V.putBytes(i));for(var O=new e(V.toHex(),16),q=u(O,r,k),M=q.toString(16),H=a.util.createBuffer(),Y=L-Math.ceil(M.length/2);Y>0;)H.putByte(0),--Y;return H.putBytes(a.util.hexToBytes(M)),H.getBytes()},S.rsa.decrypt=function(i,r,B,k){var V=Math.ceil(r.n.bitLength()/8);if(i.length!==V){var L=new Error("Encrypted message length is invalid.");throw L.length=i.length,L.expected=V,L}var O=new e(a.util.createBuffer(i).toHex(),16);if(O.compareTo(r.n)>=0)throw new Error("Encrypted message is invalid.");for(var q=u(O,r,B),M=q.toString(16),H=a.util.createBuffer(),Y=V-Math.ceil(M.length/2);Y>0;)H.putByte(0),--Y;return H.putBytes(a.util.hexToBytes(M)),k!==!1?C(H.getBytes(),r,B):H.getBytes()},S.rsa.createKeyPairGenerationState=function(i,r,B){typeof i=="string"&&(i=parseInt(i,10)),i=i||2048,B=B||{};var k=B.prng||a.random,V={nextBytes:function(q){for(var M=k.getBytesSync(q.length),H=0;H<q.length;++H)q[H]=M.charCodeAt(H)}},L=B.algorithm||"PRIMEINC",O;if(L==="PRIMEINC")O={algorithm:L,state:0,bits:i,rng:V,eInt:r||65537,e:new e(null),p:null,q:null,qBits:i>>1,pBits:i-(i>>1),pqState:0,num:null,keys:null},O.e.fromInt(O.eInt);else throw new Error("Invalid key generation algorithm: "+L);return O},S.rsa.stepKeyPairGenerationState=function(i,r){"algorithm"in i||(i.algorithm="PRIMEINC");var B=new e(null);B.fromInt(30);for(var k=0,V=function(j,$){return j|$},L=+new Date,O,q=0;i.keys===null&&(r<=0||q<r);){if(i.state===0){var M=i.p===null?i.pBits:i.qBits,H=M-1;i.pqState===0?(i.num=new e(M,i.rng),i.num.testBit(H)||i.num.bitwiseTo(e.ONE.shiftLeft(H),V,i.num),i.num.dAddOffset(31-i.num.mod(B).byteValue(),0),k=0,++i.pqState):i.pqState===1?i.num.bitLength()>M?i.pqState=0:i.num.isProbablePrime(d(i.num.bitLength()))?++i.pqState:i.num.dAddOffset(h[k++%8],0):i.pqState===2?i.pqState=i.num.subtract(e.ONE).gcd(i.e).compareTo(e.ONE)===0?3:0:i.pqState===3&&(i.pqState=0,i.p===null?i.p=i.num:i.q=i.num,i.p!==null&&i.q!==null&&++i.state,i.num=null)}else if(i.state===1)i.p.compareTo(i.q)<0&&(i.num=i.p,i.p=i.q,i.q=i.num),++i.state;else if(i.state===2)i.p1=i.p.subtract(e.ONE),i.q1=i.q.subtract(e.ONE),i.phi=i.p1.multiply(i.q1),++i.state;else if(i.state===3)i.phi.gcd(i.e).compareTo(e.ONE)===0?++i.state:(i.p=null,i.q=null,i.state=0);else if(i.state===4)i.n=i.p.multiply(i.q),i.n.bitLength()===i.bits?++i.state:(i.q=null,i.state=0);else if(i.state===5){var Y=i.e.modInverse(i.phi);i.keys={privateKey:S.rsa.setPrivateKey(i.n,i.e,Y,i.p,i.q,Y.mod(i.p1),Y.mod(i.q1),i.q.modInverse(i.p)),publicKey:S.rsa.setPublicKey(i.n,i.e)}}O=+new Date,q+=O-L,L=O}return i.keys!==null},S.rsa.generateKeyPair=function(i,r,B,k){if(arguments.length===1?typeof i=="object"?(B=i,i=void 0):typeof i=="function"&&(k=i,i=void 0):arguments.length===2?typeof i=="number"?typeof r=="function"?(k=r,r=void 0):typeof r!="number"&&(B=r,r=void 0):(B=i,k=r,i=void 0,r=void 0):arguments.length===3&&(typeof r=="number"?typeof B=="function"&&(k=B,B=void 0):(k=B,B=r,r=void 0)),B=B||{},i===void 0&&(i=B.bits||2048),r===void 0&&(r=B.e||65537),!a.options.usePureJavaScript&&!B.prng&&i>=256&&i<=16384&&(r===65537||r===3)){if(k){if(p("generateKeyPair"))return n.generateKeyPair("rsa",{modulusLength:i,publicExponent:r,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(q,M,H){if(q)return k(q);k(null,{privateKey:S.privateKeyFromPem(H),publicKey:S.publicKeyFromPem(M)})});if(I("generateKey")&&I("exportKey"))return N.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:i,publicExponent:c(r),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(q){return N.globalScope.crypto.subtle.exportKey("pkcs8",q.privateKey)}).then(void 0,function(q){k(q)}).then(function(q){if(q){var M=S.privateKeyFromAsn1(v.fromDer(a.util.createBuffer(q)));k(null,{privateKey:M,publicKey:S.setRsaPublicKey(M.n,M.e)})}});if(R("generateKey")&&R("exportKey")){var V=N.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:i,publicExponent:c(r),hash:{name:"SHA-256"}},!0,["sign","verify"]);V.oncomplete=function(q){var M=q.target.result,H=N.globalScope.msCrypto.subtle.exportKey("pkcs8",M.privateKey);H.oncomplete=function(Y){var j=Y.target.result,$=S.privateKeyFromAsn1(v.fromDer(a.util.createBuffer(j)));k(null,{privateKey:$,publicKey:S.setRsaPublicKey($.n,$.e)})},H.onerror=function(Y){k(Y)}},V.onerror=function(q){k(q)};return}}else if(p("generateKeyPairSync")){var L=n.generateKeyPairSync("rsa",{modulusLength:i,publicExponent:r,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:S.privateKeyFromPem(L.privateKey),publicKey:S.publicKeyFromPem(L.publicKey)}}}var O=S.rsa.createKeyPairGenerationState(i,r,B);if(!k)return S.rsa.stepKeyPairGenerationState(O,0),O.keys;g(O,B,k)},S.setRsaPublicKey=S.rsa.setPublicKey=function(i,r){var B={n:i,e:r};return B.encrypt=function(k,V,L){if(typeof V=="string"?V=V.toUpperCase():V===void 0&&(V="RSAES-PKCS1-V1_5"),V==="RSAES-PKCS1-V1_5")V={encode:function(q,M,H){return y(q,M,2).getBytes()}};else if(V==="RSA-OAEP"||V==="RSAES-OAEP")V={encode:function(q,M){return a.pkcs1.encode_rsa_oaep(M,q,L)}};else if(["RAW","NONE","NULL",null].indexOf(V)!==-1)V={encode:function(q){return q}};else if(typeof V=="string")throw new Error('Unsupported encryption scheme: "'+V+'".');var O=V.encode(k,B,!0);return S.rsa.encrypt(O,B,!0)},B.verify=function(k,V,L,O){typeof L=="string"?L=L.toUpperCase():L===void 0&&(L="RSASSA-PKCS1-V1_5"),O===void 0&&(O={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in O||(O._parseAllDigestBytes=!0),L==="RSASSA-PKCS1-V1_5"?L={verify:function(M,H){H=C(H,B,!0);var Y=v.fromDer(H,{parseAllBytes:O._parseAllDigestBytes}),j={},$=[];if(!v.validate(Y,D,j,$)){var ne=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw ne.errors=$,ne}var se=v.derToOid(j.algorithmIdentifier);if(!(se===a.oids.md2||se===a.oids.md5||se===a.oids.sha1||se===a.oids.sha224||se===a.oids.sha256||se===a.oids.sha384||se===a.oids.sha512||se===a.oids["sha512-224"]||se===a.oids["sha512-256"])){var ne=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw ne.oid=se,ne}if((se===a.oids.md2||se===a.oids.md5)&&!("parameters"in j))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return M===j.digest}}:(L==="NONE"||L==="NULL"||L===null)&&(L={verify:function(M,H){return H=C(H,B,!0),M===H}});var q=S.rsa.decrypt(V,B,!0,!1);return L.verify(k,q,B.n.bitLength())},B},S.setRsaPrivateKey=S.rsa.setPrivateKey=function(i,r,B,k,V,L,O,q){var M={n:i,e:r,d:B,p:k,q:V,dP:L,dQ:O,qInv:q};return M.decrypt=function(H,Y,j){typeof Y=="string"?Y=Y.toUpperCase():Y===void 0&&(Y="RSAES-PKCS1-V1_5");var $=S.rsa.decrypt(H,M,!1,!1);if(Y==="RSAES-PKCS1-V1_5")Y={decode:C};else if(Y==="RSA-OAEP"||Y==="RSAES-OAEP")Y={decode:function(ne,se){return a.pkcs1.decode_rsa_oaep(se,ne,j)}};else if(["RAW","NONE","NULL",null].indexOf(Y)!==-1)Y={decode:function(ne){return ne}};else throw new Error('Unsupported encryption scheme: "'+Y+'".');return Y.decode($,M,!1)},M.sign=function(H,Y){var j=!1;typeof Y=="string"&&(Y=Y.toUpperCase()),Y===void 0||Y==="RSASSA-PKCS1-V1_5"?(Y={encode:E},j=1):(Y==="NONE"||Y==="NULL"||Y===null)&&(Y={encode:function(){return H}},j=1);var $=Y.encode(H,M.n.bitLength());return S.rsa.encrypt($,M,j)},M},S.wrapRsaPrivateKey=function(i){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(S.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(i).getBytes())])},S.privateKeyFromAsn1=function(i){var r={},B=[];if(v.validate(i,t,r,B)&&(i=v.fromDer(a.util.createBuffer(r.privateKey))),r={},B=[],!v.validate(i,m,r,B)){var k=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw k.errors=B,k}var V,L,O,q,M,H,Y,j;return V=a.util.createBuffer(r.privateKeyModulus).toHex(),L=a.util.createBuffer(r.privateKeyPublicExponent).toHex(),O=a.util.createBuffer(r.privateKeyPrivateExponent).toHex(),q=a.util.createBuffer(r.privateKeyPrime1).toHex(),M=a.util.createBuffer(r.privateKeyPrime2).toHex(),H=a.util.createBuffer(r.privateKeyExponent1).toHex(),Y=a.util.createBuffer(r.privateKeyExponent2).toHex(),j=a.util.createBuffer(r.privateKeyCoefficient).toHex(),S.setRsaPrivateKey(new e(V,16),new e(L,16),new e(O,16),new e(q,16),new e(M,16),new e(H,16),new e(Y,16),new e(j,16))},S.privateKeyToAsn1=S.privateKeyToRSAPrivateKey=function(i){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,s(i.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,s(i.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,s(i.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,s(i.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,s(i.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,s(i.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,s(i.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,s(i.qInv))])},S.publicKeyFromAsn1=function(i){var r={},B=[];if(v.validate(i,x,r,B)){var k=v.derToOid(r.publicKeyOid);if(k!==S.oids.rsaEncryption){var V=new Error("Cannot read public key. Unknown OID.");throw V.oid=k,V}i=r.rsaPublicKey}if(B=[],!v.validate(i,f,r,B)){var V=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw V.errors=B,V}var L=a.util.createBuffer(r.publicKeyModulus).toHex(),O=a.util.createBuffer(r.publicKeyExponent).toHex();return S.setRsaPublicKey(new e(L,16),new e(O,16))},S.publicKeyToAsn1=S.publicKeyToSubjectPublicKeyInfo=function(i){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(S.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[S.publicKeyToRSAPublicKey(i)])])},S.publicKeyToRSAPublicKey=function(i){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,s(i.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,s(i.e))])};function y(i,r,B){var k=a.util.createBuffer(),V=Math.ceil(r.n.bitLength()/8);if(i.length>V-11){var L=new Error("Message is too long for PKCS#1 v1.5 padding.");throw L.length=i.length,L.max=V-11,L}k.putByte(0),k.putByte(B);var O=V-3-i.length,q;if(B===0||B===1){q=B===0?0:255;for(var M=0;M<O;++M)k.putByte(q)}else for(;O>0;){for(var H=0,Y=a.random.getBytes(O),M=0;M<O;++M)q=Y.charCodeAt(M),q===0?++H:k.putByte(q);O=H}return k.putByte(0),k.putBytes(i),k}function C(i,r,B,k){var V=Math.ceil(r.n.bitLength()/8),L=a.util.createBuffer(i),O=L.getByte(),q=L.getByte();if(O!==0||B&&q!==0&&q!==1||!B&&q!=2||B&&q===0&&typeof k>"u")throw new Error("Encryption block is invalid.");var M=0;if(q===0){M=V-3-k;for(var H=0;H<M;++H)if(L.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(q===1)for(M=0;L.length()>1;){if(L.getByte()!==255){--L.read;break}++M}else if(q===2)for(M=0;L.length()>1;){if(L.getByte()===0){--L.read;break}++M}var Y=L.getByte();if(Y!==0||M!==V-3-L.length())throw new Error("Encryption block is invalid.");return L.getBytes()}function g(i,r,B){typeof r=="function"&&(B=r,r={}),r=r||{};var k={algorithm:{name:r.algorithm||"PRIMEINC",options:{workers:r.workers||2,workLoad:r.workLoad||100,workerScript:r.workerScript}}};"prng"in r&&(k.prng=r.prng),V();function V(){L(i.pBits,function(q,M){if(q)return B(q);if(i.p=M,i.q!==null)return O(q,i.q);L(i.qBits,O)})}function L(q,M){a.prime.generateProbablePrime(q,k,M)}function O(q,M){if(q)return B(q);if(i.q=M,i.p.compareTo(i.q)<0){var H=i.p;i.p=i.q,i.q=H}if(i.p.subtract(e.ONE).gcd(i.e).compareTo(e.ONE)!==0){i.p=null,V();return}if(i.q.subtract(e.ONE).gcd(i.e).compareTo(e.ONE)!==0){i.q=null,L(i.qBits,O);return}if(i.p1=i.p.subtract(e.ONE),i.q1=i.q.subtract(e.ONE),i.phi=i.p1.multiply(i.q1),i.phi.gcd(i.e).compareTo(e.ONE)!==0){i.p=i.q=null,V();return}if(i.n=i.p.multiply(i.q),i.n.bitLength()!==i.bits){i.q=null,L(i.qBits,O);return}var Y=i.e.modInverse(i.phi);i.keys={privateKey:S.rsa.setPrivateKey(i.n,i.e,Y,i.p,i.q,Y.mod(i.p1),Y.mod(i.q1),i.q.modInverse(i.p)),publicKey:S.rsa.setPublicKey(i.n,i.e)},B(null,i.keys)}}function s(i){var r=i.toString(16);r[0]>="8"&&(r="00"+r);var B=a.util.hexToBytes(r);return B.length>1&&(B.charCodeAt(0)===0&&(B.charCodeAt(1)&128)===0||B.charCodeAt(0)===255&&(B.charCodeAt(1)&128)===128)?B.substr(1):B}function d(i){return i<=100?27:i<=150?18:i<=200?15:i<=250?12:i<=300?9:i<=350?8:i<=400?7:i<=500?6:i<=600?5:i<=800?4:i<=1250?3:2}function p(i){return a.util.isNodejs&&typeof n[i]=="function"}function I(i){return typeof N.globalScope<"u"&&typeof N.globalScope.crypto=="object"&&typeof N.globalScope.crypto.subtle=="object"&&typeof N.globalScope.crypto.subtle[i]=="function"}function R(i){return typeof N.globalScope<"u"&&typeof N.globalScope.msCrypto=="object"&&typeof N.globalScope.msCrypto.subtle=="object"&&typeof N.globalScope.msCrypto.subtle[i]=="function"}function c(i){for(var r=a.util.hexToBytes(i.toString(16)),B=new Uint8Array(r.length),k=0;k<r.length;++k)B[k]=r.charCodeAt(k);return B}return Zt}var $t,Gr;function ga(){if(Gr)return $t;Gr=1;var a=le();if(ut(),tt(),It(),nt(),lt(),gr(),ht(),Je(),pa(),Bt(),de(),typeof e>"u")var e=a.jsbn.BigInteger;var n=a.asn1,v=a.pki=a.pki||{};$t=v.pbe=a.pbe=a.pbe||{};var N=v.oids,S={name:"EncryptedPrivateKeyInfo",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},h={name:"PBES2Algorithms",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:n.Class.UNIVERSAL,type:n.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},t={name:"pkcs-12PbeParams",tagClass:n.Class.UNIVERSAL,type:n.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:n.Class.UNIVERSAL,type:n.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:n.Class.UNIVERSAL,type:n.Type.INTEGER,constructed:!1,capture:"iterations"}]};v.encryptPrivateKeyInfo=function(E,u,y){y=y||{},y.saltSize=y.saltSize||8,y.count=y.count||2048,y.algorithm=y.algorithm||"aes128",y.prfAlgorithm=y.prfAlgorithm||"sha1";var C=a.random.getBytesSync(y.saltSize),g=y.count,s=n.integerToDer(g),d,p,I;if(y.algorithm.indexOf("aes")===0||y.algorithm==="des"){var R,c,i;switch(y.algorithm){case"aes128":d=16,R=16,c=N["aes128-CBC"],i=a.aes.createEncryptionCipher;break;case"aes192":d=24,R=16,c=N["aes192-CBC"],i=a.aes.createEncryptionCipher;break;case"aes256":d=32,R=16,c=N["aes256-CBC"],i=a.aes.createEncryptionCipher;break;case"des":d=8,R=8,c=N.desCBC,i=a.des.createEncryptionCipher;break;default:var r=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw r.algorithm=y.algorithm,r}var B="hmacWith"+y.prfAlgorithm.toUpperCase(),k=x(B),V=a.pkcs5.pbkdf2(u,C,g,d,k),L=a.random.getBytesSync(R),O=i(V);O.start(L),O.update(n.toDer(E)),O.finish(),I=O.output.getBytes();var q=D(C,s,d,B);p=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(N.pkcs5PBES2).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(N.pkcs5PBKDF2).getBytes()),q]),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(c).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,L)])])])}else if(y.algorithm==="3des"){d=24;var M=new a.util.ByteBuffer(C),V=v.pbe.generatePkcs12Key(u,M,1,g,d),L=v.pbe.generatePkcs12Key(u,M,2,g,d),O=a.des.createEncryptionCipher(V);O.start(L),O.update(n.toDer(E)),O.finish(),I=O.output.getBytes(),p=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(N["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,C),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,s.getBytes())])])}else{var r=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw r.algorithm=y.algorithm,r}var H=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[p,n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,I)]);return H},v.decryptPrivateKeyInfo=function(E,u){var y=null,C={},g=[];if(!n.validate(E,S,C,g)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=g,s}var d=n.derToOid(C.encryptionOid),p=v.pbe.getCipher(d,C.encryptionParams,u),I=a.util.createBuffer(C.encryptedData);return p.update(I),p.finish()&&(y=n.fromDer(p.output)),y},v.encryptedPrivateKeyToPem=function(E,u){var y={type:"ENCRYPTED PRIVATE KEY",body:n.toDer(E).getBytes()};return a.pem.encode(y,{maxline:u})},v.encryptedPrivateKeyFromPem=function(E){var u=a.pem.decode(E)[0];if(u.type!=="ENCRYPTED PRIVATE KEY"){var y=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw y.headerType=u.type,y}if(u.procType&&u.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return n.fromDer(u.body)},v.encryptRsaPrivateKey=function(E,u,y){if(y=y||{},!y.legacy){var C=v.wrapRsaPrivateKey(v.privateKeyToAsn1(E));return C=v.encryptPrivateKeyInfo(C,u,y),v.encryptedPrivateKeyToPem(C)}var g,s,d,p;switch(y.algorithm){case"aes128":g="AES-128-CBC",d=16,s=a.random.getBytesSync(16),p=a.aes.createEncryptionCipher;break;case"aes192":g="AES-192-CBC",d=24,s=a.random.getBytesSync(16),p=a.aes.createEncryptionCipher;break;case"aes256":g="AES-256-CBC",d=32,s=a.random.getBytesSync(16),p=a.aes.createEncryptionCipher;break;case"3des":g="DES-EDE3-CBC",d=24,s=a.random.getBytesSync(8),p=a.des.createEncryptionCipher;break;case"des":g="DES-CBC",d=8,s=a.random.getBytesSync(8),p=a.des.createEncryptionCipher;break;default:var I=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+y.algorithm+'".');throw I.algorithm=y.algorithm,I}var R=a.pbe.opensslDeriveBytes(u,s.substr(0,8),d),c=p(R);c.start(s),c.update(n.toDer(v.privateKeyToAsn1(E))),c.finish();var i={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:g,parameters:a.util.bytesToHex(s).toUpperCase()},body:c.output.getBytes()};return a.pem.encode(i)},v.decryptRsaPrivateKey=function(E,u){var y=null,C=a.pem.decode(E)[0];if(C.type!=="ENCRYPTED PRIVATE KEY"&&C.type!=="PRIVATE KEY"&&C.type!=="RSA PRIVATE KEY"){var g=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw g.headerType=g,g}if(C.procType&&C.procType.type==="ENCRYPTED"){var s,d;switch(C.dekInfo.algorithm){case"DES-CBC":s=8,d=a.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,d=a.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,d=a.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,d=a.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,d=a.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,d=function(i){return a.rc2.createDecryptionCipher(i,40)};break;case"RC2-64-CBC":s=8,d=function(i){return a.rc2.createDecryptionCipher(i,64)};break;case"RC2-128-CBC":s=16,d=function(i){return a.rc2.createDecryptionCipher(i,128)};break;default:var g=new Error('Could not decrypt private key; unsupported encryption algorithm "'+C.dekInfo.algorithm+'".');throw g.algorithm=C.dekInfo.algorithm,g}var p=a.util.hexToBytes(C.dekInfo.parameters),I=a.pbe.opensslDeriveBytes(u,p.substr(0,8),s),R=d(I);if(R.start(p),R.update(a.util.createBuffer(C.body)),R.finish())y=R.output.getBytes();else return y}else y=C.body;return C.type==="ENCRYPTED PRIVATE KEY"?y=v.decryptPrivateKeyInfo(n.fromDer(y),u):y=n.fromDer(y),y!==null&&(y=v.privateKeyFromAsn1(y)),y},v.pbe.generatePkcs12Key=function(E,u,y,C,g,s){var d,p;if(typeof s>"u"||s===null){if(!("sha1"in a.md))throw new Error('"sha1" hash algorithm unavailable.');s=a.md.sha1.create()}var I=s.digestLength,R=s.blockLength,c=new a.util.ByteBuffer,i=new a.util.ByteBuffer;if(E!=null){for(p=0;p<E.length;p++)i.putInt16(E.charCodeAt(p));i.putInt16(0)}var r=i.length(),B=u.length(),k=new a.util.ByteBuffer;k.fillWithByte(y,R);var V=R*Math.ceil(B/R),L=new a.util.ByteBuffer;for(p=0;p<V;p++)L.putByte(u.at(p%B));var O=R*Math.ceil(r/R),q=new a.util.ByteBuffer;for(p=0;p<O;p++)q.putByte(i.at(p%r));var M=L;M.putBuffer(q);for(var H=Math.ceil(g/I),Y=1;Y<=H;Y++){var j=new a.util.ByteBuffer;j.putBytes(k.bytes()),j.putBytes(M.bytes());for(var $=0;$<C;$++)s.start(),s.update(j.getBytes()),j=s.digest();var ne=new a.util.ByteBuffer;for(p=0;p<R;p++)ne.putByte(j.at(p%I));var se=Math.ceil(B/R)+Math.ceil(r/R),he=new a.util.ByteBuffer;for(d=0;d<se;d++){var ge=new a.util.ByteBuffer(M.getBytes(R)),W=511;for(p=ne.length()-1;p>=0;p--)W=W>>8,W+=ne.at(p)+ge.at(p),ge.setAt(p,W&255);he.putBuffer(ge)}M=he,c.putBuffer(j)}return c.truncate(c.length()-g),c},v.pbe.getCipher=function(E,u,y){switch(E){case v.oids.pkcs5PBES2:return v.pbe.getCipherForPBES2(E,u,y);case v.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case v.oids["pbewithSHAAnd40BitRC2-CBC"]:return v.pbe.getCipherForPKCS12PBE(E,u,y);default:var C=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw C.oid=E,C.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],C}},v.pbe.getCipherForPBES2=function(E,u,y){var C={},g=[];if(!n.validate(u,h,C,g)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=g,s}if(E=n.derToOid(C.kdfOid),E!==v.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=E,s.supportedOids=["pkcs5PBKDF2"],s}if(E=n.derToOid(C.encOid),E!==v.oids["aes128-CBC"]&&E!==v.oids["aes192-CBC"]&&E!==v.oids["aes256-CBC"]&&E!==v.oids["des-EDE3-CBC"]&&E!==v.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=E,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var d=C.kdfSalt,p=a.util.createBuffer(C.kdfIterationCount);p=p.getInt(p.length()<<3);var I,R;switch(v.oids[E]){case"aes128-CBC":I=16,R=a.aes.createDecryptionCipher;break;case"aes192-CBC":I=24,R=a.aes.createDecryptionCipher;break;case"aes256-CBC":I=32,R=a.aes.createDecryptionCipher;break;case"des-EDE3-CBC":I=24,R=a.des.createDecryptionCipher;break;case"desCBC":I=8,R=a.des.createDecryptionCipher;break}var c=f(C.prfOid),i=a.pkcs5.pbkdf2(y,d,p,I,c),r=C.encIv,B=R(i);return B.start(r),B},v.pbe.getCipherForPKCS12PBE=function(E,u,y){var C={},g=[];if(!n.validate(u,t,C,g)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=g,s}var d=a.util.createBuffer(C.salt),p=a.util.createBuffer(C.iterations);p=p.getInt(p.length()<<3);var I,R,c;switch(E){case v.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:I=24,R=8,c=a.des.startDecrypting;break;case v.oids["pbewithSHAAnd40BitRC2-CBC"]:I=5,R=8,c=function(V,L){var O=a.rc2.createDecryptionCipher(V,40);return O.start(L,null),O};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=E,s}var i=f(C.prfOid),r=v.pbe.generatePkcs12Key(y,d,1,p,I,i);i.start();var B=v.pbe.generatePkcs12Key(y,d,2,p,R,i);return c(r,B)},v.pbe.opensslDeriveBytes=function(E,u,y,C){if(typeof C>"u"||C===null){if(!("md5"in a.md))throw new Error('"md5" hash algorithm unavailable.');C=a.md.md5.create()}u===null&&(u="");for(var g=[m(C,E+u)],s=16,d=1;s<y;++d,s+=16)g.push(m(C,g[d-1]+E+u));return g.join("").substr(0,y)};function m(E,u){return E.start().update(u).digest().getBytes()}function f(E){var u;if(!E)u="hmacWithSHA1";else if(u=v.oids[n.derToOid(E)],!u){var y=new Error("Unsupported PRF OID.");throw y.oid=E,y.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],y}return x(u)}function x(E){var u=a.md;switch(E){case"hmacWithSHA224":u=a.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":E=E.substr(8).toLowerCase();break;default:var y=new Error("Unsupported PRF algorithm.");throw y.algorithm=E,y.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],y}if(!u||!(E in u))throw new Error("Unknown hash algorithm: "+E);return u[E].create()}function D(E,u,y,C){var g=n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OCTETSTRING,!1,E),n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,u.getBytes())]);return C!=="hmacWithSHA1"&&g.value.push(n.create(n.Class.UNIVERSAL,n.Type.INTEGER,!1,a.util.hexToBytes(y.toString(16))),n.create(n.Class.UNIVERSAL,n.Type.SEQUENCE,!0,[n.create(n.Class.UNIVERSAL,n.Type.OID,!1,n.oidToDer(v.oids[C]).getBytes()),n.create(n.Class.UNIVERSAL,n.Type.NULL,!1,"")])),g}return $t}var Jt={exports:{}},er={exports:{}},Qr;function ma(){if(Qr)return er.exports;Qr=1;var a=le();tt(),de();var e=a.asn1,n=er.exports=a.pkcs7asn1=a.pkcs7asn1||{};a.pkcs7=a.pkcs7||{},a.pkcs7.asn1=n;var v={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};n.contentInfoValidator=v;var N={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};n.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(N)},n.encryptedDataValidator={name:"EncryptedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(N)};var S={name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};return n.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},v,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[S]}]},n.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]},er.exports}var tr={exports:{}},rr={exports:{}},zr;function Ca(){if(zr)return rr.exports;zr=1;var a=le();de(),a.mgf=a.mgf||{};var e=rr.exports=a.mgf.mgf1=a.mgf1=a.mgf1||{};return e.create=function(n){var v={generate:function(N,S){for(var h=new a.util.ByteBuffer,t=Math.ceil(S/n.digestLength),m=0;m<t;m++){var f=new a.util.ByteBuffer;f.putInt32(m),n.start(),n.update(N+f.getBytes()),h.putBuffer(n.digest())}return h.truncate(h.length()-S),h.getBytes()}};return v},rr.exports}var ar,Yr;function Ja(){if(Yr)return ar;Yr=1;var a=le();return Ca(),ar=a.mgf=a.mgf||{},a.mgf.mgf1=a.mgf1,ar}var nr={exports:{}},Xr;function mr(){if(Xr)return nr.exports;Xr=1;var a=le();Je(),de();var e=nr.exports=a.pss=a.pss||{};return e.create=function(n){arguments.length===3&&(n={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var v=n.md,N=n.mgf,S=v.digestLength,h=n.salt||null;typeof h=="string"&&(h=a.util.createBuffer(h));var t;if("saltLength"in n)t=n.saltLength;else if(h!==null)t=h.length();else throw new Error("Salt length not specified or specific salt not given.");if(h!==null&&h.length()!==t)throw new Error("Given salt length does not match length of given salt.");var m=n.prng||a.random,f={};return f.encode=function(x,D){var E,u=D-1,y=Math.ceil(u/8),C=x.digest().getBytes();if(y<S+t+2)throw new Error("Message is too long to encrypt.");var g;h===null?g=m.getBytesSync(t):g=h.bytes();var s=new a.util.ByteBuffer;s.fillWithByte(0,8),s.putBytes(C),s.putBytes(g),v.start(),v.update(s.getBytes());var d=v.digest().getBytes(),p=new a.util.ByteBuffer;p.fillWithByte(0,y-t-S-2),p.putByte(1),p.putBytes(g);var I=p.getBytes(),R=y-S-1,c=N.generate(d,R),i="";for(E=0;E<R;E++)i+=String.fromCharCode(I.charCodeAt(E)^c.charCodeAt(E));var r=65280>>8*y-u&255;return i=String.fromCharCode(i.charCodeAt(0)&~r)+i.substr(1),i+d+"¼"},f.verify=function(x,D,E){var u,y=E-1,C=Math.ceil(y/8);if(D=D.substr(-C),C<S+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(D.charCodeAt(C-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var g=C-S-1,s=D.substr(0,g),d=D.substr(g,S),p=65280>>8*C-y&255;if((s.charCodeAt(0)&p)!==0)throw new Error("Bits beyond keysize not zero as expected.");var I=N.generate(d,g),R="";for(u=0;u<g;u++)R+=String.fromCharCode(s.charCodeAt(u)^I.charCodeAt(u));R=String.fromCharCode(R.charCodeAt(0)&~p)+R.substr(1);var c=C-S-t-2;for(u=0;u<c;u++)if(R.charCodeAt(u)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(c)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var i=R.substr(-t),r=new a.util.ByteBuffer;r.fillWithByte(0,8),r.putBytes(x),r.putBytes(i),v.start(),v.update(r.getBytes());var B=v.digest().getBytes();return d===B},f},nr.exports}var jr;function Cr(){if(jr)return tr.exports;jr=1;var a=le();ut(),tt(),It(),nt(),Ja(),lt(),ht(),mr(),Bt(),de();var e=a.asn1,n=tr.exports=a.pki=a.pki||{},v=n.oids,N={};N.CN=v.commonName,N.commonName="CN",N.C=v.countryName,N.countryName="C",N.L=v.localityName,N.localityName="L",N.ST=v.stateOrProvinceName,N.stateOrProvinceName="ST",N.O=v.organizationName,N.organizationName="O",N.OU=v.organizationalUnitName,N.organizationalUnitName="OU",N.E=v.emailAddress,N.emailAddress="E";var S=a.pki.rsa.publicKeyValidator,h={name:"Certificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:e.Class.UNIVERSAL,type:e.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:e.Class.UNIVERSAL,type:e.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},S,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},t={name:"rsapss",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:e.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:e.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:e.Class.UNIVERSAL,type:e.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},m={name:"CertificationRequestInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},S,{name:"CertificationRequestInfo.attributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0}]}]}]},f={name:"CertificationRequest",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[m,{name:"CertificationRequest.signatureAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};n.RDNAttributesAsArray=function(c,i){for(var r=[],B,k,V,L=0;L<c.value.length;++L){B=c.value[L];for(var O=0;O<B.value.length;++O)V={},k=B.value[O],V.type=e.derToOid(k.value[0].value),V.value=k.value[1].value,V.valueTagClass=k.value[1].type,V.type in v&&(V.name=v[V.type],V.name in N&&(V.shortName=N[V.name])),i&&(i.update(V.type),i.update(V.value)),r.push(V)}return r},n.CRIAttributesAsArray=function(c){for(var i=[],r=0;r<c.length;++r)for(var B=c[r],k=e.derToOid(B.value[0].value),V=B.value[1].value,L=0;L<V.length;++L){var O={};if(O.type=k,O.value=V[L].value,O.valueTagClass=V[L].type,O.type in v&&(O.name=v[O.type],O.name in N&&(O.shortName=N[O.name])),O.type===v.extensionRequest){O.extensions=[];for(var q=0;q<O.value.length;++q)O.extensions.push(n.certificateExtensionFromAsn1(O.value[q]))}i.push(O)}return i};function x(c,i){typeof i=="string"&&(i={shortName:i});for(var r=null,B,k=0;r===null&&k<c.attributes.length;++k)B=c.attributes[k],(i.type&&i.type===B.type||i.name&&i.name===B.name||i.shortName&&i.shortName===B.shortName)&&(r=B);return r}var D=function(c,i,r){var B={};if(c!==v["RSASSA-PSS"])return B;r&&(B={hash:{algorithmOid:v.sha1},mgf:{algorithmOid:v.mgf1,hash:{algorithmOid:v.sha1}},saltLength:20});var k={},V=[];if(!e.validate(i,t,k,V)){var L=new Error("Cannot read RSASSA-PSS parameter block.");throw L.errors=V,L}return k.hashOid!==void 0&&(B.hash=B.hash||{},B.hash.algorithmOid=e.derToOid(k.hashOid)),k.maskGenOid!==void 0&&(B.mgf=B.mgf||{},B.mgf.algorithmOid=e.derToOid(k.maskGenOid),B.mgf.hash=B.mgf.hash||{},B.mgf.hash.algorithmOid=e.derToOid(k.maskGenHashOid)),k.saltLength!==void 0&&(B.saltLength=k.saltLength.charCodeAt(0)),B},E=function(c){switch(v[c.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return a.md.sha1.create();case"md5WithRSAEncryption":return a.md.md5.create();case"sha256WithRSAEncryption":return a.md.sha256.create();case"sha384WithRSAEncryption":return a.md.sha384.create();case"sha512WithRSAEncryption":return a.md.sha512.create();case"RSASSA-PSS":return a.md.sha256.create();default:var i=new Error("Could not compute "+c.type+" digest. Unknown signature OID.");throw i.signatureOid=c.signatureOid,i}},u=function(c){var i=c.certificate,r;switch(i.signatureOid){case v.sha1WithRSAEncryption:case v.sha1WithRSASignature:break;case v["RSASSA-PSS"]:var B,k;if(B=v[i.signatureParameters.mgf.hash.algorithmOid],B===void 0||a.md[B]===void 0){var V=new Error("Unsupported MGF hash function.");throw V.oid=i.signatureParameters.mgf.hash.algorithmOid,V.name=B,V}if(k=v[i.signatureParameters.mgf.algorithmOid],k===void 0||a.mgf[k]===void 0){var V=new Error("Unsupported MGF function.");throw V.oid=i.signatureParameters.mgf.algorithmOid,V.name=k,V}if(k=a.mgf[k].create(a.md[B].create()),B=v[i.signatureParameters.hash.algorithmOid],B===void 0||a.md[B]===void 0){var V=new Error("Unsupported RSASSA-PSS hash function.");throw V.oid=i.signatureParameters.hash.algorithmOid,V.name=B,V}r=a.pss.create(a.md[B].create(),k,i.signatureParameters.saltLength);break}return i.publicKey.verify(c.md.digest().getBytes(),c.signature,r)};n.certificateFromPem=function(c,i,r){var B=a.pem.decode(c)[0];if(B.type!=="CERTIFICATE"&&B.type!=="X509 CERTIFICATE"&&B.type!=="TRUSTED CERTIFICATE"){var k=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw k.headerType=B.type,k}if(B.procType&&B.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var V=e.fromDer(B.body,r);return n.certificateFromAsn1(V,i)},n.certificateToPem=function(c,i){var r={type:"CERTIFICATE",body:e.toDer(n.certificateToAsn1(c)).getBytes()};return a.pem.encode(r,{maxline:i})},n.publicKeyFromPem=function(c){var i=a.pem.decode(c)[0];if(i.type!=="PUBLIC KEY"&&i.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=i.type,r}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var B=e.fromDer(i.body);return n.publicKeyFromAsn1(B)},n.publicKeyToPem=function(c,i){var r={type:"PUBLIC KEY",body:e.toDer(n.publicKeyToAsn1(c)).getBytes()};return a.pem.encode(r,{maxline:i})},n.publicKeyToRSAPublicKeyPem=function(c,i){var r={type:"RSA PUBLIC KEY",body:e.toDer(n.publicKeyToRSAPublicKey(c)).getBytes()};return a.pem.encode(r,{maxline:i})},n.getPublicKeyFingerprint=function(c,i){i=i||{};var r=i.md||a.md.sha1.create(),B=i.type||"RSAPublicKey",k;switch(B){case"RSAPublicKey":k=e.toDer(n.publicKeyToRSAPublicKey(c)).getBytes();break;case"SubjectPublicKeyInfo":k=e.toDer(n.publicKeyToAsn1(c)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+i.type+'".')}r.start(),r.update(k);var V=r.digest();if(i.encoding==="hex"){var L=V.toHex();return i.delimiter?L.match(/.{2}/g).join(i.delimiter):L}else{if(i.encoding==="binary")return V.getBytes();if(i.encoding)throw new Error('Unknown encoding "'+i.encoding+'".')}return V},n.certificationRequestFromPem=function(c,i,r){var B=a.pem.decode(c)[0];if(B.type!=="CERTIFICATE REQUEST"){var k=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw k.headerType=B.type,k}if(B.procType&&B.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var V=e.fromDer(B.body,r);return n.certificationRequestFromAsn1(V,i)},n.certificationRequestToPem=function(c,i){var r={type:"CERTIFICATE REQUEST",body:e.toDer(n.certificationRequestToAsn1(c)).getBytes()};return a.pem.encode(r,{maxline:i})},n.createCertificate=function(){var c={};return c.version=2,c.serialNumber="00",c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.validity={},c.validity.notBefore=new Date,c.validity.notAfter=new Date,c.issuer={},c.issuer.getField=function(i){return x(c.issuer,i)},c.issuer.addField=function(i){C([i]),c.issuer.attributes.push(i)},c.issuer.attributes=[],c.issuer.hash=null,c.subject={},c.subject.getField=function(i){return x(c.subject,i)},c.subject.addField=function(i){C([i]),c.subject.attributes.push(i)},c.subject.attributes=[],c.subject.hash=null,c.extensions=[],c.publicKey=null,c.md=null,c.setSubject=function(i,r){C(i),c.subject.attributes=i,delete c.subject.uniqueId,r&&(c.subject.uniqueId=r),c.subject.hash=null},c.setIssuer=function(i,r){C(i),c.issuer.attributes=i,delete c.issuer.uniqueId,r&&(c.issuer.uniqueId=r),c.issuer.hash=null},c.setExtensions=function(i){for(var r=0;r<i.length;++r)g(i[r],{cert:c});c.extensions=i},c.getExtension=function(i){typeof i=="string"&&(i={name:i});for(var r=null,B,k=0;r===null&&k<c.extensions.length;++k)B=c.extensions[k],(i.id&&B.id===i.id||i.name&&B.name===i.name)&&(r=B);return r},c.sign=function(i,r){c.md=r||a.md.sha1.create();var B=v[c.md.algorithm+"WithRSAEncryption"];if(!B){var k=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw k.algorithm=c.md.algorithm,k}c.signatureOid=c.siginfo.algorithmOid=B,c.tbsCertificate=n.getTBSCertificate(c);var V=e.toDer(c.tbsCertificate);c.md.update(V.getBytes()),c.signature=i.sign(c.md)},c.verify=function(i){var r=!1;if(!c.issued(i)){var B=i.issuer,k=c.subject,V=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw V.expectedIssuer=k.attributes,V.actualIssuer=B.attributes,V}var L=i.md;if(L===null){L=E({signatureOid:i.signatureOid,type:"certificate"});var O=i.tbsCertificate||n.getTBSCertificate(i),q=e.toDer(O);L.update(q.getBytes())}return L!==null&&(r=u({certificate:c,md:L,signature:i.signature})),r},c.isIssuer=function(i){var r=!1,B=c.issuer,k=i.subject;if(B.hash&&k.hash)r=B.hash===k.hash;else if(B.attributes.length===k.attributes.length){r=!0;for(var V,L,O=0;r&&O<B.attributes.length;++O)V=B.attributes[O],L=k.attributes[O],(V.type!==L.type||V.value!==L.value)&&(r=!1)}return r},c.issued=function(i){return i.isIssuer(c)},c.generateSubjectKeyIdentifier=function(){return n.getPublicKeyFingerprint(c.publicKey,{type:"RSAPublicKey"})},c.verifySubjectKeyIdentifier=function(){for(var i=v.subjectKeyIdentifier,r=0;r<c.extensions.length;++r){var B=c.extensions[r];if(B.id===i){var k=c.generateSubjectKeyIdentifier().getBytes();return a.util.hexToBytes(B.subjectKeyIdentifier)===k}}return!1},c},n.certificateFromAsn1=function(c,i){var r={},B=[];if(!e.validate(c,h,r,B)){var k=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw k.errors=B,k}var V=e.derToOid(r.publicKeyOid);if(V!==n.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var L=n.createCertificate();L.version=r.certVersion?r.certVersion.charCodeAt(0):0;var O=a.util.createBuffer(r.certSerialNumber);L.serialNumber=O.toHex(),L.signatureOid=a.asn1.derToOid(r.certSignatureOid),L.signatureParameters=D(L.signatureOid,r.certSignatureParams,!0),L.siginfo.algorithmOid=a.asn1.derToOid(r.certinfoSignatureOid),L.siginfo.parameters=D(L.siginfo.algorithmOid,r.certinfoSignatureParams,!1),L.signature=r.certSignature;var q=[];if(r.certValidity1UTCTime!==void 0&&q.push(e.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&q.push(e.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&q.push(e.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&q.push(e.generalizedTimeToDate(r.certValidity4GeneralizedTime)),q.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(q.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(L.validity.notBefore=q[0],L.validity.notAfter=q[1],L.tbsCertificate=r.tbsCertificate,i){L.md=E({signatureOid:L.signatureOid,type:"certificate"});var M=e.toDer(L.tbsCertificate);L.md.update(M.getBytes())}var H=a.md.sha1.create(),Y=e.toDer(r.certIssuer);H.update(Y.getBytes()),L.issuer.getField=function(ne){return x(L.issuer,ne)},L.issuer.addField=function(ne){C([ne]),L.issuer.attributes.push(ne)},L.issuer.attributes=n.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(L.issuer.uniqueId=r.certIssuerUniqueId),L.issuer.hash=H.digest().toHex();var j=a.md.sha1.create(),$=e.toDer(r.certSubject);return j.update($.getBytes()),L.subject.getField=function(ne){return x(L.subject,ne)},L.subject.addField=function(ne){C([ne]),L.subject.attributes.push(ne)},L.subject.attributes=n.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(L.subject.uniqueId=r.certSubjectUniqueId),L.subject.hash=j.digest().toHex(),r.certExtensions?L.extensions=n.certificateExtensionsFromAsn1(r.certExtensions):L.extensions=[],L.publicKey=n.publicKeyFromAsn1(r.subjectPublicKeyInfo),L},n.certificateExtensionsFromAsn1=function(c){for(var i=[],r=0;r<c.value.length;++r)for(var B=c.value[r],k=0;k<B.value.length;++k)i.push(n.certificateExtensionFromAsn1(B.value[k]));return i},n.certificateExtensionFromAsn1=function(c){var i={};if(i.id=e.derToOid(c.value[0].value),i.critical=!1,c.value[1].type===e.Type.BOOLEAN?(i.critical=c.value[1].value.charCodeAt(0)!==0,i.value=c.value[2].value):i.value=c.value[1].value,i.id in v){if(i.name=v[i.id],i.name==="keyUsage"){var r=e.fromDer(i.value),B=0,k=0;r.value.length>1&&(B=r.value.charCodeAt(1),k=r.value.length>2?r.value.charCodeAt(2):0),i.digitalSignature=(B&128)===128,i.nonRepudiation=(B&64)===64,i.keyEncipherment=(B&32)===32,i.dataEncipherment=(B&16)===16,i.keyAgreement=(B&8)===8,i.keyCertSign=(B&4)===4,i.cRLSign=(B&2)===2,i.encipherOnly=(B&1)===1,i.decipherOnly=(k&128)===128}else if(i.name==="basicConstraints"){var r=e.fromDer(i.value);r.value.length>0&&r.value[0].type===e.Type.BOOLEAN?i.cA=r.value[0].value.charCodeAt(0)!==0:i.cA=!1;var V=null;r.value.length>0&&r.value[0].type===e.Type.INTEGER?V=r.value[0].value:r.value.length>1&&(V=r.value[1].value),V!==null&&(i.pathLenConstraint=e.derToInteger(V))}else if(i.name==="extKeyUsage")for(var r=e.fromDer(i.value),L=0;L<r.value.length;++L){var O=e.derToOid(r.value[L].value);O in v?i[v[O]]=!0:i[O]=!0}else if(i.name==="nsCertType"){var r=e.fromDer(i.value),B=0;r.value.length>1&&(B=r.value.charCodeAt(1)),i.client=(B&128)===128,i.server=(B&64)===64,i.email=(B&32)===32,i.objsign=(B&16)===16,i.reserved=(B&8)===8,i.sslCA=(B&4)===4,i.emailCA=(B&2)===2,i.objCA=(B&1)===1}else if(i.name==="subjectAltName"||i.name==="issuerAltName"){i.altNames=[];for(var q,r=e.fromDer(i.value),M=0;M<r.value.length;++M){q=r.value[M];var H={type:q.type,value:q.value};switch(i.altNames.push(H),q.type){case 1:case 2:case 6:break;case 7:H.ip=a.util.bytesToIP(q.value);break;case 8:H.oid=e.derToOid(q.value);break}}}else if(i.name==="subjectKeyIdentifier"){var r=e.fromDer(i.value);i.subjectKeyIdentifier=a.util.bytesToHex(r.value)}}return i},n.certificationRequestFromAsn1=function(c,i){var r={},B=[];if(!e.validate(c,f,r,B)){var k=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw k.errors=B,k}var V=e.derToOid(r.publicKeyOid);if(V!==n.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var L=n.createCertificationRequest();if(L.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,L.signatureOid=a.asn1.derToOid(r.csrSignatureOid),L.signatureParameters=D(L.signatureOid,r.csrSignatureParams,!0),L.siginfo.algorithmOid=a.asn1.derToOid(r.csrSignatureOid),L.siginfo.parameters=D(L.siginfo.algorithmOid,r.csrSignatureParams,!1),L.signature=r.csrSignature,L.certificationRequestInfo=r.certificationRequestInfo,i){L.md=E({signatureOid:L.signatureOid,type:"certification request"});var O=e.toDer(L.certificationRequestInfo);L.md.update(O.getBytes())}var q=a.md.sha1.create();return L.subject.getField=function(M){return x(L.subject,M)},L.subject.addField=function(M){C([M]),L.subject.attributes.push(M)},L.subject.attributes=n.RDNAttributesAsArray(r.certificationRequestInfoSubject,q),L.subject.hash=q.digest().toHex(),L.publicKey=n.publicKeyFromAsn1(r.subjectPublicKeyInfo),L.getAttribute=function(M){return x(L,M)},L.addAttribute=function(M){C([M]),L.attributes.push(M)},L.attributes=n.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),L},n.createCertificationRequest=function(){var c={};return c.version=0,c.signatureOid=null,c.signature=null,c.siginfo={},c.siginfo.algorithmOid=null,c.subject={},c.subject.getField=function(i){return x(c.subject,i)},c.subject.addField=function(i){C([i]),c.subject.attributes.push(i)},c.subject.attributes=[],c.subject.hash=null,c.publicKey=null,c.attributes=[],c.getAttribute=function(i){return x(c,i)},c.addAttribute=function(i){C([i]),c.attributes.push(i)},c.md=null,c.setSubject=function(i){C(i),c.subject.attributes=i,c.subject.hash=null},c.setAttributes=function(i){C(i),c.attributes=i},c.sign=function(i,r){c.md=r||a.md.sha1.create();var B=v[c.md.algorithm+"WithRSAEncryption"];if(!B){var k=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw k.algorithm=c.md.algorithm,k}c.signatureOid=c.siginfo.algorithmOid=B,c.certificationRequestInfo=n.getCertificationRequestInfo(c);var V=e.toDer(c.certificationRequestInfo);c.md.update(V.getBytes()),c.signature=i.sign(c.md)},c.verify=function(){var i=!1,r=c.md;if(r===null){r=E({signatureOid:c.signatureOid,type:"certification request"});var B=c.certificationRequestInfo||n.getCertificationRequestInfo(c),k=e.toDer(B);r.update(k.getBytes())}return r!==null&&(i=u({certificate:c,md:r,signature:c.signature})),i},c};function y(c){for(var i=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),r,B,k=c.attributes,V=0;V<k.length;++V){r=k[V];var L=r.value,O=e.Type.PRINTABLESTRING;"valueTagClass"in r&&(O=r.valueTagClass,O===e.Type.UTF8&&(L=a.util.encodeUtf8(L))),B=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(r.type).getBytes()),e.create(e.Class.UNIVERSAL,O,!1,L)])]),i.value.push(B)}return i}function C(c){for(var i,r=0;r<c.length;++r){if(i=c[r],typeof i.name>"u"&&(i.type&&i.type in n.oids?i.name=n.oids[i.type]:i.shortName&&i.shortName in N&&(i.name=n.oids[N[i.shortName]])),typeof i.type>"u")if(i.name&&i.name in n.oids)i.type=n.oids[i.name];else{var B=new Error("Attribute type not specified.");throw B.attribute=i,B}if(typeof i.shortName>"u"&&i.name&&i.name in N&&(i.shortName=N[i.name]),i.type===v.extensionRequest&&(i.valueConstructed=!0,i.valueTagClass=e.Type.SEQUENCE,!i.value&&i.extensions)){i.value=[];for(var k=0;k<i.extensions.length;++k)i.value.push(n.certificateExtensionToAsn1(g(i.extensions[k])))}if(typeof i.value>"u"){var B=new Error("Attribute value not specified.");throw B.attribute=i,B}}}function g(c,i){if(i=i||{},typeof c.name>"u"&&c.id&&c.id in n.oids&&(c.name=n.oids[c.id]),typeof c.id>"u")if(c.name&&c.name in n.oids)c.id=n.oids[c.name];else{var r=new Error("Extension ID not specified.");throw r.extension=c,r}if(typeof c.value<"u")return c;if(c.name==="keyUsage"){var B=0,k=0,V=0;c.digitalSignature&&(k|=128,B=7),c.nonRepudiation&&(k|=64,B=6),c.keyEncipherment&&(k|=32,B=5),c.dataEncipherment&&(k|=16,B=4),c.keyAgreement&&(k|=8,B=3),c.keyCertSign&&(k|=4,B=2),c.cRLSign&&(k|=2,B=1),c.encipherOnly&&(k|=1,B=0),c.decipherOnly&&(V|=128,B=7);var L=String.fromCharCode(B);V!==0?L+=String.fromCharCode(k)+String.fromCharCode(V):k!==0&&(L+=String.fromCharCode(k)),c.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,L)}else if(c.name==="basicConstraints")c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),c.cA&&c.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"ÿ")),"pathLenConstraint"in c&&c.value.value.push(e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.pathLenConstraint).getBytes()));else if(c.name==="extKeyUsage"){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var O=c.value.value;for(var q in c)c[q]===!0&&(q in v?O.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(v[q]).getBytes())):q.indexOf(".")!==-1&&O.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(q).getBytes())))}else if(c.name==="nsCertType"){var B=0,k=0;c.client&&(k|=128,B=7),c.server&&(k|=64,B=6),c.email&&(k|=32,B=5),c.objsign&&(k|=16,B=4),c.reserved&&(k|=8,B=3),c.sslCA&&(k|=4,B=2),c.emailCA&&(k|=2,B=1),c.objCA&&(k|=1,B=0);var L=String.fromCharCode(B);k!==0&&(L+=String.fromCharCode(k)),c.value=e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,L)}else if(c.name==="subjectAltName"||c.name==="issuerAltName"){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var M,H=0;H<c.altNames.length;++H){M=c.altNames[H];var L=M.value;if(M.type===7&&M.ip){if(L=a.util.bytesFromIP(M.ip),L===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=c,r}}else M.type===8&&(M.oid?L=e.oidToDer(e.oidToDer(M.oid)):L=e.oidToDer(L));c.value.value.push(e.create(e.Class.CONTEXT_SPECIFIC,M.type,!1,L))}}else if(c.name==="nsComment"&&i.cert){if(!/^[\x00-\x7F]*$/.test(c.comment)||c.comment.length<1||c.comment.length>128)throw new Error('Invalid "nsComment" content.');c.value=e.create(e.Class.UNIVERSAL,e.Type.IA5STRING,!1,c.comment)}else if(c.name==="subjectKeyIdentifier"&&i.cert){var Y=i.cert.generateSubjectKeyIdentifier();c.subjectKeyIdentifier=Y.toHex(),c.value=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,Y.getBytes())}else if(c.name==="authorityKeyIdentifier"&&i.cert){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);var O=c.value.value;if(c.keyIdentifier){var j=c.keyIdentifier===!0?i.cert.generateSubjectKeyIdentifier().getBytes():c.keyIdentifier;O.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!1,j))}if(c.authorityCertIssuer){var $=[e.create(e.Class.CONTEXT_SPECIFIC,4,!0,[y(c.authorityCertIssuer===!0?i.cert.issuer:c.authorityCertIssuer)])];O.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,$))}if(c.serialNumber){var ne=a.util.hexToBytes(c.serialNumber===!0?i.cert.serialNumber:c.serialNumber);O.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!1,ne))}}else if(c.name==="cRLDistributionPoints"){c.value=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);for(var O=c.value.value,se=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]),he=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]),M,H=0;H<c.altNames.length;++H){M=c.altNames[H];var L=M.value;if(M.type===7&&M.ip){if(L=a.util.bytesFromIP(M.ip),L===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=c,r}}else M.type===8&&(M.oid?L=e.oidToDer(e.oidToDer(M.oid)):L=e.oidToDer(L));he.value.push(e.create(e.Class.CONTEXT_SPECIFIC,M.type,!1,L))}se.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[he])),O.push(se)}if(typeof c.value>"u"){var r=new Error("Extension value not specified.");throw r.extension=c,r}return c}function s(c,i){switch(c){case v["RSASSA-PSS"]:var r=[];return i.hash.algorithmOid!==void 0&&r.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])),i.mgf.algorithmOid!==void 0&&r.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.mgf.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(i.mgf.hash.algorithmOid).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])])])),i.saltLength!==void 0&&r.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(i.saltLength).getBytes())])),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,r);default:return e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")}}function d(c){var i=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);if(c.attributes.length===0)return i;for(var r=c.attributes,B=0;B<r.length;++B){var k=r[B],V=k.value,L=e.Type.UTF8;"valueTagClass"in k&&(L=k.valueTagClass),L===e.Type.UTF8&&(V=a.util.encodeUtf8(V));var O=!1;"valueConstructed"in k&&(O=k.valueConstructed);var q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(k.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,L,O,V)])]);i.value.push(q)}return i}var p=new Date("1950-01-01T00:00:00Z"),I=new Date("2050-01-01T00:00:00Z");function R(c){return c>=p&&c<I?e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(c)):e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(c))}return n.getTBSCertificate=function(c){var i=R(c.validity.notBefore),r=R(c.validity.notAfter),B=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.version).getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,a.util.hexToBytes(c.serialNumber)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.siginfo.algorithmOid).getBytes()),s(c.siginfo.algorithmOid,c.siginfo.parameters)]),y(c.issuer),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[i,r]),y(c.subject),n.publicKeyToAsn1(c.publicKey)]);return c.issuer.uniqueId&&B.value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.issuer.uniqueId)])),c.subject.uniqueId&&B.value.push(e.create(e.Class.CONTEXT_SPECIFIC,2,!0,[e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.subject.uniqueId)])),c.extensions.length>0&&B.value.push(n.certificateExtensionsToAsn1(c.extensions)),B},n.getCertificationRequestInfo=function(c){var i=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(c.version).getBytes()),y(c.subject),n.publicKeyToAsn1(c.publicKey),d(c)]);return i},n.distinguishedNameToAsn1=function(c){return y(c)},n.certificateToAsn1=function(c){var i=c.tbsCertificate||n.getTBSCertificate(c);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[i,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.signatureOid).getBytes()),s(c.signatureOid,c.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.signature)])},n.certificateExtensionsToAsn1=function(c){var i=e.create(e.Class.CONTEXT_SPECIFIC,3,!0,[]),r=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);i.value.push(r);for(var B=0;B<c.length;++B)r.value.push(n.certificateExtensionToAsn1(c[B]));return i},n.certificateExtensionToAsn1=function(c){var i=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[]);i.value.push(e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.id).getBytes())),c.critical&&i.value.push(e.create(e.Class.UNIVERSAL,e.Type.BOOLEAN,!1,"ÿ"));var r=c.value;return typeof c.value!="string"&&(r=e.toDer(r).getBytes()),i.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,r)),i},n.certificationRequestToAsn1=function(c){var i=c.certificationRequestInfo||n.getCertificationRequestInfo(c);return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[i,e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(c.signatureOid).getBytes()),s(c.signatureOid,c.signatureParameters)]),e.create(e.Class.UNIVERSAL,e.Type.BITSTRING,!1,"\0"+c.signature)])},n.createCaStore=function(c){var i={certs:{}};i.getIssuer=function(L){var O=r(L.issuer);return O},i.addCertificate=function(L){if(typeof L=="string"&&(L=a.pki.certificateFromPem(L)),B(L.subject),!i.hasCertificate(L))if(L.subject.hash in i.certs){var O=i.certs[L.subject.hash];a.util.isArray(O)||(O=[O]),O.push(L),i.certs[L.subject.hash]=O}else i.certs[L.subject.hash]=L},i.hasCertificate=function(L){typeof L=="string"&&(L=a.pki.certificateFromPem(L));var O=r(L.subject);if(!O)return!1;a.util.isArray(O)||(O=[O]);for(var q=e.toDer(n.certificateToAsn1(L)).getBytes(),M=0;M<O.length;++M){var H=e.toDer(n.certificateToAsn1(O[M])).getBytes();if(q===H)return!0}return!1},i.listAllCertificates=function(){var L=[];for(var O in i.certs)if(i.certs.hasOwnProperty(O)){var q=i.certs[O];if(!a.util.isArray(q))L.push(q);else for(var M=0;M<q.length;++M)L.push(q[M])}return L},i.removeCertificate=function(L){var O;if(typeof L=="string"&&(L=a.pki.certificateFromPem(L)),B(L.subject),!i.hasCertificate(L))return null;var q=r(L.subject);if(!a.util.isArray(q))return O=i.certs[L.subject.hash],delete i.certs[L.subject.hash],O;for(var M=e.toDer(n.certificateToAsn1(L)).getBytes(),H=0;H<q.length;++H){var Y=e.toDer(n.certificateToAsn1(q[H])).getBytes();M===Y&&(O=q[H],q.splice(H,1))}return q.length===0&&delete i.certs[L.subject.hash],O};function r(L){return B(L),i.certs[L.hash]||null}function B(L){if(!L.hash){var O=a.md.sha1.create();L.attributes=n.RDNAttributesAsArray(y(L),O),L.hash=O.digest().toHex()}}if(c)for(var k=0;k<c.length;++k){var V=c[k];i.addCertificate(V)}return i},n.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},n.verifyCertificateChain=function(c,i,r){typeof r=="function"&&(r={verify:r}),r=r||{},i=i.slice(0);var B=i.slice(0),k=r.validityCheckDate;typeof k>"u"&&(k=new Date);var V=!0,L=null,O=0;do{var q=i.shift(),M=null,H=!1;if(k&&(k<q.validity.notBefore||k>q.validity.notAfter)&&(L={message:"Certificate is not valid yet or has expired.",error:n.certificateError.certificate_expired,notBefore:q.validity.notBefore,notAfter:q.validity.notAfter,now:k}),L===null){if(M=i[0]||c.getIssuer(q),M===null&&q.isIssuer(q)&&(H=!0,M=q),M){var Y=M;a.util.isArray(Y)||(Y=[Y]);for(var j=!1;!j&&Y.length>0;){M=Y.shift();try{j=M.verify(q)}catch{}}j||(L={message:"Certificate signature is invalid.",error:n.certificateError.bad_certificate})}L===null&&(!M||H)&&!c.hasCertificate(q)&&(L={message:"Certificate is not trusted.",error:n.certificateError.unknown_ca})}if(L===null&&M&&!q.isIssuer(M)&&(L={message:"Certificate issuer is invalid.",error:n.certificateError.bad_certificate}),L===null)for(var $={keyUsage:!0,basicConstraints:!0},ne=0;L===null&&ne<q.extensions.length;++ne){var se=q.extensions[ne];se.critical&&!(se.name in $)&&(L={message:"Certificate has an unsupported critical extension.",error:n.certificateError.unsupported_certificate})}if(L===null&&(!V||i.length===0&&(!M||H))){var he=q.getExtension("basicConstraints"),ge=q.getExtension("keyUsage");if(ge!==null&&(!ge.keyCertSign||he===null)&&(L={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:n.certificateError.bad_certificate}),L===null&&he!==null&&!he.cA&&(L={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:n.certificateError.bad_certificate}),L===null&&ge!==null&&"pathLenConstraint"in he){var W=O-1;W>he.pathLenConstraint&&(L={message:"Certificate basicConstraints pathLenConstraint violated.",error:n.certificateError.bad_certificate})}}var ue=L===null?!0:L.error,Z=r.verify?r.verify(ue,O,B):ue;if(Z===!0)L=null;else throw ue===!0&&(L={message:"The application rejected the certificate.",error:n.certificateError.bad_certificate}),(Z||Z===0)&&(typeof Z=="object"&&!a.util.isArray(Z)?(Z.message&&(L.message=Z.message),Z.error&&(L.error=Z.error)):typeof Z=="string"&&(L.error=Z)),L;V=!1,++O}while(i.length>0);return!0},tr.exports}var Wr;function Ea(){if(Wr)return Jt.exports;Wr=1;var a=le();tt(),vt(),lt(),ma(),ga(),Je(),Bt(),yt(),de(),Cr();var e=a.asn1,n=a.pki,v=Jt.exports=a.pkcs12=a.pkcs12||{},N={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},S={name:"PFX",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},N,{name:"PFX.macData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:e.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},h={name:"SafeBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},t={name:"Attribute",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,capture:"values"}]},m={name:"CertBag",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:e.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:e.Class.UNIVERSAL,type:e.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function f(C,g,s,d){for(var p=[],I=0;I<C.length;I++)for(var R=0;R<C[I].safeBags.length;R++){var c=C[I].safeBags[R];if(!(d!==void 0&&c.type!==d)){if(g===null){p.push(c);continue}c.attributes[g]!==void 0&&c.attributes[g].indexOf(s)>=0&&p.push(c)}}return p}v.pkcs12FromAsn1=function(C,g,s){typeof g=="string"?(s=g,g=!0):g===void 0&&(g=!0);var d={},p=[];if(!e.validate(C,S,d,p)){var I=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw I.errors=I,I}var R={version:d.version.charCodeAt(0),safeContents:[],getBags:function(M){var H={},Y;return"localKeyId"in M?Y=M.localKeyId:"localKeyIdHex"in M&&(Y=a.util.hexToBytes(M.localKeyIdHex)),Y===void 0&&!("friendlyName"in M)&&"bagType"in M&&(H[M.bagType]=f(R.safeContents,null,null,M.bagType)),Y!==void 0&&(H.localKeyId=f(R.safeContents,"localKeyId",Y,M.bagType)),"friendlyName"in M&&(H.friendlyName=f(R.safeContents,"friendlyName",M.friendlyName,M.bagType)),H},getBagsByFriendlyName:function(M,H){return f(R.safeContents,"friendlyName",M,H)},getBagsByLocalKeyId:function(M,H){return f(R.safeContents,"localKeyId",M,H)}};if(d.version.charCodeAt(0)!==3){var I=new Error("PKCS#12 PFX of version other than 3 not supported.");throw I.version=d.version.charCodeAt(0),I}if(e.derToOid(d.contentType)!==n.oids.data){var I=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw I.oid=e.derToOid(d.contentType),I}var c=d.content.value[0];if(c.tagClass!==e.Class.UNIVERSAL||c.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(c=x(c),d.mac){var i=null,r=0,B=e.derToOid(d.macAlgorithm);switch(B){case n.oids.sha1:i=a.md.sha1.create(),r=20;break;case n.oids.sha256:i=a.md.sha256.create(),r=32;break;case n.oids.sha384:i=a.md.sha384.create(),r=48;break;case n.oids.sha512:i=a.md.sha512.create(),r=64;break;case n.oids.md5:i=a.md.md5.create(),r=16;break}if(i===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+B);var k=new a.util.ByteBuffer(d.macSalt),V="macIterations"in d?parseInt(a.util.bytesToHex(d.macIterations),16):1,L=v.generateKey(s,k,3,V,r,i),O=a.hmac.create();O.start(i,L),O.update(c.value);var q=O.getMac();if(q.getBytes()!==d.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return D(R,c.value,g,s),R};function x(C){if(C.composed||C.constructed){for(var g=a.util.createBuffer(),s=0;s<C.value.length;++s)g.putBytes(C.value[s].value);C.composed=C.constructed=!1,C.value=g.getBytes()}return C}function D(C,g,s,d){if(g=e.fromDer(g,s),g.tagClass!==e.Class.UNIVERSAL||g.type!==e.Type.SEQUENCE||g.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var p=0;p<g.value.length;p++){var I=g.value[p],R={},c=[];if(!e.validate(I,N,R,c)){var i=new Error("Cannot read ContentInfo.");throw i.errors=c,i}var r={encrypted:!1},B=null,k=R.content.value[0];switch(e.derToOid(R.contentType)){case n.oids.data:if(k.tagClass!==e.Class.UNIVERSAL||k.type!==e.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");B=x(k).value;break;case n.oids.encryptedData:B=E(k,d),r.encrypted=!0;break;default:var i=new Error("Unsupported PKCS#12 contentType.");throw i.contentType=e.derToOid(R.contentType),i}r.safeBags=u(B,s,d),C.safeContents.push(r)}}function E(C,g){var s={},d=[];if(!e.validate(C,a.pkcs7.asn1.encryptedDataValidator,s,d)){var p=new Error("Cannot read EncryptedContentInfo.");throw p.errors=d,p}var I=e.derToOid(s.contentType);if(I!==n.oids.data){var p=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw p.oid=I,p}I=e.derToOid(s.encAlgorithm);var R=n.pbe.getCipher(I,s.encParameter,g),c=x(s.encryptedContentAsn1),i=a.util.createBuffer(c.value);if(R.update(i),!R.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return R.output.getBytes()}function u(C,g,s){if(!g&&C.length===0)return[];if(C=e.fromDer(C,g),C.tagClass!==e.Class.UNIVERSAL||C.type!==e.Type.SEQUENCE||C.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var d=[],p=0;p<C.value.length;p++){var I=C.value[p],R={},c=[];if(!e.validate(I,h,R,c)){var i=new Error("Cannot read SafeBag.");throw i.errors=c,i}var r={type:e.derToOid(R.bagId),attributes:y(R.bagAttributes)};d.push(r);var B,k,V=R.bagValue.value[0];switch(r.type){case n.oids.pkcs8ShroudedKeyBag:if(V=n.decryptPrivateKeyInfo(V,s),V===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case n.oids.keyBag:try{r.key=n.privateKeyFromAsn1(V)}catch{r.key=null,r.asn1=V}continue;case n.oids.certBag:B=m,k=function(){if(e.derToOid(R.certId)!==n.oids.x509Certificate){var O=new Error("Unsupported certificate type, only X.509 supported.");throw O.oid=e.derToOid(R.certId),O}var q=e.fromDer(R.cert,g);try{r.cert=n.certificateFromAsn1(q,!0)}catch{r.cert=null,r.asn1=q}};break;default:var i=new Error("Unsupported PKCS#12 SafeBag type.");throw i.oid=r.type,i}if(B!==void 0&&!e.validate(V,B,R,c)){var i=new Error("Cannot read PKCS#12 "+B.name);throw i.errors=c,i}k()}return d}function y(C){var g={};if(C!==void 0)for(var s=0;s<C.length;++s){var d={},p=[];if(!e.validate(C[s],t,d,p)){var I=new Error("Cannot read PKCS#12 BagAttribute.");throw I.errors=p,I}var R=e.derToOid(d.oid);if(n.oids[R]!==void 0){g[n.oids[R]]=[];for(var c=0;c<d.values.length;++c)g[n.oids[R]].push(d.values[c].value)}}return g}return v.toPkcs12Asn1=function(C,g,s,d){d=d||{},d.saltSize=d.saltSize||8,d.count=d.count||2048,d.algorithm=d.algorithm||d.encAlgorithm||"aes128","useMac"in d||(d.useMac=!0),"localKeyId"in d||(d.localKeyId=null),"generateLocalKeyId"in d||(d.generateLocalKeyId=!0);var p=d.localKeyId,I;if(p!==null)p=a.util.hexToBytes(p);else if(d.generateLocalKeyId)if(g){var R=a.util.isArray(g)?g[0]:g;typeof R=="string"&&(R=n.certificateFromPem(R));var c=a.md.sha1.create();c.update(e.toDer(n.certificateToAsn1(R)).getBytes()),p=c.digest().getBytes()}else p=a.random.getBytes(20);var i=[];p!==null&&i.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.localKeyId).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,p)])])),"friendlyName"in d&&i.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.friendlyName).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[e.create(e.Class.UNIVERSAL,e.Type.BMPSTRING,!1,d.friendlyName)])])),i.length>0&&(I=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,i));var r=[],B=[];g!==null&&(a.util.isArray(g)?B=g:B=[g]);for(var k=[],V=0;V<B.length;++V){g=B[V],typeof g=="string"&&(g=n.certificateFromPem(g));var L=V===0?I:void 0,O=n.certificateToAsn1(g),q=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.certBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.x509Certificate).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(O).getBytes())])])]),L]);k.push(q)}if(k.length>0){var M=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,k),H=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(M).getBytes())])]);r.push(H)}var Y=null;if(C!==null){var j=n.wrapRsaPrivateKey(n.privateKeyToAsn1(C));s===null?Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.keyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[j]),I]):Y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.pkcs8ShroudedKeyBag).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[n.encryptPrivateKeyInfo(j,s,d)]),I]);var $=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[Y]),ne=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer($).getBytes())])]);r.push(ne)}var se=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,r),he;if(d.useMac){var c=a.md.sha1.create(),ge=new a.util.ByteBuffer(a.random.getBytes(d.saltSize)),W=d.count,C=v.generateKey(s,ge,3,W,20),ue=a.hmac.create();ue.start(c,C),ue.update(e.toDer(se).getBytes());var Z=ue.getMac();he=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.sha1).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,Z.getBytes())]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,ge.getBytes()),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(W).getBytes())])}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(3).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(n.oids.data).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,e.toDer(se).getBytes())])]),he])},v.generateKey=a.pbe.generatePkcs12Key,Jt.exports}var Zr;function xa(){if(Zr)return qt.exports;Zr=1;var a=le();tt(),lt(),ga(),ht(),gr(),Ea(),mr(),Bt(),de(),Cr();var e=a.asn1,n=qt.exports=a.pki=a.pki||{};return n.pemToDer=function(v){var N=a.pem.decode(v)[0];if(N.procType&&N.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return a.util.createBuffer(N.body)},n.privateKeyFromPem=function(v){var N=a.pem.decode(v)[0];if(N.type!=="PRIVATE KEY"&&N.type!=="RSA PRIVATE KEY"){var S=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw S.headerType=N.type,S}if(N.procType&&N.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var h=e.fromDer(N.body);return n.privateKeyFromAsn1(h)},n.privateKeyToPem=function(v,N){var S={type:"RSA PRIVATE KEY",body:e.toDer(n.privateKeyToAsn1(v)).getBytes()};return a.pem.encode(S,{maxline:N})},n.privateKeyInfoToPem=function(v,N){var S={type:"PRIVATE KEY",body:e.toDer(v).getBytes()};return a.pem.encode(S,{maxline:N})},qt.exports}var ir,$r;function Sa(){if($r)return ir;$r=1;var a=le();tt(),vt(),vr(),ht(),xa(),Je(),yt(),de();var e=function(l,w,_,o){var A=a.util.createBuffer(),F=l.length>>1,P=F+(l.length&1),z=l.substr(0,P),ee=l.substr(F,P),ae=a.util.createBuffer(),G=a.hmac.create();_=w+_;var te=Math.ceil(o/16),ie=Math.ceil(o/20);G.start("MD5",z);var ce=a.util.createBuffer();ae.putBytes(_);for(var oe=0;oe<te;++oe)G.start(null,null),G.update(ae.getBytes()),ae.putBuffer(G.digest()),G.start(null,null),G.update(ae.bytes()+_),ce.putBuffer(G.digest());G.start("SHA1",ee);var me=a.util.createBuffer();ae.clear(),ae.putBytes(_);for(var oe=0;oe<ie;++oe)G.start(null,null),G.update(ae.getBytes()),ae.putBuffer(G.digest()),G.start(null,null),G.update(ae.bytes()+_),me.putBuffer(G.digest());return A.putBytes(a.util.xorBytes(ce.getBytes(),me.getBytes(),o)),A},n=function(l,w,_){var o=a.hmac.create();o.start("SHA1",l);var A=a.util.createBuffer();return A.putInt32(w[0]),A.putInt32(w[1]),A.putByte(_.type),A.putByte(_.version.major),A.putByte(_.version.minor),A.putInt16(_.length),A.putBytes(_.fragment.bytes()),o.update(A.getBytes()),o.digest().getBytes()},v=function(l,w,_){var o=!1;try{var A=l.deflate(w.fragment.getBytes());w.fragment=a.util.createBuffer(A),w.length=A.length,o=!0}catch{}return o},N=function(l,w,_){var o=!1;try{var A=l.inflate(w.fragment.getBytes());w.fragment=a.util.createBuffer(A),w.length=A.length,o=!0}catch{}return o},S=function(l,w){var _=0;switch(w){case 1:_=l.getByte();break;case 2:_=l.getInt16();break;case 3:_=l.getInt24();break;case 4:_=l.getInt32();break}return a.util.createBuffer(l.getBytes(_))},h=function(l,w,_){l.putInt(_.length(),w<<3),l.putBuffer(_)},t={};t.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}},t.SupportedVersions=[t.Versions.TLS_1_1,t.Versions.TLS_1_0],t.Version=t.SupportedVersions[0],t.MaxFragment=15360,t.ConnectionEnd={server:0,client:1},t.PRFAlgorithm={tls_prf_sha256:0},t.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},t.CipherType={stream:0,block:1,aead:2},t.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},t.CompressionMethod={none:0,deflate:1},t.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},t.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},t.Alert={},t.Alert.Level={warning:1,fatal:2},t.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},t.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},t.CipherSuites={},t.getCipherSuite=function(l){var w=null;for(var _ in t.CipherSuites){var o=t.CipherSuites[_];if(o.id[0]===l.charCodeAt(0)&&o.id[1]===l.charCodeAt(1)){w=o;break}}return w},t.handleUnexpected=function(l,w){var _=!l.open&&l.entity===t.ConnectionEnd.client;_||l.error(l,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unexpected_message}})},t.handleHelloRequest=function(l,w,_){!l.handshaking&&l.handshakes>0&&(t.queue(l,t.createAlert(l,{level:t.Alert.Level.warning,description:t.Alert.Description.no_renegotiation})),t.flush(l)),l.process()},t.parseHelloMessage=function(l,w,_){var o=null,A=l.entity===t.ConnectionEnd.client;if(_<38)l.error(l,{message:A?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});else{var F=w.fragment,P=F.length();if(o={version:{major:F.getByte(),minor:F.getByte()},random:a.util.createBuffer(F.getBytes(32)),session_id:S(F,1),extensions:[]},A?(o.cipher_suite=F.getBytes(2),o.compression_method=F.getByte()):(o.cipher_suites=S(F,2),o.compression_methods=S(F,1)),P=_-(P-F.length()),P>0){for(var z=S(F,2);z.length()>0;)o.extensions.push({type:[z.getByte(),z.getByte()],data:S(z,2)});if(!A)for(var ee=0;ee<o.extensions.length;++ee){var ae=o.extensions[ee];if(ae.type[0]===0&&ae.type[1]===0)for(var G=S(ae.data,2);G.length()>0;){var te=G.getByte();if(te!==0)break;l.session.extensions.server_name.serverNameList.push(S(G,2).getBytes())}}}if(l.session.version&&(o.version.major!==l.session.version.major||o.version.minor!==l.session.version.minor))return l.error(l,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.protocol_version}});if(A)l.session.cipherSuite=t.getCipherSuite(o.cipher_suite);else for(var ie=a.util.createBuffer(o.cipher_suites.bytes());ie.length()>0&&(l.session.cipherSuite=t.getCipherSuite(ie.getBytes(2)),l.session.cipherSuite===null););if(l.session.cipherSuite===null)return l.error(l,{message:"No cipher suites in common.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.handshake_failure},cipherSuite:a.util.bytesToHex(o.cipher_suite)});A?l.session.compressionMethod=o.compression_method:l.session.compressionMethod=t.CompressionMethod.none}return o},t.createSecurityParameters=function(l,w){var _=l.entity===t.ConnectionEnd.client,o=w.random.bytes(),A=_?l.session.sp.client_random:o,F=_?o:t.createRandom().getBytes();l.session.sp={entity:l.entity,prf_algorithm:t.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:l.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:A,server_random:F}},t.handleServerHello=function(l,w,_){var o=t.parseHelloMessage(l,w,_);if(!l.fail){if(o.version.minor<=l.version.minor)l.version.minor=o.version.minor;else return l.error(l,{message:"Incompatible TLS version.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.protocol_version}});l.session.version=l.version;var A=o.session_id.bytes();A.length>0&&A===l.session.id?(l.expect=u,l.session.resuming=!0,l.session.sp.server_random=o.random.bytes()):(l.expect=f,l.session.resuming=!1,t.createSecurityParameters(l,o)),l.session.id=A,l.process()}},t.handleClientHello=function(l,w,_){var o=t.parseHelloMessage(l,w,_);if(!l.fail){var A=o.session_id.bytes(),F=null;if(l.sessionCache&&(F=l.sessionCache.getSession(A),F===null?A="":(F.version.major!==o.version.major||F.version.minor>o.version.minor)&&(F=null,A="")),A.length===0&&(A=a.random.getBytes(32)),l.session.id=A,l.session.clientHelloVersion=o.version,l.session.sp={},F)l.version=l.session.version=F.version,l.session.sp=F.sp;else{for(var P,z=1;z<t.SupportedVersions.length&&(P=t.SupportedVersions[z],!(P.minor<=o.version.minor));++z);l.version={major:P.major,minor:P.minor},l.session.version=l.version}F!==null?(l.expect=R,l.session.resuming=!0,l.session.sp.client_random=o.random.bytes()):(l.expect=l.verifyClient!==!1?d:p,l.session.resuming=!1,t.createSecurityParameters(l,o)),l.open=!0,t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createServerHello(l)})),l.session.resuming?(t.queue(l,t.createRecord(l,{type:t.ContentType.change_cipher_spec,data:t.createChangeCipherSpec()})),l.state.pending=t.createConnectionState(l),l.state.current.write=l.state.pending.write,t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createFinished(l)}))):(t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createCertificate(l)})),l.fail||(t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createServerKeyExchange(l)})),l.verifyClient!==!1&&t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createCertificateRequest(l)})),t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createServerHelloDone(l)})))),t.flush(l),l.process()}},t.handleCertificate=function(l,w,_){if(_<3)return l.error(l,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var o=w.fragment,A={certificate_list:S(o,3)},F,P,z=[];try{for(;A.certificate_list.length()>0;)F=S(A.certificate_list,3),P=a.asn1.fromDer(F),F=a.pki.certificateFromAsn1(P,!0),z.push(F)}catch(ae){return l.error(l,{message:"Could not parse certificate list.",cause:ae,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.bad_certificate}})}var ee=l.entity===t.ConnectionEnd.client;(ee||l.verifyClient===!0)&&z.length===0?l.error(l,{message:ee?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}}):z.length===0?l.expect=ee?x:p:(ee?l.session.serverCertificate=z[0]:l.session.clientCertificate=z[0],t.verifyCertificateChain(l,z)&&(l.expect=ee?x:p)),l.process()},t.handleServerKeyExchange=function(l,w,_){if(_>0)return l.error(l,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unsupported_certificate}});l.expect=D,l.process()},t.handleClientKeyExchange=function(l,w,_){if(_<48)return l.error(l,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unsupported_certificate}});var o=w.fragment,A={enc_pre_master_secret:S(o,2).getBytes()},F=null;if(l.getPrivateKey)try{F=l.getPrivateKey(l,l.session.serverCertificate),F=a.pki.privateKeyFromPem(F)}catch(ee){l.error(l,{message:"Could not get private key.",cause:ee,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}})}if(F===null)return l.error(l,{message:"No private key set.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}});try{var P=l.session.sp;P.pre_master_secret=F.decrypt(A.enc_pre_master_secret);var z=l.session.clientHelloVersion;if(z.major!==P.pre_master_secret.charCodeAt(0)||z.minor!==P.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{P.pre_master_secret=a.random.getBytes(48)}l.expect=R,l.session.clientCertificate!==null&&(l.expect=I),l.process()},t.handleCertificateRequest=function(l,w,_){if(_<3)return l.error(l,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var o=w.fragment,A={certificate_types:S(o,1),certificate_authorities:S(o,2)};l.session.certificateRequest=A,l.expect=E,l.process()},t.handleCertificateVerify=function(l,w,_){if(_<2)return l.error(l,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var o=w.fragment;o.read-=4;var A=o.bytes();o.read+=4;var F={signature:S(o,2).getBytes()},P=a.util.createBuffer();P.putBuffer(l.session.md5.digest()),P.putBuffer(l.session.sha1.digest()),P=P.getBytes();try{var z=l.session.clientCertificate;if(!z.publicKey.verify(P,F.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");l.session.md5.update(A),l.session.sha1.update(A)}catch{return l.error(l,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.handshake_failure}})}l.expect=R,l.process()},t.handleServerHelloDone=function(l,w,_){if(_>0)return l.error(l,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.record_overflow}});if(l.serverCertificate===null){var o={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.insufficient_security}},A=0,F=l.verify(l,o.alert.description,A,[]);if(F!==!0)return(F||F===0)&&(typeof F=="object"&&!a.util.isArray(F)?(F.message&&(o.message=F.message),F.alert&&(o.alert.description=F.alert)):typeof F=="number"&&(o.alert.description=F)),l.error(l,o)}l.session.certificateRequest!==null&&(w=t.createRecord(l,{type:t.ContentType.handshake,data:t.createCertificate(l)}),t.queue(l,w)),w=t.createRecord(l,{type:t.ContentType.handshake,data:t.createClientKeyExchange(l)}),t.queue(l,w),l.expect=g;var P=function(z,ee){z.session.certificateRequest!==null&&z.session.clientCertificate!==null&&t.queue(z,t.createRecord(z,{type:t.ContentType.handshake,data:t.createCertificateVerify(z,ee)})),t.queue(z,t.createRecord(z,{type:t.ContentType.change_cipher_spec,data:t.createChangeCipherSpec()})),z.state.pending=t.createConnectionState(z),z.state.current.write=z.state.pending.write,t.queue(z,t.createRecord(z,{type:t.ContentType.handshake,data:t.createFinished(z)})),z.expect=u,t.flush(z),z.process()};if(l.session.certificateRequest===null||l.session.clientCertificate===null)return P(l,null);t.getClientSignature(l,P)},t.handleChangeCipherSpec=function(l,w){if(w.fragment.getByte()!==1)return l.error(l,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.illegal_parameter}});var _=l.entity===t.ConnectionEnd.client;(l.session.resuming&&_||!l.session.resuming&&!_)&&(l.state.pending=t.createConnectionState(l)),l.state.current.read=l.state.pending.read,(!l.session.resuming&&_||l.session.resuming&&!_)&&(l.state.pending=null),l.expect=_?y:c,l.process()},t.handleFinished=function(l,w,_){var o=w.fragment;o.read-=4;var A=o.bytes();o.read+=4;var F=w.fragment.getBytes();o=a.util.createBuffer(),o.putBuffer(l.session.md5.digest()),o.putBuffer(l.session.sha1.digest());var P=l.entity===t.ConnectionEnd.client,z=P?"server finished":"client finished",ee=l.session.sp,ae=12,G=e;if(o=G(ee.master_secret,z,o.getBytes(),ae),o.getBytes()!==F)return l.error(l,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.decrypt_error}});l.session.md5.update(A),l.session.sha1.update(A),(l.session.resuming&&P||!l.session.resuming&&!P)&&(t.queue(l,t.createRecord(l,{type:t.ContentType.change_cipher_spec,data:t.createChangeCipherSpec()})),l.state.current.write=l.state.pending.write,l.state.pending=null,t.queue(l,t.createRecord(l,{type:t.ContentType.handshake,data:t.createFinished(l)}))),l.expect=P?C:i,l.handshaking=!1,++l.handshakes,l.peerCertificate=P?l.session.serverCertificate:l.session.clientCertificate,t.flush(l),l.isConnected=!0,l.connected(l),l.process()},t.handleAlert=function(l,w){var _=w.fragment,o={level:_.getByte(),description:_.getByte()},A;switch(o.description){case t.Alert.Description.close_notify:A="Connection closed.";break;case t.Alert.Description.unexpected_message:A="Unexpected message.";break;case t.Alert.Description.bad_record_mac:A="Bad record MAC.";break;case t.Alert.Description.decryption_failed:A="Decryption failed.";break;case t.Alert.Description.record_overflow:A="Record overflow.";break;case t.Alert.Description.decompression_failure:A="Decompression failed.";break;case t.Alert.Description.handshake_failure:A="Handshake failure.";break;case t.Alert.Description.bad_certificate:A="Bad certificate.";break;case t.Alert.Description.unsupported_certificate:A="Unsupported certificate.";break;case t.Alert.Description.certificate_revoked:A="Certificate revoked.";break;case t.Alert.Description.certificate_expired:A="Certificate expired.";break;case t.Alert.Description.certificate_unknown:A="Certificate unknown.";break;case t.Alert.Description.illegal_parameter:A="Illegal parameter.";break;case t.Alert.Description.unknown_ca:A="Unknown certificate authority.";break;case t.Alert.Description.access_denied:A="Access denied.";break;case t.Alert.Description.decode_error:A="Decode error.";break;case t.Alert.Description.decrypt_error:A="Decrypt error.";break;case t.Alert.Description.export_restriction:A="Export restriction.";break;case t.Alert.Description.protocol_version:A="Unsupported protocol version.";break;case t.Alert.Description.insufficient_security:A="Insufficient security.";break;case t.Alert.Description.internal_error:A="Internal error.";break;case t.Alert.Description.user_canceled:A="User canceled.";break;case t.Alert.Description.no_renegotiation:A="Renegotiation not supported.";break;default:A="Unknown error.";break}if(o.description===t.Alert.Description.close_notify)return l.close();l.error(l,{message:A,send:!1,origin:l.entity===t.ConnectionEnd.client?"server":"client",alert:o}),l.process()},t.handleHandshake=function(l,w){var _=w.fragment,o=_.getByte(),A=_.getInt24();if(A>_.length())return l.fragmented=w,w.fragment=a.util.createBuffer(),_.read-=4,l.process();l.fragmented=null,_.read-=4;var F=_.bytes(A+4);_.read+=4,o in he[l.entity][l.expect]?(l.entity===t.ConnectionEnd.server&&!l.open&&!l.fail&&(l.handshaking=!0,l.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:a.md.md5.create(),sha1:a.md.sha1.create()}),o!==t.HandshakeType.hello_request&&o!==t.HandshakeType.certificate_verify&&o!==t.HandshakeType.finished&&(l.session.md5.update(F),l.session.sha1.update(F)),he[l.entity][l.expect][o](l,w,A)):t.handleUnexpected(l,w)},t.handleApplicationData=function(l,w){l.data.putBuffer(w.fragment),l.dataReady(l),l.process()},t.handleHeartbeat=function(l,w){var _=w.fragment,o=_.getByte(),A=_.getInt16(),F=_.getBytes(A);if(o===t.HeartbeatMessageType.heartbeat_request){if(l.handshaking||A>F.length)return l.process();t.queue(l,t.createRecord(l,{type:t.ContentType.heartbeat,data:t.createHeartbeat(t.HeartbeatMessageType.heartbeat_response,F)})),t.flush(l)}else if(o===t.HeartbeatMessageType.heartbeat_response){if(F!==l.expectedHeartbeatPayload)return l.process();l.heartbeatReceived&&l.heartbeatReceived(l,a.util.createBuffer(F))}l.process()};var m=0,f=1,x=2,D=3,E=4,u=5,y=6,C=7,g=8,s=0,d=1,p=2,I=3,R=4,c=5,i=6,r=t.handleUnexpected,B=t.handleChangeCipherSpec,k=t.handleAlert,V=t.handleHandshake,L=t.handleApplicationData,O=t.handleHeartbeat,q=[];q[t.ConnectionEnd.client]=[[r,k,V,r,O],[r,k,V,r,O],[r,k,V,r,O],[r,k,V,r,O],[r,k,V,r,O],[B,k,r,r,O],[r,k,V,r,O],[r,k,V,L,O],[r,k,V,r,O]],q[t.ConnectionEnd.server]=[[r,k,V,r,O],[r,k,V,r,O],[r,k,V,r,O],[r,k,V,r,O],[B,k,r,r,O],[r,k,V,r,O],[r,k,V,L,O],[r,k,V,r,O]];var M=t.handleHelloRequest,H=t.handleServerHello,Y=t.handleCertificate,j=t.handleServerKeyExchange,$=t.handleCertificateRequest,ne=t.handleServerHelloDone,se=t.handleFinished,he=[];he[t.ConnectionEnd.client]=[[r,r,H,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,Y,j,$,ne,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,j,$,ne,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,$,ne,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,ne,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,se],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[M,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]];var ge=t.handleClientHello,W=t.handleClientKeyExchange,ue=t.handleCertificateVerify;he[t.ConnectionEnd.server]=[[r,ge,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,Y,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,W,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,ue,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,se],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r],[r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r]],t.generateKeys=function(l,w){var _=e,o=w.client_random+w.server_random;l.session.resuming||(w.master_secret=_(w.pre_master_secret,"master secret",o,48).bytes(),w.pre_master_secret=null),o=w.server_random+w.client_random;var A=2*w.mac_key_length+2*w.enc_key_length,F=l.version.major===t.Versions.TLS_1_0.major&&l.version.minor===t.Versions.TLS_1_0.minor;F&&(A+=2*w.fixed_iv_length);var P=_(w.master_secret,"key expansion",o,A),z={client_write_MAC_key:P.getBytes(w.mac_key_length),server_write_MAC_key:P.getBytes(w.mac_key_length),client_write_key:P.getBytes(w.enc_key_length),server_write_key:P.getBytes(w.enc_key_length)};return F&&(z.client_write_IV=P.getBytes(w.fixed_iv_length),z.server_write_IV=P.getBytes(w.fixed_iv_length)),z},t.createConnectionState=function(l){var w=l.entity===t.ConnectionEnd.client,_=function(){var F={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(P){return!0},compressionState:null,compressFunction:function(P){return!0},updateSequenceNumber:function(){F.sequenceNumber[1]===4294967295?(F.sequenceNumber[1]=0,++F.sequenceNumber[0]):++F.sequenceNumber[1]}};return F},o={read:_(),write:_()};if(o.read.update=function(F,P){return o.read.cipherFunction(P,o.read)?o.read.compressFunction(F,P,o.read)||F.error(F,{message:"Could not decompress record.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.decompression_failure}}):F.error(F,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.bad_record_mac}}),!F.fail},o.write.update=function(F,P){return o.write.compressFunction(F,P,o.write)?o.write.cipherFunction(P,o.write)||F.error(F,{message:"Could not encrypt record.",send:!1,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}}):F.error(F,{message:"Could not compress record.",send:!1,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}}),!F.fail},l.session){var A=l.session.sp;switch(l.session.cipherSuite.initSecurityParameters(A),A.keys=t.generateKeys(l,A),o.read.macKey=w?A.keys.server_write_MAC_key:A.keys.client_write_MAC_key,o.write.macKey=w?A.keys.client_write_MAC_key:A.keys.server_write_MAC_key,l.session.cipherSuite.initConnectionState(o,l,A),A.compression_algorithm){case t.CompressionMethod.none:break;case t.CompressionMethod.deflate:o.read.compressFunction=N,o.write.compressFunction=v;break;default:throw new Error("Unsupported compression algorithm.")}}return o},t.createRandom=function(){var l=new Date,w=+l+l.getTimezoneOffset()*6e4,_=a.util.createBuffer();return _.putInt32(w),_.putBytes(a.random.getBytes(28)),_},t.createRecord=function(l,w){if(!w.data)return null;var _={type:w.type,version:{major:l.version.major,minor:l.version.minor},length:w.data.length(),fragment:w.data};return _},t.createAlert=function(l,w){var _=a.util.createBuffer();return _.putByte(w.level),_.putByte(w.description),t.createRecord(l,{type:t.ContentType.alert,data:_})},t.createClientHello=function(l){l.session.clientHelloVersion={major:l.version.major,minor:l.version.minor};for(var w=a.util.createBuffer(),_=0;_<l.cipherSuites.length;++_){var o=l.cipherSuites[_];w.putByte(o.id[0]),w.putByte(o.id[1])}var A=w.length(),F=a.util.createBuffer();F.putByte(t.CompressionMethod.none);var P=F.length(),z=a.util.createBuffer();if(l.virtualHost){var ee=a.util.createBuffer();ee.putByte(0),ee.putByte(0);var ae=a.util.createBuffer();ae.putByte(0),h(ae,2,a.util.createBuffer(l.virtualHost));var G=a.util.createBuffer();h(G,2,ae),h(ee,2,G),z.putBuffer(ee)}var te=z.length();te>0&&(te+=2);var ie=l.session.id,ce=ie.length+1+2+4+28+2+A+1+P+te,oe=a.util.createBuffer();return oe.putByte(t.HandshakeType.client_hello),oe.putInt24(ce),oe.putByte(l.version.major),oe.putByte(l.version.minor),oe.putBytes(l.session.sp.client_random),h(oe,1,a.util.createBuffer(ie)),h(oe,2,w),h(oe,1,F),te>0&&h(oe,2,z),oe},t.createServerHello=function(l){var w=l.session.id,_=w.length+1+2+4+28+2+1,o=a.util.createBuffer();return o.putByte(t.HandshakeType.server_hello),o.putInt24(_),o.putByte(l.version.major),o.putByte(l.version.minor),o.putBytes(l.session.sp.server_random),h(o,1,a.util.createBuffer(w)),o.putByte(l.session.cipherSuite.id[0]),o.putByte(l.session.cipherSuite.id[1]),o.putByte(l.session.compressionMethod),o},t.createCertificate=function(l){var w=l.entity===t.ConnectionEnd.client,_=null;if(l.getCertificate){var o;w?o=l.session.certificateRequest:o=l.session.extensions.server_name.serverNameList,_=l.getCertificate(l,o)}var A=a.util.createBuffer();if(_!==null)try{a.util.isArray(_)||(_=[_]);for(var F=null,P=0;P<_.length;++P){var z=a.pem.decode(_[P])[0];if(z.type!=="CERTIFICATE"&&z.type!=="X509 CERTIFICATE"&&z.type!=="TRUSTED CERTIFICATE"){var ee=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw ee.headerType=z.type,ee}if(z.procType&&z.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var ae=a.util.createBuffer(z.body);F===null&&(F=a.asn1.fromDer(ae.bytes(),!1));var G=a.util.createBuffer();h(G,3,ae),A.putBuffer(G)}_=a.pki.certificateFromAsn1(F),w?l.session.clientCertificate=_:l.session.serverCertificate=_}catch(ce){return l.error(l,{message:"Could not send certificate list.",cause:ce,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.bad_certificate}})}var te=3+A.length(),ie=a.util.createBuffer();return ie.putByte(t.HandshakeType.certificate),ie.putInt24(te),h(ie,3,A),ie},t.createClientKeyExchange=function(l){var w=a.util.createBuffer();w.putByte(l.session.clientHelloVersion.major),w.putByte(l.session.clientHelloVersion.minor),w.putBytes(a.random.getBytes(46));var _=l.session.sp;_.pre_master_secret=w.getBytes();var o=l.session.serverCertificate.publicKey;w=o.encrypt(_.pre_master_secret);var A=w.length+2,F=a.util.createBuffer();return F.putByte(t.HandshakeType.client_key_exchange),F.putInt24(A),F.putInt16(w.length),F.putBytes(w),F},t.createServerKeyExchange=function(l){var w=a.util.createBuffer();return w},t.getClientSignature=function(l,w){var _=a.util.createBuffer();_.putBuffer(l.session.md5.digest()),_.putBuffer(l.session.sha1.digest()),_=_.getBytes(),l.getSignature=l.getSignature||function(o,A,F){var P=null;if(o.getPrivateKey)try{P=o.getPrivateKey(o,o.session.clientCertificate),P=a.pki.privateKeyFromPem(P)}catch(z){o.error(o,{message:"Could not get private key.",cause:z,send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}})}P===null?o.error(o,{message:"No private key set.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.internal_error}}):A=P.sign(A,null),F(o,A)},l.getSignature(l,_,w)},t.createCertificateVerify=function(l,w){var _=w.length+2,o=a.util.createBuffer();return o.putByte(t.HandshakeType.certificate_verify),o.putInt24(_),o.putInt16(w.length),o.putBytes(w),o},t.createCertificateRequest=function(l){var w=a.util.createBuffer();w.putByte(1);var _=a.util.createBuffer();for(var o in l.caStore.certs){var A=l.caStore.certs[o],F=a.pki.distinguishedNameToAsn1(A.subject),P=a.asn1.toDer(F);_.putInt16(P.length()),_.putBuffer(P)}var z=1+w.length()+2+_.length(),ee=a.util.createBuffer();return ee.putByte(t.HandshakeType.certificate_request),ee.putInt24(z),h(ee,1,w),h(ee,2,_),ee},t.createServerHelloDone=function(l){var w=a.util.createBuffer();return w.putByte(t.HandshakeType.server_hello_done),w.putInt24(0),w},t.createChangeCipherSpec=function(){var l=a.util.createBuffer();return l.putByte(1),l},t.createFinished=function(l){var w=a.util.createBuffer();w.putBuffer(l.session.md5.digest()),w.putBuffer(l.session.sha1.digest());var _=l.entity===t.ConnectionEnd.client,o=l.session.sp,A=12,F=e,P=_?"client finished":"server finished";w=F(o.master_secret,P,w.getBytes(),A);var z=a.util.createBuffer();return z.putByte(t.HandshakeType.finished),z.putInt24(w.length()),z.putBuffer(w),z},t.createHeartbeat=function(l,w,_){typeof _>"u"&&(_=w.length);var o=a.util.createBuffer();o.putByte(l),o.putInt16(_),o.putBytes(w);var A=o.length(),F=Math.max(16,A-_-3);return o.putBytes(a.random.getBytes(F)),o},t.queue=function(l,w){if(w&&!(w.fragment.length()===0&&(w.type===t.ContentType.handshake||w.type===t.ContentType.alert||w.type===t.ContentType.change_cipher_spec))){if(w.type===t.ContentType.handshake){var _=w.fragment.bytes();l.session.md5.update(_),l.session.sha1.update(_),_=null}var o;if(w.fragment.length()<=t.MaxFragment)o=[w];else{o=[];for(var A=w.fragment.bytes();A.length>t.MaxFragment;)o.push(t.createRecord(l,{type:w.type,data:a.util.createBuffer(A.slice(0,t.MaxFragment))})),A=A.slice(t.MaxFragment);A.length>0&&o.push(t.createRecord(l,{type:w.type,data:a.util.createBuffer(A)}))}for(var F=0;F<o.length&&!l.fail;++F){var P=o[F],z=l.state.current.write;z.update(l,P)&&l.records.push(P)}}},t.flush=function(l){for(var w=0;w<l.records.length;++w){var _=l.records[w];l.tlsData.putByte(_.type),l.tlsData.putByte(_.version.major),l.tlsData.putByte(_.version.minor),l.tlsData.putInt16(_.fragment.length()),l.tlsData.putBuffer(l.records[w].fragment)}return l.records=[],l.tlsDataReady(l)};var Z=function(l){switch(l){case!0:return!0;case a.pki.certificateError.bad_certificate:return t.Alert.Description.bad_certificate;case a.pki.certificateError.unsupported_certificate:return t.Alert.Description.unsupported_certificate;case a.pki.certificateError.certificate_revoked:return t.Alert.Description.certificate_revoked;case a.pki.certificateError.certificate_expired:return t.Alert.Description.certificate_expired;case a.pki.certificateError.certificate_unknown:return t.Alert.Description.certificate_unknown;case a.pki.certificateError.unknown_ca:return t.Alert.Description.unknown_ca;default:return t.Alert.Description.bad_certificate}},qe=function(l){switch(l){case!0:return!0;case t.Alert.Description.bad_certificate:return a.pki.certificateError.bad_certificate;case t.Alert.Description.unsupported_certificate:return a.pki.certificateError.unsupported_certificate;case t.Alert.Description.certificate_revoked:return a.pki.certificateError.certificate_revoked;case t.Alert.Description.certificate_expired:return a.pki.certificateError.certificate_expired;case t.Alert.Description.certificate_unknown:return a.pki.certificateError.certificate_unknown;case t.Alert.Description.unknown_ca:return a.pki.certificateError.unknown_ca;default:return a.pki.certificateError.bad_certificate}};t.verifyCertificateChain=function(l,w){try{var _={};for(var o in l.verifyOptions)_[o]=l.verifyOptions[o];_.verify=function(F,P,z){var ee=Z(F),ae=l.verify(l,F,P,z);if(ae!==!0){if(typeof ae=="object"&&!a.util.isArray(ae)){var G=new Error("The application rejected the certificate.");throw G.send=!0,G.alert={level:t.Alert.Level.fatal,description:t.Alert.Description.bad_certificate},ae.message&&(G.message=ae.message),ae.alert&&(G.alert.description=ae.alert),G}ae!==F&&(ae=qe(ae))}return ae},a.pki.verifyCertificateChain(l.caStore,w,_)}catch(F){var A=F;(typeof A!="object"||a.util.isArray(A))&&(A={send:!0,alert:{level:t.Alert.Level.fatal,description:Z(F)}}),"send"in A||(A.send=!0),"alert"in A||(A.alert={level:t.Alert.Level.fatal,description:Z(A.error)}),l.error(l,A)}return!l.fail},t.createSessionCache=function(l,w){var _=null;if(l&&l.getSession&&l.setSession&&l.order)_=l;else{_={},_.cache=l||{},_.capacity=Math.max(w||100,1),_.order=[];for(var o in l)_.order.length<=w?_.order.push(o):delete l[o];_.getSession=function(A){var F=null,P=null;if(A?P=a.util.bytesToHex(A):_.order.length>0&&(P=_.order[0]),P!==null&&P in _.cache){F=_.cache[P],delete _.cache[P];for(var z in _.order)if(_.order[z]===P){_.order.splice(z,1);break}}return F},_.setSession=function(A,F){if(_.order.length===_.capacity){var P=_.order.shift();delete _.cache[P]}var P=a.util.bytesToHex(A);_.order.push(P),_.cache[P]=F}}return _},t.createConnection=function(l){var w=null;l.caStore?a.util.isArray(l.caStore)?w=a.pki.createCaStore(l.caStore):w=l.caStore:w=a.pki.createCaStore();var _=l.cipherSuites||null;if(_===null){_=[];for(var o in t.CipherSuites)_.push(t.CipherSuites[o])}var A=l.server?t.ConnectionEnd.server:t.ConnectionEnd.client,F=l.sessionCache?t.createSessionCache(l.sessionCache):null,P={version:{major:t.Version.major,minor:t.Version.minor},entity:A,sessionId:l.sessionId,caStore:w,sessionCache:F,cipherSuites:_,connected:l.connected,virtualHost:l.virtualHost||null,verifyClient:l.verifyClient||!1,verify:l.verify||function(G,te,ie,ce){return te},verifyOptions:l.verifyOptions||{},getCertificate:l.getCertificate||null,getPrivateKey:l.getPrivateKey||null,getSignature:l.getSignature||null,input:a.util.createBuffer(),tlsData:a.util.createBuffer(),data:a.util.createBuffer(),tlsDataReady:l.tlsDataReady,dataReady:l.dataReady,heartbeatReceived:l.heartbeatReceived,closed:l.closed,error:function(G,te){te.origin=te.origin||(G.entity===t.ConnectionEnd.client?"client":"server"),te.send&&(t.queue(G,t.createAlert(G,te.alert)),t.flush(G));var ie=te.fatal!==!1;ie&&(G.fail=!0),l.error(G,te),ie&&G.close(!1)},deflate:l.deflate||null,inflate:l.inflate||null};P.reset=function(G){P.version={major:t.Version.major,minor:t.Version.minor},P.record=null,P.session=null,P.peerCertificate=null,P.state={pending:null,current:null},P.expect=P.entity===t.ConnectionEnd.client?m:s,P.fragmented=null,P.records=[],P.open=!1,P.handshakes=0,P.handshaking=!1,P.isConnected=!1,P.fail=!(G||typeof G>"u"),P.input.clear(),P.tlsData.clear(),P.data.clear(),P.state.current=t.createConnectionState(P)},P.reset();var z=function(G,te){var ie=te.type-t.ContentType.change_cipher_spec,ce=q[G.entity][G.expect];ie in ce?ce[ie](G,te):t.handleUnexpected(G,te)},ee=function(G){var te=0,ie=G.input,ce=ie.length();if(ce<5)te=5-ce;else{G.record={type:ie.getByte(),version:{major:ie.getByte(),minor:ie.getByte()},length:ie.getInt16(),fragment:a.util.createBuffer(),ready:!1};var oe=G.record.version.major===G.version.major;oe&&G.session&&G.session.version&&(oe=G.record.version.minor===G.version.minor),oe||G.error(G,{message:"Incompatible TLS version.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.protocol_version}})}return te},ae=function(G){var te=0,ie=G.input,ce=ie.length();if(ce<G.record.length)te=G.record.length-ce;else{G.record.fragment.putBytes(ie.getBytes(G.record.length)),ie.compact();var oe=G.state.current.read;oe.update(G,G.record)&&(G.fragmented!==null&&(G.fragmented.type===G.record.type?(G.fragmented.fragment.putBuffer(G.record.fragment),G.record=G.fragmented):G.error(G,{message:"Invalid fragmented record.",send:!0,alert:{level:t.Alert.Level.fatal,description:t.Alert.Description.unexpected_message}})),G.record.ready=!0)}return te};return P.handshake=function(G){if(P.entity!==t.ConnectionEnd.client)P.error(P,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(P.handshaking)P.error(P,{message:"Handshake already in progress.",fatal:!1});else{P.fail&&!P.open&&P.handshakes===0&&(P.fail=!1),P.handshaking=!0,G=G||"";var te=null;G.length>0&&(P.sessionCache&&(te=P.sessionCache.getSession(G)),te===null&&(G="")),G.length===0&&P.sessionCache&&(te=P.sessionCache.getSession(),te!==null&&(G=te.id)),P.session={id:G,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:a.md.md5.create(),sha1:a.md.sha1.create()},te&&(P.version=te.version,P.session.sp=te.sp),P.session.sp.client_random=t.createRandom().getBytes(),P.open=!0,t.queue(P,t.createRecord(P,{type:t.ContentType.handshake,data:t.createClientHello(P)})),t.flush(P)}},P.process=function(G){var te=0;return G&&P.input.putBytes(G),P.fail||(P.record!==null&&P.record.ready&&P.record.fragment.isEmpty()&&(P.record=null),P.record===null&&(te=ee(P)),!P.fail&&P.record!==null&&!P.record.ready&&(te=ae(P)),!P.fail&&P.record!==null&&P.record.ready&&z(P,P.record)),te},P.prepare=function(G){return t.queue(P,t.createRecord(P,{type:t.ContentType.application_data,data:a.util.createBuffer(G)})),t.flush(P)},P.prepareHeartbeatRequest=function(G,te){return G instanceof a.util.ByteBuffer&&(G=G.bytes()),typeof te>"u"&&(te=G.length),P.expectedHeartbeatPayload=G,t.queue(P,t.createRecord(P,{type:t.ContentType.heartbeat,data:t.createHeartbeat(t.HeartbeatMessageType.heartbeat_request,G,te)})),t.flush(P)},P.close=function(G){if(!P.fail&&P.sessionCache&&P.session){var te={id:P.session.id,version:P.session.version,sp:P.session.sp};te.sp.keys=null,P.sessionCache.setSession(te.id,te)}P.open&&(P.open=!1,P.input.clear(),(P.isConnected||P.handshaking)&&(P.isConnected=P.handshaking=!1,t.queue(P,t.createAlert(P,{level:t.Alert.Level.warning,description:t.Alert.Description.close_notify})),t.flush(P)),P.closed(P)),P.reset(G)},P},ir=a.tls=a.tls||{};for(var fe in t)typeof t[fe]!="function"&&(a.tls[fe]=t[fe]);return a.tls.prf_tls1=e,a.tls.hmac_sha1=n,a.tls.createSessionCache=t.createSessionCache,a.tls.createConnection=t.createConnection,ir}var Jr;function en(){if(Jr)return Ut.exports;Jr=1;var a=le();ut(),Sa();var e=Ut.exports=a.tls;e.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(m){m.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,m.cipher_type=e.CipherType.block,m.enc_key_length=16,m.block_length=16,m.fixed_iv_length=16,m.record_iv_length=16,m.mac_algorithm=e.MACAlgorithm.hmac_sha1,m.mac_length=20,m.mac_key_length=20},initConnectionState:n},e.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(m){m.bulk_cipher_algorithm=e.BulkCipherAlgorithm.aes,m.cipher_type=e.CipherType.block,m.enc_key_length=32,m.block_length=16,m.fixed_iv_length=16,m.record_iv_length=16,m.mac_algorithm=e.MACAlgorithm.hmac_sha1,m.mac_length=20,m.mac_key_length=20},initConnectionState:n};function n(m,f,x){var D=f.entity===a.tls.ConnectionEnd.client;m.read.cipherState={init:!1,cipher:a.cipher.createDecipher("AES-CBC",D?x.keys.server_write_key:x.keys.client_write_key),iv:D?x.keys.server_write_IV:x.keys.client_write_IV},m.write.cipherState={init:!1,cipher:a.cipher.createCipher("AES-CBC",D?x.keys.client_write_key:x.keys.server_write_key),iv:D?x.keys.client_write_IV:x.keys.server_write_IV},m.read.cipherFunction=h,m.write.cipherFunction=v,m.read.macLength=m.write.macLength=x.mac_length,m.read.macFunction=m.write.macFunction=e.hmac_sha1}function v(m,f){var x=!1,D=f.macFunction(f.macKey,f.sequenceNumber,m);m.fragment.putBytes(D),f.updateSequenceNumber();var E;m.version.minor===e.Versions.TLS_1_0.minor?E=f.cipherState.init?null:f.cipherState.iv:E=a.random.getBytesSync(16),f.cipherState.init=!0;var u=f.cipherState.cipher;return u.start({iv:E}),m.version.minor>=e.Versions.TLS_1_1.minor&&u.output.putBytes(E),u.update(m.fragment),u.finish(N)&&(m.fragment=u.output,m.length=m.fragment.length(),x=!0),x}function N(m,f,x){if(!x){var D=m-f.length()%m;f.fillWithByte(D-1,D)}return!0}function S(m,f,x){var D=!0;if(x){for(var E=f.length(),u=f.last(),y=E-1-u;y<E-1;++y)D=D&&f.at(y)==u;D&&f.truncate(u+1)}return D}function h(m,f){var x=!1,D;m.version.minor===e.Versions.TLS_1_0.minor?D=f.cipherState.init?null:f.cipherState.iv:D=m.fragment.getBytes(16),f.cipherState.init=!0;var E=f.cipherState.cipher;E.start({iv:D}),E.update(m.fragment),x=E.finish(S);var u=f.macLength,y=a.random.getBytesSync(u),C=E.output.length();C>=u?(m.fragment=E.output.getBytes(C-u),y=E.output.getBytes(u)):m.fragment=E.output.getBytes(),m.fragment=a.util.createBuffer(m.fragment),m.length=m.fragment.length();var g=f.macFunction(f.macKey,f.sequenceNumber,m);return f.updateSequenceNumber(),x=t(f.macKey,y,g)&&x,x}function t(m,f,x){var D=a.hmac.create();return D.start("SHA1",m),D.update(f),f=D.digest().getBytes(),D.start(null,null),D.update(x),x=D.digest().getBytes(),f===x}return Ut.exports}var sr={exports:{}},ea;function Ta(){if(ea)return sr.exports;ea=1;var a=le();nt(),de();var e=sr.exports=a.sha512=a.sha512||{};a.md.sha512=a.md.algorithms.sha512=e;var n=a.sha384=a.sha512.sha384=a.sha512.sha384||{};n.create=function(){return e.create("SHA-384")},a.md.sha384=a.md.algorithms.sha384=n,a.sha512.sha256=a.sha512.sha256||{create:function(){return e.create("SHA-512/256")}},a.md["sha512/256"]=a.md.algorithms["sha512/256"]=a.sha512.sha256,a.sha512.sha224=a.sha512.sha224||{create:function(){return e.create("SHA-512/224")}},a.md["sha512/224"]=a.md.algorithms["sha512/224"]=a.sha512.sha224,e.create=function(f){if(N||t(),typeof f>"u"&&(f="SHA-512"),!(f in h))throw new Error("Invalid SHA-512 algorithm: "+f);for(var x=h[f],D=null,E=a.util.createBuffer(),u=new Array(80),y=0;y<80;++y)u[y]=new Array(2);var C=64;switch(f){case"SHA-384":C=48;break;case"SHA-512/256":C=32;break;case"SHA-512/224":C=28;break}var g={algorithm:f.replace("-","").toLowerCase(),blockLength:128,digestLength:C,messageLength:0,fullMessageLength:null,messageLengthSize:16};return g.start=function(){g.messageLength=0,g.fullMessageLength=g.messageLength128=[];for(var s=g.messageLengthSize/4,d=0;d<s;++d)g.fullMessageLength.push(0);E=a.util.createBuffer(),D=new Array(x.length);for(var d=0;d<x.length;++d)D[d]=x[d].slice(0);return g},g.start(),g.update=function(s,d){d==="utf8"&&(s=a.util.encodeUtf8(s));var p=s.length;g.messageLength+=p,p=[p/4294967296>>>0,p>>>0];for(var I=g.fullMessageLength.length-1;I>=0;--I)g.fullMessageLength[I]+=p[1],p[1]=p[0]+(g.fullMessageLength[I]/4294967296>>>0),g.fullMessageLength[I]=g.fullMessageLength[I]>>>0,p[0]=p[1]/4294967296>>>0;return E.putBytes(s),m(D,u,E),(E.read>2048||E.length()===0)&&E.compact(),g},g.digest=function(){var s=a.util.createBuffer();s.putBytes(E.bytes());var d=g.fullMessageLength[g.fullMessageLength.length-1]+g.messageLengthSize,p=d&g.blockLength-1;s.putBytes(v.substr(0,g.blockLength-p));for(var I,R,c=g.fullMessageLength[0]*8,i=0;i<g.fullMessageLength.length-1;++i)I=g.fullMessageLength[i+1]*8,R=I/4294967296>>>0,c+=R,s.putInt32(c>>>0),c=I>>>0;s.putInt32(c);for(var r=new Array(D.length),i=0;i<D.length;++i)r[i]=D[i].slice(0);m(r,u,s);var B=a.util.createBuffer(),k;f==="SHA-512"?k=r.length:f==="SHA-384"?k=r.length-2:k=r.length-4;for(var i=0;i<k;++i)B.putInt32(r[i][0]),(i!==k-1||f!=="SHA-512/224")&&B.putInt32(r[i][1]);return B},g};var v=null,N=!1,S=null,h=null;function t(){v="",v+=a.util.fillString("\0",128),S=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],h={},h["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],h["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],h["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],h["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],N=!0}function m(f,x,D){for(var E,u,y,C,g,s,d,p,I,R,c,i,r,B,k,V,L,O,q,M,H,Y,j,$,ne,se,he,ge,W,ue,Z,qe,fe,l,w,_=D.length();_>=128;){for(W=0;W<16;++W)x[W][0]=D.getInt32()>>>0,x[W][1]=D.getInt32()>>>0;for(;W<80;++W)qe=x[W-2],ue=qe[0],Z=qe[1],E=((ue>>>19|Z<<13)^(Z>>>29|ue<<3)^ue>>>6)>>>0,u=((ue<<13|Z>>>19)^(Z<<3|ue>>>29)^(ue<<26|Z>>>6))>>>0,l=x[W-15],ue=l[0],Z=l[1],y=((ue>>>1|Z<<31)^(ue>>>8|Z<<24)^ue>>>7)>>>0,C=((ue<<31|Z>>>1)^(ue<<24|Z>>>8)^(ue<<25|Z>>>7))>>>0,fe=x[W-7],w=x[W-16],Z=u+fe[1]+C+w[1],x[W][0]=E+fe[0]+y+w[0]+(Z/4294967296>>>0)>>>0,x[W][1]=Z>>>0;for(r=f[0][0],B=f[0][1],k=f[1][0],V=f[1][1],L=f[2][0],O=f[2][1],q=f[3][0],M=f[3][1],H=f[4][0],Y=f[4][1],j=f[5][0],$=f[5][1],ne=f[6][0],se=f[6][1],he=f[7][0],ge=f[7][1],W=0;W<80;++W)d=((H>>>14|Y<<18)^(H>>>18|Y<<14)^(Y>>>9|H<<23))>>>0,p=((H<<18|Y>>>14)^(H<<14|Y>>>18)^(Y<<23|H>>>9))>>>0,I=(ne^H&(j^ne))>>>0,R=(se^Y&($^se))>>>0,g=((r>>>28|B<<4)^(B>>>2|r<<30)^(B>>>7|r<<25))>>>0,s=((r<<4|B>>>28)^(B<<30|r>>>2)^(B<<25|r>>>7))>>>0,c=(r&k|L&(r^k))>>>0,i=(B&V|O&(B^V))>>>0,Z=ge+p+R+S[W][1]+x[W][1],E=he+d+I+S[W][0]+x[W][0]+(Z/4294967296>>>0)>>>0,u=Z>>>0,Z=s+i,y=g+c+(Z/4294967296>>>0)>>>0,C=Z>>>0,he=ne,ge=se,ne=j,se=$,j=H,$=Y,Z=M+u,H=q+E+(Z/4294967296>>>0)>>>0,Y=Z>>>0,q=L,M=O,L=k,O=V,k=r,V=B,Z=u+C,r=E+y+(Z/4294967296>>>0)>>>0,B=Z>>>0;Z=f[0][1]+B,f[0][0]=f[0][0]+r+(Z/4294967296>>>0)>>>0,f[0][1]=Z>>>0,Z=f[1][1]+V,f[1][0]=f[1][0]+k+(Z/4294967296>>>0)>>>0,f[1][1]=Z>>>0,Z=f[2][1]+O,f[2][0]=f[2][0]+L+(Z/4294967296>>>0)>>>0,f[2][1]=Z>>>0,Z=f[3][1]+M,f[3][0]=f[3][0]+q+(Z/4294967296>>>0)>>>0,f[3][1]=Z>>>0,Z=f[4][1]+Y,f[4][0]=f[4][0]+H+(Z/4294967296>>>0)>>>0,f[4][1]=Z>>>0,Z=f[5][1]+$,f[5][0]=f[5][0]+j+(Z/4294967296>>>0)>>>0,f[5][1]=Z>>>0,Z=f[6][1]+se,f[6][0]=f[6][0]+ne+(Z/4294967296>>>0)>>>0,f[6][1]=Z>>>0,Z=f[7][1]+ge,f[7][0]=f[7][0]+he+(Z/4294967296>>>0)>>>0,f[7][1]=Z>>>0,_-=128}}return sr.exports}var St={},ta;function tn(){if(ta)return St;ta=1;var a=le();tt();var e=a.asn1;return St.privateKeyValidator={name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},St.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:e.Class.UNIVERSAL,type:e.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]},St}var or,ra;function rn(){if(ra)return or;ra=1;var a=le();At(),Je(),Ta(),de();var e=tn(),n=e.publicKeyValidator,v=e.privateKeyValidator;if(typeof N>"u")var N=a.jsbn.BigInteger;var S=a.util.ByteBuffer,h=typeof Buffer>"u"?Uint8Array:Buffer;a.pki=a.pki||{},or=a.pki.ed25519=a.ed25519=a.ed25519||{};var t=a.ed25519;t.constants={},t.constants.PUBLIC_KEY_BYTE_LENGTH=32,t.constants.PRIVATE_KEY_BYTE_LENGTH=64,t.constants.SEED_BYTE_LENGTH=32,t.constants.SIGN_BYTE_LENGTH=64,t.constants.HASH_BYTE_LENGTH=64,t.generateKeyPair=function(l){l=l||{};var w=l.seed;if(w===void 0)w=a.random.getBytesSync(t.constants.SEED_BYTE_LENGTH);else if(typeof w=="string"){if(w.length!==t.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+t.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(w instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');w=m({message:w,encoding:"binary"});for(var _=new h(t.constants.PUBLIC_KEY_BYTE_LENGTH),o=new h(t.constants.PRIVATE_KEY_BYTE_LENGTH),A=0;A<32;++A)o[A]=w[A];return d(_,o),{publicKey:_,privateKey:o}},t.privateKeyFromAsn1=function(l){var w={},_=[],o=a.asn1.validate(l,v,w,_);if(!o){var A=new Error("Invalid Key.");throw A.errors=_,A}var F=a.asn1.derToOid(w.privateKeyOid),P=a.oids.EdDSA25519;if(F!==P)throw new Error('Invalid OID "'+F+'"; OID must be "'+P+'".');var z=w.privateKey,ee=m({message:a.asn1.fromDer(z).value,encoding:"binary"});return{privateKeyBytes:ee}},t.publicKeyFromAsn1=function(l){var w={},_=[],o=a.asn1.validate(l,n,w,_);if(!o){var A=new Error("Invalid Key.");throw A.errors=_,A}var F=a.asn1.derToOid(w.publicKeyOid),P=a.oids.EdDSA25519;if(F!==P)throw new Error('Invalid OID "'+F+'"; OID must be "'+P+'".');var z=w.ed25519PublicKey;if(z.length!==t.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return m({message:z,encoding:"binary"})},t.publicKeyFromPrivateKey=function(l){l=l||{};var w=m({message:l.privateKey,encoding:"binary"});if(w.length!==t.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+t.constants.PRIVATE_KEY_BYTE_LENGTH);for(var _=new h(t.constants.PUBLIC_KEY_BYTE_LENGTH),o=0;o<_.length;++o)_[o]=w[32+o];return _},t.sign=function(l){l=l||{};var w=m(l),_=m({message:l.privateKey,encoding:"binary"});if(_.length===t.constants.SEED_BYTE_LENGTH){var o=t.generateKeyPair({seed:_});_=o.privateKey}else if(_.length!==t.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+t.constants.SEED_BYTE_LENGTH+" or "+t.constants.PRIVATE_KEY_BYTE_LENGTH);var A=new h(t.constants.SIGN_BYTE_LENGTH+w.length);p(A,w,w.length,_);for(var F=new h(t.constants.SIGN_BYTE_LENGTH),P=0;P<F.length;++P)F[P]=A[P];return F},t.verify=function(l){l=l||{};var w=m(l);if(l.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var _=m({message:l.signature,encoding:"binary"});if(_.length!==t.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+t.constants.SIGN_BYTE_LENGTH);var o=m({message:l.publicKey,encoding:"binary"});if(o.length!==t.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+t.constants.PUBLIC_KEY_BYTE_LENGTH);var A=new h(t.constants.SIGN_BYTE_LENGTH+w.length),F=new h(t.constants.SIGN_BYTE_LENGTH+w.length),P;for(P=0;P<t.constants.SIGN_BYTE_LENGTH;++P)A[P]=_[P];for(P=0;P<w.length;++P)A[P+t.constants.SIGN_BYTE_LENGTH]=w[P];return I(F,A,A.length,o)>=0};function m(l){var w=l.message;if(w instanceof Uint8Array||w instanceof h)return w;var _=l.encoding;if(w===void 0)if(l.md)w=l.md.digest().getBytes(),_="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof w=="string"&&!_)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof w=="string"){if(typeof Buffer<"u")return Buffer.from(w,_);w=new S(w,_)}else if(!(w instanceof S))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var o=new h(w.length()),A=0;A<o.length;++A)o[A]=w.at(A);return o}var f=W(),x=W([1]),D=W([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),E=W([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=W([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),y=W([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),C=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),g=W([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function s(l,w){var _=a.md.sha512.create(),o=new S(l);_.update(o.getBytes(w),"binary");var A=_.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(A,"binary");for(var F=new h(t.constants.HASH_BYTE_LENGTH),P=0;P<64;++P)F[P]=A.charCodeAt(P);return F}function d(l,w){var _=[W(),W(),W(),W()],o,A=s(w,32);for(A[0]&=248,A[31]&=127,A[31]|=64,$(_,A),B(l,_),o=0;o<32;++o)w[o+32]=l[o];return 0}function p(l,w,_,o){var A,F,P=new Float64Array(64),z=[W(),W(),W(),W()],ee=s(o,32);ee[0]&=248,ee[31]&=127,ee[31]|=64;var ae=_+64;for(A=0;A<_;++A)l[64+A]=w[A];for(A=0;A<32;++A)l[32+A]=ee[32+A];var G=s(l.subarray(32),_+32);for(c(G),$(z,G),B(l,z),A=32;A<64;++A)l[A]=o[A];var te=s(l,_+64);for(c(te),A=32;A<64;++A)P[A]=0;for(A=0;A<32;++A)P[A]=G[A];for(A=0;A<32;++A)for(F=0;F<32;F++)P[A+F]+=te[A]*ee[F];return R(l.subarray(32),P),ae}function I(l,w,_,o){var A,F,P=new h(32),z=[W(),W(),W(),W()],ee=[W(),W(),W(),W()];if(F=-1,_<64||V(ee,o))return-1;for(A=0;A<_;++A)l[A]=w[A];for(A=0;A<32;++A)l[A+32]=o[A];var ae=s(l,_);if(c(ae),j(z,ee,ae),$(ee,w.subarray(32)),i(z,ee),B(P,z),_-=64,M(w,0,P,0)){for(A=0;A<_;++A)l[A]=0;return-1}for(A=0;A<_;++A)l[A]=w[A+64];return F=_,F}function R(l,w){var _,o,A,F;for(o=63;o>=32;--o){for(_=0,A=o-32,F=o-12;A<F;++A)w[A]+=_-16*w[o]*C[A-(o-32)],_=w[A]+128>>8,w[A]-=_*256;w[A]+=_,w[o]=0}for(_=0,A=0;A<32;++A)w[A]+=_-(w[31]>>4)*C[A],_=w[A]>>8,w[A]&=255;for(A=0;A<32;++A)w[A]-=_*C[A];for(o=0;o<32;++o)w[o+1]+=w[o]>>8,l[o]=w[o]&255}function c(l){for(var w=new Float64Array(64),_=0;_<64;++_)w[_]=l[_],l[_]=0;R(l,w)}function i(l,w){var _=W(),o=W(),A=W(),F=W(),P=W(),z=W(),ee=W(),ae=W(),G=W();Z(_,l[1],l[0]),Z(G,w[1],w[0]),fe(_,_,G),ue(o,l[0],l[1]),ue(G,w[0],w[1]),fe(o,o,G),fe(A,l[3],w[3]),fe(A,A,E),fe(F,l[2],w[2]),ue(F,F,F),Z(P,o,_),Z(z,F,A),ue(ee,F,A),ue(ae,o,_),fe(l[0],P,z),fe(l[1],ae,ee),fe(l[2],ee,z),fe(l[3],P,ae)}function r(l,w,_){for(var o=0;o<4;++o)ge(l[o],w[o],_)}function B(l,w){var _=W(),o=W(),A=W();se(A,w[2]),fe(_,w[0],A),fe(o,w[1],A),k(l,o),l[31]^=Y(_)<<7}function k(l,w){var _,o,A,F=W(),P=W();for(_=0;_<16;++_)P[_]=w[_];for(he(P),he(P),he(P),o=0;o<2;++o){for(F[0]=P[0]-65517,_=1;_<15;++_)F[_]=P[_]-65535-(F[_-1]>>16&1),F[_-1]&=65535;F[15]=P[15]-32767-(F[14]>>16&1),A=F[15]>>16&1,F[14]&=65535,ge(P,F,1-A)}for(_=0;_<16;_++)l[2*_]=P[_]&255,l[2*_+1]=P[_]>>8}function V(l,w){var _=W(),o=W(),A=W(),F=W(),P=W(),z=W(),ee=W();return ne(l[2],x),L(l[1],w),qe(A,l[1]),fe(F,A,D),Z(A,A,l[2]),ue(F,l[2],F),qe(P,F),qe(z,P),fe(ee,z,P),fe(_,ee,A),fe(_,_,F),O(_,_),fe(_,_,A),fe(_,_,F),fe(_,_,F),fe(l[0],_,F),qe(o,l[0]),fe(o,o,F),q(o,A)&&fe(l[0],l[0],g),qe(o,l[0]),fe(o,o,F),q(o,A)?-1:(Y(l[0])===w[31]>>7&&Z(l[0],f,l[0]),fe(l[3],l[0],l[1]),0)}function L(l,w){var _;for(_=0;_<16;++_)l[_]=w[2*_]+(w[2*_+1]<<8);l[15]&=32767}function O(l,w){var _=W(),o;for(o=0;o<16;++o)_[o]=w[o];for(o=250;o>=0;--o)qe(_,_),o!==1&&fe(_,_,w);for(o=0;o<16;++o)l[o]=_[o]}function q(l,w){var _=new h(32),o=new h(32);return k(_,l),k(o,w),M(_,0,o,0)}function M(l,w,_,o){return H(l,w,_,o,32)}function H(l,w,_,o,A){var F,P=0;for(F=0;F<A;++F)P|=l[w+F]^_[o+F];return(1&P-1>>>8)-1}function Y(l){var w=new h(32);return k(w,l),w[0]&1}function j(l,w,_){var o,A;for(ne(l[0],f),ne(l[1],x),ne(l[2],x),ne(l[3],f),A=255;A>=0;--A)o=_[A/8|0]>>(A&7)&1,r(l,w,o),i(w,l),i(l,l),r(l,w,o)}function $(l,w){var _=[W(),W(),W(),W()];ne(_[0],u),ne(_[1],y),ne(_[2],x),fe(_[3],u,y),j(l,_,w)}function ne(l,w){var _;for(_=0;_<16;_++)l[_]=w[_]|0}function se(l,w){var _=W(),o;for(o=0;o<16;++o)_[o]=w[o];for(o=253;o>=0;--o)qe(_,_),o!==2&&o!==4&&fe(_,_,w);for(o=0;o<16;++o)l[o]=_[o]}function he(l){var w,_,o=1;for(w=0;w<16;++w)_=l[w]+o+65535,o=Math.floor(_/65536),l[w]=_-o*65536;l[0]+=o-1+37*(o-1)}function ge(l,w,_){for(var o,A=~(_-1),F=0;F<16;++F)o=A&(l[F]^w[F]),l[F]^=o,w[F]^=o}function W(l){var w,_=new Float64Array(16);if(l)for(w=0;w<l.length;++w)_[w]=l[w];return _}function ue(l,w,_){for(var o=0;o<16;++o)l[o]=w[o]+_[o]}function Z(l,w,_){for(var o=0;o<16;++o)l[o]=w[o]-_[o]}function qe(l,w){fe(l,w,w)}function fe(l,w,_){var o,A,F=0,P=0,z=0,ee=0,ae=0,G=0,te=0,ie=0,ce=0,oe=0,me=0,Se=0,xe=0,Ce=0,ve=0,ye=0,Te=0,Ke=0,Me=0,He=0,Ge=0,Qe=0,Ye=0,je=0,et=0,rt=0,it=0,ot=0,ft=0,dt=0,gt=0,Ae=_[0],Be=_[1],be=_[2],_e=_[3],Ne=_[4],Re=_[5],we=_[6],Le=_[7],ke=_[8],De=_[9],Ue=_[10],Pe=_[11],Ee=_[12],Ie=_[13],Ve=_[14],Oe=_[15];o=w[0],F+=o*Ae,P+=o*Be,z+=o*be,ee+=o*_e,ae+=o*Ne,G+=o*Re,te+=o*we,ie+=o*Le,ce+=o*ke,oe+=o*De,me+=o*Ue,Se+=o*Pe,xe+=o*Ee,Ce+=o*Ie,ve+=o*Ve,ye+=o*Oe,o=w[1],P+=o*Ae,z+=o*Be,ee+=o*be,ae+=o*_e,G+=o*Ne,te+=o*Re,ie+=o*we,ce+=o*Le,oe+=o*ke,me+=o*De,Se+=o*Ue,xe+=o*Pe,Ce+=o*Ee,ve+=o*Ie,ye+=o*Ve,Te+=o*Oe,o=w[2],z+=o*Ae,ee+=o*Be,ae+=o*be,G+=o*_e,te+=o*Ne,ie+=o*Re,ce+=o*we,oe+=o*Le,me+=o*ke,Se+=o*De,xe+=o*Ue,Ce+=o*Pe,ve+=o*Ee,ye+=o*Ie,Te+=o*Ve,Ke+=o*Oe,o=w[3],ee+=o*Ae,ae+=o*Be,G+=o*be,te+=o*_e,ie+=o*Ne,ce+=o*Re,oe+=o*we,me+=o*Le,Se+=o*ke,xe+=o*De,Ce+=o*Ue,ve+=o*Pe,ye+=o*Ee,Te+=o*Ie,Ke+=o*Ve,Me+=o*Oe,o=w[4],ae+=o*Ae,G+=o*Be,te+=o*be,ie+=o*_e,ce+=o*Ne,oe+=o*Re,me+=o*we,Se+=o*Le,xe+=o*ke,Ce+=o*De,ve+=o*Ue,ye+=o*Pe,Te+=o*Ee,Ke+=o*Ie,Me+=o*Ve,He+=o*Oe,o=w[5],G+=o*Ae,te+=o*Be,ie+=o*be,ce+=o*_e,oe+=o*Ne,me+=o*Re,Se+=o*we,xe+=o*Le,Ce+=o*ke,ve+=o*De,ye+=o*Ue,Te+=o*Pe,Ke+=o*Ee,Me+=o*Ie,He+=o*Ve,Ge+=o*Oe,o=w[6],te+=o*Ae,ie+=o*Be,ce+=o*be,oe+=o*_e,me+=o*Ne,Se+=o*Re,xe+=o*we,Ce+=o*Le,ve+=o*ke,ye+=o*De,Te+=o*Ue,Ke+=o*Pe,Me+=o*Ee,He+=o*Ie,Ge+=o*Ve,Qe+=o*Oe,o=w[7],ie+=o*Ae,ce+=o*Be,oe+=o*be,me+=o*_e,Se+=o*Ne,xe+=o*Re,Ce+=o*we,ve+=o*Le,ye+=o*ke,Te+=o*De,Ke+=o*Ue,Me+=o*Pe,He+=o*Ee,Ge+=o*Ie,Qe+=o*Ve,Ye+=o*Oe,o=w[8],ce+=o*Ae,oe+=o*Be,me+=o*be,Se+=o*_e,xe+=o*Ne,Ce+=o*Re,ve+=o*we,ye+=o*Le,Te+=o*ke,Ke+=o*De,Me+=o*Ue,He+=o*Pe,Ge+=o*Ee,Qe+=o*Ie,Ye+=o*Ve,je+=o*Oe,o=w[9],oe+=o*Ae,me+=o*Be,Se+=o*be,xe+=o*_e,Ce+=o*Ne,ve+=o*Re,ye+=o*we,Te+=o*Le,Ke+=o*ke,Me+=o*De,He+=o*Ue,Ge+=o*Pe,Qe+=o*Ee,Ye+=o*Ie,je+=o*Ve,et+=o*Oe,o=w[10],me+=o*Ae,Se+=o*Be,xe+=o*be,Ce+=o*_e,ve+=o*Ne,ye+=o*Re,Te+=o*we,Ke+=o*Le,Me+=o*ke,He+=o*De,Ge+=o*Ue,Qe+=o*Pe,Ye+=o*Ee,je+=o*Ie,et+=o*Ve,rt+=o*Oe,o=w[11],Se+=o*Ae,xe+=o*Be,Ce+=o*be,ve+=o*_e,ye+=o*Ne,Te+=o*Re,Ke+=o*we,Me+=o*Le,He+=o*ke,Ge+=o*De,Qe+=o*Ue,Ye+=o*Pe,je+=o*Ee,et+=o*Ie,rt+=o*Ve,it+=o*Oe,o=w[12],xe+=o*Ae,Ce+=o*Be,ve+=o*be,ye+=o*_e,Te+=o*Ne,Ke+=o*Re,Me+=o*we,He+=o*Le,Ge+=o*ke,Qe+=o*De,Ye+=o*Ue,je+=o*Pe,et+=o*Ee,rt+=o*Ie,it+=o*Ve,ot+=o*Oe,o=w[13],Ce+=o*Ae,ve+=o*Be,ye+=o*be,Te+=o*_e,Ke+=o*Ne,Me+=o*Re,He+=o*we,Ge+=o*Le,Qe+=o*ke,Ye+=o*De,je+=o*Ue,et+=o*Pe,rt+=o*Ee,it+=o*Ie,ot+=o*Ve,ft+=o*Oe,o=w[14],ve+=o*Ae,ye+=o*Be,Te+=o*be,Ke+=o*_e,Me+=o*Ne,He+=o*Re,Ge+=o*we,Qe+=o*Le,Ye+=o*ke,je+=o*De,et+=o*Ue,rt+=o*Pe,it+=o*Ee,ot+=o*Ie,ft+=o*Ve,dt+=o*Oe,o=w[15],ye+=o*Ae,Te+=o*Be,Ke+=o*be,Me+=o*_e,He+=o*Ne,Ge+=o*Re,Qe+=o*we,Ye+=o*Le,je+=o*ke,et+=o*De,rt+=o*Ue,it+=o*Pe,ot+=o*Ee,ft+=o*Ie,dt+=o*Ve,gt+=o*Oe,F+=38*Te,P+=38*Ke,z+=38*Me,ee+=38*He,ae+=38*Ge,G+=38*Qe,te+=38*Ye,ie+=38*je,ce+=38*et,oe+=38*rt,me+=38*it,Se+=38*ot,xe+=38*ft,Ce+=38*dt,ve+=38*gt,A=1,o=F+A+65535,A=Math.floor(o/65536),F=o-A*65536,o=P+A+65535,A=Math.floor(o/65536),P=o-A*65536,o=z+A+65535,A=Math.floor(o/65536),z=o-A*65536,o=ee+A+65535,A=Math.floor(o/65536),ee=o-A*65536,o=ae+A+65535,A=Math.floor(o/65536),ae=o-A*65536,o=G+A+65535,A=Math.floor(o/65536),G=o-A*65536,o=te+A+65535,A=Math.floor(o/65536),te=o-A*65536,o=ie+A+65535,A=Math.floor(o/65536),ie=o-A*65536,o=ce+A+65535,A=Math.floor(o/65536),ce=o-A*65536,o=oe+A+65535,A=Math.floor(o/65536),oe=o-A*65536,o=me+A+65535,A=Math.floor(o/65536),me=o-A*65536,o=Se+A+65535,A=Math.floor(o/65536),Se=o-A*65536,o=xe+A+65535,A=Math.floor(o/65536),xe=o-A*65536,o=Ce+A+65535,A=Math.floor(o/65536),Ce=o-A*65536,o=ve+A+65535,A=Math.floor(o/65536),ve=o-A*65536,o=ye+A+65535,A=Math.floor(o/65536),ye=o-A*65536,F+=A-1+37*(A-1),A=1,o=F+A+65535,A=Math.floor(o/65536),F=o-A*65536,o=P+A+65535,A=Math.floor(o/65536),P=o-A*65536,o=z+A+65535,A=Math.floor(o/65536),z=o-A*65536,o=ee+A+65535,A=Math.floor(o/65536),ee=o-A*65536,o=ae+A+65535,A=Math.floor(o/65536),ae=o-A*65536,o=G+A+65535,A=Math.floor(o/65536),G=o-A*65536,o=te+A+65535,A=Math.floor(o/65536),te=o-A*65536,o=ie+A+65535,A=Math.floor(o/65536),ie=o-A*65536,o=ce+A+65535,A=Math.floor(o/65536),ce=o-A*65536,o=oe+A+65535,A=Math.floor(o/65536),oe=o-A*65536,o=me+A+65535,A=Math.floor(o/65536),me=o-A*65536,o=Se+A+65535,A=Math.floor(o/65536),Se=o-A*65536,o=xe+A+65535,A=Math.floor(o/65536),xe=o-A*65536,o=Ce+A+65535,A=Math.floor(o/65536),Ce=o-A*65536,o=ve+A+65535,A=Math.floor(o/65536),ve=o-A*65536,o=ye+A+65535,A=Math.floor(o/65536),ye=o-A*65536,F+=A-1+37*(A-1),l[0]=F,l[1]=P,l[2]=z,l[3]=ee,l[4]=ae,l[5]=G,l[6]=te,l[7]=ie,l[8]=ce,l[9]=oe,l[10]=me,l[11]=Se,l[12]=xe,l[13]=Ce,l[14]=ve,l[15]=ye}return or}var ur,aa;function an(){if(aa)return ur;aa=1;var a=le();de(),Je(),At(),ur=a.kem=a.kem||{};var e=a.jsbn.BigInteger;a.kem.rsa={},a.kem.rsa.create=function(v,N){N=N||{};var S=N.prng||a.random,h={};return h.encrypt=function(t,m){var f=Math.ceil(t.n.bitLength()/8),x;do x=new e(a.util.bytesToHex(S.getBytesSync(f)),16).mod(t.n);while(x.compareTo(e.ONE)<=0);x=a.util.hexToBytes(x.toString(16));var D=f-x.length;D>0&&(x=a.util.fillString("\0",D)+x);var E=t.encrypt(x,"NONE"),u=v.generate(x,m);return{encapsulation:E,key:u}},h.decrypt=function(t,m,f){var x=t.decrypt(m,"NONE");return v.generate(x,f)},h},a.kem.kdf1=function(v,N){n(this,v,0,N||v.digestLength)},a.kem.kdf2=function(v,N){n(this,v,1,N||v.digestLength)};function n(v,N,S,h){v.generate=function(t,m){for(var f=new a.util.ByteBuffer,x=Math.ceil(m/h)+S,D=new a.util.ByteBuffer,E=S;E<x;++E){D.putInt32(E),N.start(),N.update(t+D.getBytes());var u=N.digest();f.putBytes(u.getBytes(h))}return f.truncate(f.length()-m),f.getBytes()}}return ur}var lr,na;function nn(){if(na)return lr;na=1;var a=le();de(),lr=a.log=a.log||{},a.log.levels=["none","error","warning","info","debug","verbose","max"];var e={},n=[],v=null;a.log.LEVEL_LOCKED=2,a.log.NO_LEVEL_CHECK=4,a.log.INTERPOLATE=8;for(var N=0;N<a.log.levels.length;++N){var S=a.log.levels[N];e[S]={index:N,name:S.toUpperCase()}}a.log.logMessage=function(E){for(var u=e[E.level].index,y=0;y<n.length;++y){var C=n[y];if(C.flags&a.log.NO_LEVEL_CHECK)C.f(E);else{var g=e[C.level].index;u<=g&&C.f(C,E)}}},a.log.prepareStandard=function(E){"standard"in E||(E.standard=e[E.level].name+" ["+E.category+"] "+E.message)},a.log.prepareFull=function(E){if(!("full"in E)){var u=[E.message];u=u.concat([]),E.full=a.util.format.apply(this,u)}},a.log.prepareStandardFull=function(E){"standardFull"in E||(a.log.prepareStandard(E),E.standardFull=E.standard)};for(var h=["error","warning","info","debug","verbose"],N=0;N<h.length;++N)(function(u){a.log[u]=function(y,C){var g=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:u,category:y,message:C,arguments:g};a.log.logMessage(s)}})(h[N]);if(a.log.makeLogger=function(E){var u={flags:0,f:E};return a.log.setLevel(u,"none"),u},a.log.setLevel=function(E,u){var y=!1;if(E&&!(E.flags&a.log.LEVEL_LOCKED))for(var C=0;C<a.log.levels.length;++C){var g=a.log.levels[C];if(u==g){E.level=u,y=!0;break}}return y},a.log.lock=function(E,u){typeof u>"u"||u?E.flags|=a.log.LEVEL_LOCKED:E.flags&=~a.log.LEVEL_LOCKED},a.log.addLogger=function(E){n.push(E)},typeof console<"u"&&"log"in console){var t;if(console.error&&console.warn&&console.info&&console.debug){var m={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},f=function(E,u){a.log.prepareStandard(u);var y=m[u.level],C=[u.standard];C=C.concat(u.arguments.slice()),y.apply(console,C)};t=a.log.makeLogger(f)}else{var f=function(u,y){a.log.prepareStandardFull(y),console.log(y.standardFull)};t=a.log.makeLogger(f)}a.log.setLevel(t,"debug"),a.log.addLogger(t),v=t}else console={log:function(){}};if(v!==null&&typeof window<"u"&&window.location){var x=new URL(window.location.href).searchParams;if(x.has("console.level")&&a.log.setLevel(v,x.get("console.level").slice(-1)[0]),x.has("console.lock")){var D=x.get("console.lock").slice(-1)[0];D=="true"&&a.log.lock(v)}}return a.log.consoleLogger=v,lr}var fr,ia;function sn(){return ia||(ia=1,fr=nt(),vr(),yt(),ha(),Ta()),fr}var cr={exports:{}},sa;function on(){if(sa)return cr.exports;sa=1;var a=le();ut(),tt(),It(),lt(),ht(),ma(),Je(),de(),Cr();var e=a.asn1,n=cr.exports=a.pkcs7=a.pkcs7||{};n.messageFromPem=function(u){var y=a.pem.decode(u)[0];if(y.type!=="PKCS7"){var C=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw C.headerType=y.type,C}if(y.procType&&y.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var g=e.fromDer(y.body);return n.messageFromAsn1(g)},n.messageToPem=function(u,y){var C={type:"PKCS7",body:e.toDer(u.toAsn1()).getBytes()};return a.pem.encode(C,{maxline:y})},n.messageFromAsn1=function(u){var y={},C=[];if(!e.validate(u,n.asn1.contentInfoValidator,y,C)){var g=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw g.errors=C,g}var s=e.derToOid(y.contentType),d;switch(s){case a.pki.oids.envelopedData:d=n.createEnvelopedData();break;case a.pki.oids.encryptedData:d=n.createEncryptedData();break;case a.pki.oids.signedData:d=n.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+s+" is not (yet) supported.")}return d.fromAsn1(y.content.value[0]),d},n.createSignedData=function(){var u=null;return u={type:a.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(g){if(D(u,g,n.asn1.signedDataValidator),u.certificates=[],u.crls=[],u.digestAlgorithmIdentifiers=[],u.contentInfo=null,u.signerInfos=[],u.rawCapture.certificates)for(var s=u.rawCapture.certificates.value,d=0;d<s.length;++d)u.certificates.push(a.pki.certificateFromAsn1(s[d]))},toAsn1:function(){u.contentInfo||u.sign();for(var g=[],s=0;s<u.certificates.length;++s)g.push(a.pki.certificateToAsn1(u.certificates[s]));var d=[],p=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,u.digestAlgorithmIdentifiers),u.contentInfo])]);return g.length>0&&p.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,g)),d.length>0&&p.value[0].value.push(e.create(e.Class.CONTEXT_SPECIFIC,1,!0,d)),p.value[0].value.push(e.create(e.Class.UNIVERSAL,e.Type.SET,!0,u.signerInfos)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.type).getBytes()),p])},addSigner:function(g){var s=g.issuer,d=g.serialNumber;if(g.certificate){var p=g.certificate;typeof p=="string"&&(p=a.pki.certificateFromPem(p)),s=p.issuer.attributes,d=p.serialNumber}var I=g.key;if(!I)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof I=="string"&&(I=a.pki.privateKeyFromPem(I));var R=g.digestAlgorithm||a.pki.oids.sha1;switch(R){case a.pki.oids.sha1:case a.pki.oids.sha256:case a.pki.oids.sha384:case a.pki.oids.sha512:case a.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+R)}var c=g.authenticatedAttributes||[];if(c.length>0){for(var i=!1,r=!1,B=0;B<c.length;++B){var k=c[B];if(!i&&k.type===a.pki.oids.contentType){if(i=!0,r)break;continue}if(!r&&k.type===a.pki.oids.messageDigest){if(r=!0,i)break;continue}}if(!i||!r)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}u.signers.push({key:I,version:1,issuer:s,serialNumber:d,digestAlgorithm:R,signatureAlgorithm:a.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(g){if(g=g||{},(typeof u.content!="object"||u.contentInfo===null)&&(u.contentInfo=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.pki.oids.data).getBytes())]),"content"in u)){var s;u.content instanceof a.util.ByteBuffer?s=u.content.bytes():typeof u.content=="string"&&(s=a.util.encodeUtf8(u.content)),g.detached?u.detachedContent=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,s):u.contentInfo.value.push(e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,s)]))}if(u.signers.length!==0){var d=y();C(d)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(g){typeof g=="string"&&(g=a.pki.certificateFromPem(g)),u.certificates.push(g)},addCertificateRevokationList:function(g){throw new Error("PKCS#7 CRL support not yet implemented.")}},u;function y(){for(var g={},s=0;s<u.signers.length;++s){var d=u.signers[s],p=d.digestAlgorithm;p in g||(g[p]=a.md[a.pki.oids[p]].create()),d.authenticatedAttributes.length===0?d.md=g[p]:d.md=a.md[a.pki.oids[p]].create()}u.digestAlgorithmIdentifiers=[];for(var p in g)u.digestAlgorithmIdentifiers.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(p).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]));return g}function C(g){var s;if(u.detachedContent?s=u.detachedContent:(s=u.contentInfo.value[1],s=s.value[0]),!s)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var d=e.derToOid(u.contentInfo.value[0].value),p=e.toDer(s);p.getByte(),e.getBerValueLength(p),p=p.getBytes();for(var I in g)g[I].start().update(p);for(var R=new Date,c=0;c<u.signers.length;++c){var i=u.signers[c];if(i.authenticatedAttributes.length===0){if(d!==a.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{i.authenticatedAttributesAsn1=e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var r=e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[]),B=0;B<i.authenticatedAttributes.length;++B){var k=i.authenticatedAttributes[B];k.type===a.pki.oids.messageDigest?k.value=g[i.digestAlgorithm].digest():k.type===a.pki.oids.signingTime&&(k.value||(k.value=R)),r.value.push(f(k)),i.authenticatedAttributesAsn1.value.push(f(k))}p=e.toDer(r).getBytes(),i.md.start().update(p)}i.signature=i.key.sign(i.md,"RSASSA-PKCS1-V1_5")}u.signerInfos=m(u.signers)}},n.createEncryptedData=function(){var u=null;return u={type:a.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(y){D(u,y,n.asn1.encryptedDataValidator)},decrypt:function(y){y!==void 0&&(u.encryptedContent.key=y),E(u)}},u},n.createEnvelopedData=function(){var u=null;return u={type:a.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(y){var C=D(u,y,n.asn1.envelopedDataValidator);u.recipients=S(C.recipientInfos.value)},toAsn1:function(){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.type).getBytes()),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,h(u.recipients)),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,x(u.encryptedContent))])])])},findRecipient:function(y){for(var C=y.issuer.attributes,g=0;g<u.recipients.length;++g){var s=u.recipients[g],d=s.issuer;if(s.serialNumber===y.serialNumber&&d.length===C.length){for(var p=!0,I=0;I<C.length;++I)if(d[I].type!==C[I].type||d[I].value!==C[I].value){p=!1;break}if(p)return s}}return null},decrypt:function(y,C){if(u.encryptedContent.key===void 0&&y!==void 0&&C!==void 0)switch(y.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:case a.pki.oids.desCBC:var g=C.decrypt(y.encryptedContent.content);u.encryptedContent.key=a.util.createBuffer(g);break;default:throw new Error("Unsupported asymmetric cipher, OID "+y.encryptedContent.algorithm)}E(u)},addRecipient:function(y){u.recipients.push({version:0,issuer:y.issuer.attributes,serialNumber:y.serialNumber,encryptedContent:{algorithm:a.pki.oids.rsaEncryption,key:y.publicKey}})},encrypt:function(y,C){if(u.encryptedContent.content===void 0){C=C||u.encryptedContent.algorithm,y=y||u.encryptedContent.key;var g,s,d;switch(C){case a.pki.oids["aes128-CBC"]:g=16,s=16,d=a.aes.createEncryptionCipher;break;case a.pki.oids["aes192-CBC"]:g=24,s=16,d=a.aes.createEncryptionCipher;break;case a.pki.oids["aes256-CBC"]:g=32,s=16,d=a.aes.createEncryptionCipher;break;case a.pki.oids["des-EDE3-CBC"]:g=24,s=8,d=a.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+C)}if(y===void 0)y=a.util.createBuffer(a.random.getBytes(g));else if(y.length()!=g)throw new Error("Symmetric key has wrong length; got "+y.length()+" bytes, expected "+g+".");u.encryptedContent.algorithm=C,u.encryptedContent.key=y,u.encryptedContent.parameter=a.util.createBuffer(a.random.getBytes(s));var p=d(y);if(p.start(u.encryptedContent.parameter.copy()),p.update(u.content),!p.finish())throw new Error("Symmetric encryption failed.");u.encryptedContent.content=p.output}for(var I=0;I<u.recipients.length;++I){var R=u.recipients[I];if(R.encryptedContent.content===void 0)switch(R.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:R.encryptedContent.content=R.encryptedContent.key.encrypt(u.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+R.encryptedContent.algorithm)}}}},u};function v(u){var y={},C=[];if(!e.validate(u,n.asn1.recipientInfoValidator,y,C)){var g=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw g.errors=C,g}return{version:y.version.charCodeAt(0),issuer:a.pki.RDNAttributesAsArray(y.issuer),serialNumber:a.util.createBuffer(y.serial).toHex(),encryptedContent:{algorithm:e.derToOid(y.encAlgorithm),parameter:y.encParameter?y.encParameter.value:void 0,content:y.encKey}}}function N(u){return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:u.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,a.util.hexToBytes(u.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.encryptedContent.algorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")]),e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.encryptedContent.content)])}function S(u){for(var y=[],C=0;C<u.length;++C)y.push(v(u[C]));return y}function h(u){for(var y=[],C=0;C<u.length;++C)y.push(N(u[C]));return y}function t(u){var y=e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,e.integerToDer(u.version).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:u.issuer}),e.create(e.Class.UNIVERSAL,e.Type.INTEGER,!1,a.util.hexToBytes(u.serialNumber))]),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.digestAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])]);if(u.authenticatedAttributesAsn1&&y.value.push(u.authenticatedAttributesAsn1),y.value.push(e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.signatureAlgorithm).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.NULL,!1,"")])),y.value.push(e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.signature)),u.unauthenticatedAttributes.length>0){for(var C=e.create(e.Class.CONTEXT_SPECIFIC,1,!0,[]),g=0;g<u.unauthenticatedAttributes.length;++g){var s=u.unauthenticatedAttributes[g];C.values.push(f(s))}y.value.push(C)}return y}function m(u){for(var y=[],C=0;C<u.length;++C)y.push(t(u[C]));return y}function f(u){var y;if(u.type===a.pki.oids.contentType)y=e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.value).getBytes());else if(u.type===a.pki.oids.messageDigest)y=e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.value.bytes());else if(u.type===a.pki.oids.signingTime){var C=new Date("1950-01-01T00:00:00Z"),g=new Date("2050-01-01T00:00:00Z"),s=u.value;if(typeof s=="string"){var d=Date.parse(s);isNaN(d)?s.length===13?s=e.utcTimeToDate(s):s=e.generalizedTimeToDate(s):s=new Date(d)}s>=C&&s<g?y=e.create(e.Class.UNIVERSAL,e.Type.UTCTIME,!1,e.dateToUtcTime(s)):y=e.create(e.Class.UNIVERSAL,e.Type.GENERALIZEDTIME,!1,e.dateToGeneralizedTime(s))}return e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.type).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SET,!0,[y])])}function x(u){return[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(a.pki.oids.data).getBytes()),e.create(e.Class.UNIVERSAL,e.Type.SEQUENCE,!0,[e.create(e.Class.UNIVERSAL,e.Type.OID,!1,e.oidToDer(u.algorithm).getBytes()),u.parameter?e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.parameter.getBytes()):void 0]),e.create(e.Class.CONTEXT_SPECIFIC,0,!0,[e.create(e.Class.UNIVERSAL,e.Type.OCTETSTRING,!1,u.content.getBytes())])]}function D(u,y,C){var g={},s=[];if(!e.validate(y,C,g,s)){var d=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw d.errors=d,d}var p=e.derToOid(g.contentType);if(p!==a.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(g.encryptedContent){var I="";if(a.util.isArray(g.encryptedContent))for(var R=0;R<g.encryptedContent.length;++R){if(g.encryptedContent[R].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");I+=g.encryptedContent[R].value}else I=g.encryptedContent;u.encryptedContent={algorithm:e.derToOid(g.encAlgorithm),parameter:a.util.createBuffer(g.encParameter.value),content:a.util.createBuffer(I)}}if(g.content){var I="";if(a.util.isArray(g.content))for(var R=0;R<g.content.length;++R){if(g.content[R].type!==e.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");I+=g.content[R].value}else I=g.content;u.content=a.util.createBuffer(I)}return u.version=g.version.charCodeAt(0),u.rawCapture=g,g}function E(u){if(u.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(u.content===void 0){var y;switch(u.encryptedContent.algorithm){case a.pki.oids["aes128-CBC"]:case a.pki.oids["aes192-CBC"]:case a.pki.oids["aes256-CBC"]:y=a.aes.createDecryptionCipher(u.encryptedContent.key);break;case a.pki.oids.desCBC:case a.pki.oids["des-EDE3-CBC"]:y=a.des.createDecryptionCipher(u.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+u.encryptedContent.algorithm)}if(y.start(u.encryptedContent.parameter),y.update(u.encryptedContent.content),!y.finish())throw new Error("Symmetric decryption failed.");u.content=y.output}}return cr.exports}var hr={exports:{}},oa;function un(){if(oa)return hr.exports;oa=1;var a=le();ut(),vt(),vr(),yt(),de();var e=hr.exports=a.ssh=a.ssh||{};e.privateKeyToPutty=function(S,h,t){t=t||"",h=h||"";var m="ssh-rsa",f=h===""?"none":"aes256-cbc",x="PuTTY-User-Key-File-2: "+m+`\r
`;x+="Encryption: "+f+`\r
`,x+="Comment: "+t+`\r
`;var D=a.util.createBuffer();v(D,m),n(D,S.e),n(D,S.n);var E=a.util.encode64(D.bytes(),64),u=Math.floor(E.length/66)+1;x+="Public-Lines: "+u+`\r
`,x+=E;var y=a.util.createBuffer();n(y,S.d),n(y,S.p),n(y,S.q),n(y,S.qInv);var C;if(!h)C=a.util.encode64(y.bytes(),64);else{var g=y.length()+16-1;g-=g%16;var s=N(y.bytes());s.truncate(s.length()-g+y.length()),y.putBuffer(s);var d=a.util.createBuffer();d.putBuffer(N("\0\0\0\0",h)),d.putBuffer(N("\0\0\0",h));var p=a.aes.createEncryptionCipher(d.truncate(8),"CBC");p.start(a.util.createBuffer().fillWithByte(0,16)),p.update(y.copy()),p.finish();var I=p.output;I.truncate(16),C=a.util.encode64(I.bytes(),64)}u=Math.floor(C.length/66)+1,x+=`\r
Private-Lines: `+u+`\r
`,x+=C;var R=N("putty-private-key-file-mac-key",h),c=a.util.createBuffer();v(c,m),v(c,f),v(c,t),c.putInt32(D.length()),c.putBuffer(D),c.putInt32(y.length()),c.putBuffer(y);var i=a.hmac.create();return i.start("sha1",R),i.update(c.bytes()),x+=`\r
Private-MAC: `+i.digest().toHex()+`\r
`,x},e.publicKeyToOpenSSH=function(S,h){var t="ssh-rsa";h=h||"";var m=a.util.createBuffer();return v(m,t),n(m,S.e),n(m,S.n),t+" "+a.util.encode64(m.bytes())+" "+h},e.privateKeyToOpenSSH=function(S,h){return h?a.pki.encryptRsaPrivateKey(S,h,{legacy:!0,algorithm:"aes128"}):a.pki.privateKeyToPem(S)},e.getPublicKeyFingerprint=function(S,h){h=h||{};var t=h.md||a.md.md5.create(),m="ssh-rsa",f=a.util.createBuffer();v(f,m),n(f,S.e),n(f,S.n),t.start(),t.update(f.getBytes());var x=t.digest();if(h.encoding==="hex"){var D=x.toHex();return h.delimiter?D.match(/.{2}/g).join(h.delimiter):D}else{if(h.encoding==="binary")return x.getBytes();if(h.encoding)throw new Error('Unknown encoding "'+h.encoding+'".')}return x};function n(S,h){var t=h.toString(16);t[0]>="8"&&(t="00"+t);var m=a.util.hexToBytes(t);S.putInt32(m.length),S.putBytes(m)}function v(S,h){S.putInt32(h.length),S.putString(h)}function N(){for(var S=a.md.sha1.create(),h=arguments.length,t=0;t<h;++t)S.update(arguments[t]);return S.digest()}return hr.exports}var dr,ua;function ln(){return ua||(ua=1,dr=le(),ut(),en(),tt(),pr(),It(),rn(),vt(),an(),nn(),sn(),Ca(),gr(),ht(),va(),Ea(),on(),xa(),ya(),da(),mr(),Je(),pa(),un(),Sa(),de()),dr}var fn=ln();const la=Qa(fn),cn=`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAyiJ32Wao7OGg+h+z4KVt
AKtZHPPxSPE3ZYl9TGFRvVbIJM3Xb9OGYDdpmOrRlSVhWnFXaEus7JPZlwaoqHMq
N/ce7zd+KwbyW+j/nx8rlEuXwEQIEVGdJWpQ36VI4PxO7YTIf54zS3KnJlQQCj90
7ODbrAQ2IbRZL+3/FROEM9Yhxj0ee9zG0OFJDs8ry8tIYy5w2sZUO4fOaFE6GwjF
TCN0bJ59CuAUE3dEVQ5gbvVYtC+xXbFrat4h+9dMUezQwrce5rAr+CCn+oYCAv8/
4VlC4cs8oWaNRGW8BetsTw6NeN/WJbsQ6+cnemh7A23nb+x2vuO8lYtIDbwewJvV
sQIDAQAB
-----END PUBLIC KEY-----`,hn=a=>{const n=la.pki.publicKeyFromPem(cn).encrypt(a,"RSA-OAEP");return la.util.encode64(n)},dn="15";class pn{constructor(){_t(this,"login",async(e,n)=>{try{const v=hn(e.password);e={...e,password:v};const N=await Er.post("/login",e),S=Date.now()+dn*60*1e3;localStorage.setItem("token",N.data.token),localStorage.setItem("expiryToken",S),localStorage.setItem("refreshToken",N.data.refreshToken)}catch(v){throw v}finally{Ya(()=>{})}});_t(this,"logout",async()=>{try{const e=localStorage.getItem("refreshToken");await Er.post("/logout",{refreshToken:e}),Xa.clearUserDetail()}catch(e){ja.warn("Logout failed!"),console.error("Logout failed",e)}});za(this)}}const wn=new pn;function Ln(a){var e=typeof a;return a!=null&&(e=="object"||e=="function")}var vn=typeof global=="object"&&global&&global.Object===Object&&global,yn=typeof self=="object"&&self&&self.Object===Object&&self,gn=vn||yn||Function("return this")(),Tt=gn.Symbol,Ia=Object.prototype,mn=Ia.hasOwnProperty,Cn=Ia.toString,pt=Tt?Tt.toStringTag:void 0;function En(a){var e=mn.call(a,pt),n=a[pt];try{a[pt]=void 0;var v=!0}catch{}var N=Cn.call(a);return v&&(e?a[pt]=n:delete a[pt]),N}var xn=Object.prototype,Sn=xn.toString;function Tn(a){return Sn.call(a)}var In="[object Null]",An="[object Undefined]",fa=Tt?Tt.toStringTag:void 0;function Bn(a){return a==null?a===void 0?An:In:fa&&fa in Object(a)?En(a):Tn(a)}function bn(a){return a!=null&&typeof a=="object"}var _n="[object Symbol]";function kn(a){return typeof a=="symbol"||bn(a)&&Bn(a)==_n}export{Tt as S,wn as a,Ln as b,bn as c,Bn as d,hn as e,vn as f,kn as i,gn as r};
