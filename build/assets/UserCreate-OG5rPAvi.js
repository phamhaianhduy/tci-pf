import{j as e,h as C}from"./index-Cwsbtslf.js";import{c as w,g as E,a as m,f as N,e as F,F as b,b as y,C as l}from"./CustomCFormInput-R6ZhCQt0.js";import{e as R}from"./isSymbol-C4hJnqVa.js";import{C as q,a as S}from"./CustomCFormFileInput-Qmg440vX.js";import{b as g,a as P}from"./CContainer-Y1mteLO7.js";import{C as U,a as I}from"./CCardBody-Bc4MtlRY.js";import{C as D}from"./CCardHeader-qQtIod6a.js";import{C as u,a as r}from"./CRow-YNLixlNm.js";import{a as t}from"./CFormInput--xOEIcm_.js";const X=()=>{const x=w().shape({userName:m().required("Username is required").max(100),fullName:m().required("Fullname is required").max(100),email:m().email("Email is invalid").required("Email is required"),isRealEmail:N(),contactEmail:m().when("isRealEmail",{is:!1,then:a=>a.email("Email is invalid").required("Contact email is required"),otherwise:a=>a.notRequired()}),password:m().required("Password is required").min(8,"Password must be at least 8 characters").test("isStrong","Password is not secure",a=>a?/[A-Z]/.test(a)&&/[a-z]/.test(a)&&/[0-9]/.test(a)&&/[!@#$%^&*(),.?':{}|<>]/.test(a):!1),confirmPassword:m().required("Confirm password is required").oneOf([F("password"),null],"Confirm password must match password"),avatar:E().nullable(!0).test("fileSize","Size limit 5MB",a=>!a||a.size<=5242880).test("fileFormat","File type is not allowed",a=>!a||["image/jpg","image/jpeg","image/png"].includes(a.type))}),h={userName:"",fullName:"",email:"",password:"",confirmPassword:"",avatar:null,isRealEmail:!0,contactEmail:""},j=a=>{a("avatar",null),userData.avatarUrl=null,setIsDeleteAvatar(!0)},f=async(a,{setErrors:n,setSubmitting:o})=>{var d,c,p;try{const s=new FormData;s.append("userName",a.userName),s.append("fullName",a.fullName),s.append("email",a.email),s.append("password",R(a.password)),a.avatar&&s.append("avatar",a.avatar),a.isRealEmail||(s.append("isRealEmail",a.isRealEmail),s.append("contactEmail",a.contactEmail)),await C.createUser(s)}catch(s){const i=(d=s.response)==null?void 0:d.data;((c=i==null?void 0:i.error)==null?void 0:c.code)==="USERNAME_EXIST"&&n({userName:i.error.message}),((p=i==null?void 0:i.error)==null?void 0:p.code)==="EMAIL_EXIST"&&n({email:i.error.message})}finally{o(!1)}};return e.jsx(g,{className:"mt-4",children:e.jsxs(U,{children:[e.jsx(D,{children:e.jsx("strong",{children:"Create New User"})}),e.jsx(I,{children:e.jsx(b,{initialValues:h,validationSchema:x,onSubmit:f,children:({values:a,setFieldValue:n,isSubmitting:o})=>e.jsx(y,{children:e.jsxs(u,{children:[e.jsx(r,{md:4,children:e.jsx(q,{name:"avatar",label:"Upload Avatar",accept:"image/*",initialImageUrl:"",onDelete:j})}),e.jsx(r,{md:8,children:e.jsxs(u,{children:[e.jsxs(r,{md:6,className:"mb-4",children:[e.jsx(t,{children:"Fullname"}),e.jsx(l,{name:"fullName",type:"text"})]}),e.jsxs(r,{md:6,children:[e.jsx(t,{children:"Username"}),e.jsx(l,{name:"userName",type:"text"})]}),e.jsxs(r,{md:6,className:"mb-4",children:[e.jsx(t,{children:"Email"}),e.jsx(l,{name:"email",type:"email"})]}),e.jsxs(r,{md:6,children:[e.jsx(t,{htmlFor:"email",children:"Real email"}),e.jsx(S,{id:"realEmailSwitch",label:"Real Email",name:"isRealEmail"})]}),!a.isRealEmail&&e.jsxs(r,{md:12,className:"mb-4",children:[e.jsx(t,{children:"Contact Email"}),e.jsx(l,{name:"contactEmail",type:"text"})]}),e.jsxs(r,{md:6,children:[e.jsx(t,{children:"Password"}),e.jsx(l,{name:"password",type:"password"}),e.jsx("small",{className:"text-muted",children:"Password must include upper, lower, number, and special character"})]}),e.jsxs(r,{md:6,children:[e.jsx(t,{children:"Confirm Password"}),e.jsx(l,{name:"confirmPassword",type:"password"})]}),e.jsx(r,{md:12,className:"mt-4",children:e.jsx(P,{type:"submit",color:"primary",disabled:o,variant:"outline",children:"Create User"})})]})})]})})})})]})})};export{X as default};
