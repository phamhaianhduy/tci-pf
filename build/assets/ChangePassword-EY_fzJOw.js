import{o as P,r as C,h as o,j as s,D as i}from"./index-Cwsbtslf.js";import{c as f,a as n,e as x,F as j,b as y,C as l}from"./CustomCFormInput-R6ZhCQt0.js";import{e as w}from"./isSymbol-C4hJnqVa.js";import{C as b,a as g}from"./CCardBody-Bc4MtlRY.js";import{C as N}from"./CCardHeader-qQtIod6a.js";import{b as F,a as S}from"./CContainer-Y1mteLO7.js";import{C as p,a as d}from"./CRow-YNLixlNm.js";import{a as c}from"./CFormInput--xOEIcm_.js";const q=()=>{const h=f().shape({oldPassword:n().required("Old password is required"),password:n().required("Password is required").min(8,"Password must be at least 8 characters").test("isStrong","Password is not secure.",r=>{if(!r)return!1;const a=/[A-Z]/.test(r),e=/[a-z]/.test(r),t=/[0-9]/.test(r),m=/[!@#$%^&*(),.?":{}|<>]/.test(r);return a&&e&&t&&m}),confirmPassword:n().required("Confirm password is required").oneOf([x("password"),null],"Passwords must match")});C.useEffect(()=>((async()=>{var a;await o.getUserByMe(),(a=o.userDetailByMe)!=null&&a.mustChangePassword&&i.error("You must change your password because it is expired.")})(),()=>o.clearUserDetail()),[]);const u=async(r,{setSubmitting:a,setFieldValue:e})=>{const t={oldPassword:w(r.oldPassword),password:w(r.password)};try{await o.updatePasswordUser(t),i.success("Password updated successfully.")}catch{i.error("Failed to update password."),e("oldPassword",""),e("password",""),e("confirmPassword","")}finally{a(!1)}};return s.jsx(j,{initialValues:{oldPassword:"",password:"",confirmPassword:""},validationSchema:h,onSubmit:u,children:({isSubmitting:r})=>s.jsx(y,{children:s.jsxs(b,{className:"mb-4 mt-4",children:[s.jsx(N,{children:s.jsx("strong",{children:"Change Password"})}),s.jsx(g,{children:s.jsxs(F,{children:[s.jsxs(p,{children:[s.jsxs(d,{md:12,children:[s.jsx(c,{htmlFor:"email",className:"mt-3",children:"Old Password"}),s.jsx(l,{name:"oldPassword",type:"password",label:"Old Password",placeholder:"Enter your old password"})]}),s.jsxs(d,{md:12,children:[s.jsx(c,{htmlFor:"email",className:"mt-3",children:"New Password"}),s.jsx(l,{name:"password",type:"password",label:"New Password",placeholder:"Enter your new password"})]}),s.jsxs(d,{md:12,children:[s.jsx(c,{htmlFor:"email",className:"mt-3",children:"Confirm Password"}),s.jsx(l,{name:"confirmPassword",type:"password",label:"Confirm Password",placeholder:"Confirm your new password"})]})]}),s.jsx(p,{className:"mt-3",children:s.jsx(d,{children:s.jsx(S,{type:"submit",color:"primary",disabled:r,variant:"outline",children:"Change Password"})})})]})})]})})})},R=P(q);export{R as default};
